'use strict';var mi;var ni=chrome.i18n.getMessage("545449835455981095");w("mr.IssueSeverity",{Fv:"fatal",QA:"warning",Ox:"notification"});w("mr.IssueAction",{uv:"dismiss",Uw:"learn_more"});
var oi=function(a,c){this.sinkId=this.routeId=null;this.severity=c;this.isBlocking="fatal"==this.severity?!0:!1;this.title=a;this.message=null;this.defaultAction="dismiss";this.helpPageId=this.secondaryActions=null},qi=function(){var a=new oi(pi,"notification");a.helpPageId=6320939;a.defaultAction="learn_more";a.secondaryActions=["dismiss"];return a},ri=function(a){a.isBlocking=!0;return a},si=function(a,c){a.routeId=c;return a},ti=function(a,c){a.sinkId=c;return a};var ui=function(a,c){var b=this;this.f=void 0===c?null:c;this.b=new Promise(function(d,e){var f=function(g){b.f=null;e(g)};b.g=f;a(function(g){b.f=null;d(g)},f)})};ui.prototype.cancel=function(a){this.g(a);if(this.f){var c=this.f;this.f=null;setTimeout(function(){return c(a)},0)}};var vi=function(a,c,b){b=void 0===b?null:b;return new ui(function(d,e){a.b.then(function(f){if(c)try{d(c(f))}catch(g){e(g)}else d(f)},function(f){if(b)try{d(b(f))}catch(g){e(g)}else e(f)})},function(d){a.cancel(d)})};
ui.prototype.then=function(a,c){return vi(this,a,void 0===c?null:c)};ui.prototype.catch=function(a){return vi(this,null,a)};var wi=function(a){return new ui(function(c){c(a)})},xi=function(a){return new ui(function(c,b){b(a)})},yi=function(a){return new ui(function(c,b){a.then(c,b)})},zi=function(a,c){var b=!1,d=null;return new ui(function(e,f){a.then(function(g){b||(d=c(g),d.b.then(e,f))},f)},function(e){d?d.cancel(e):b=!0})};var Ai={Gu:0,Eu:1,Iu:2,Fu:3,gu:4,Hu:5,mw:6,fA:7,pv:8,Cp:9},Bi=function(a,c){a=Error.call(this,a);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.reason=0<=c&&9>=c?c:9};q(Bi,Error);var Ci=function(){var a=l(navigator.userAgent.match(/Windows NT (\d+.\d+)/)||[]);a.next();a=a.next().value;return 6.2<=parseFloat(a)},Di=function(){var a=navigator.userAgent;return a.includes("CrOS")?"ChromeOS":a.includes("Windows")?"Windows":a.includes("Macintosh")?"Mac":a.includes("Linux")?"Linux":"Other"};var Ei=!("undefined"==typeof chrome||!chrome.networkingPrivate||!chrome.networkingPrivate.setWifiTDLSEnabledState||"ChromeOS"!=Di()),Fi=["ChromeOS","Windows"].includes(Di());var Gi=function(a,c,b,d){this.f=a;this.b=c;this.g=b||null;this.presentationId=d||null},Ji=function(a,c){if("tab"==a.f)a=Hi(a);else if("offscreen_tab"==a.f)c=Hi(a),c.presentationId=a.presentationId,a=c;else{var b={audio:!1,video:!1};a.b.shouldCaptureVideo?(b.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c}},Ii(a,b.video.mandatory),Fi&&a.b.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"system",chromeMediaSourceId:c}})):a.b.shouldCaptureAudio&&(b.audio={mandatory:{chromeMediaSource:"system"}});
a=b}return a},Hi=function(a){var c={audio:a.b.shouldCaptureAudio,video:a.b.shouldCaptureVideo};a.b.shouldCaptureVideo&&(c.videoConstraints={mandatory:{enableAutoThrottling:!0}},Ii(a,c.videoConstraints.mandatory));return c},Ii=function(a,c){var b=a.b.minWidth,d=a.b.minHeight;if(a.b.senderSideLetterboxing){b=a.b;if(0==b.minHeight||0==b.maxHeight?0:Math.floor(100*b.minWidth/b.minHeight)==Math.floor(100*b.maxWidth/b.maxHeight))b={width:b.minWidth,height:b.minHeight};else{d=b.maxWidth;for(var e=b.maxHeight;0!=
e;){var f=d%e;d=e;e=f}e=b.maxWidth/d;d=b.maxHeight/d;if(e<b.minWidth||d<b.minHeight)if(f=Math.max(b.minWidth/e,b.minHeight/d),e*=f,d*=f,e>b.maxWidth||d>b.maxHeight)e=b.maxWidth,d=b.maxHeight;e=Math.round(e);d=Math.round(d);b={width:e,height:d}}d=b;b=d.width;d=d.height}Object.assign(c,{minWidth:b,minHeight:d,maxWidth:a.b.maxWidth,maxHeight:a.b.maxHeight,minFrameRate:a.b.minFrameRate,maxFrameRate:a.b.maxFrameRate})};var Ki=function(a){this.b=a;this.f=this.eg=null;this.m=hb("mr.mirror.MirrorMediaStream")};Ki.prototype.start=function(){return"tab"==this.b.f?Li(this):"offscreen_tab"==this.b.f?Mi(this):Ni(this)};var Li=function(a){var c=Ji(a.b);a.m.info("Starting tab capture with constraints "+JSON.stringify(c));return new Promise(function(b,d){chrome.tabCapture.capture(c,function(e){e?(Oi(a,e),b(a)):d(Pi())});window.setTimeout(function(){d(new Bi("chrome.tabCapture.capture failed to call its callback",2))},5E3)})};
Ki.prototype.g=function(a){a&&this.m.info(function(){return"Track "+JSON.stringify(a.target)+" ended"});this.stop()};
var Pi=function(){return chrome.runtime.lastError&&chrome.runtime.lastError.message?new Bi(chrome.runtime.lastError.message,7):new Bi("empty_stream",0)},Qi=function(a){a=void 0===a?!0:a;return new Promise(function(c,b){var d=["screen"];a&&d.push("audio");"Linux"==Di()&&d.push("window");var e=window.setTimeout(function(){f&&chrome.desktopCapture.cancelChooseDesktopMedia(f);b(new Bi("timeout",1))},6E4);var f=chrome.desktopCapture.chooseDesktopMedia(d,null,function(g){window.clearTimeout(e);g?c(g):b(new Bi("User cancelled capture dialog",
3))})})},Ri=function(a,c){return new Promise(function(b,d){a.m.info(function(){return"Starting desktop capture with constraints "+JSON.stringify(c)});navigator.mediaDevices.getUserMedia(c).then(function(e){e||d(new Bi("empty_stream",8));Oi(a,e);b(e)},function(e){var f=8;"NotAllowedError"==e.name&&(f=3);d(new Bi(e.name+" "+e.constraintName+": "+e.message,f))})})},Ni=function(a){return Fi&&a.b.b.shouldCaptureAudio&&!a.b.b.shouldCaptureVideo?Ri(a,Ji(a.b)).then(function(){return a}):Qi().then(function(c){c=
Ji(a.b,c);return Ri(a,c).then(function(){return a})})},Mi=function(a){var c=Ji(a.b);a.m.info(function(){return"Starting offscreen tab capture with constraints "+JSON.stringify(c)});return new Promise(function(b,d){chrome.tabCapture.captureOffscreenTab(a.b.g.toString(),c,function(e){e?(Oi(a,e),b(a)):d(Pi())})})},Oi=function(a,c){a.f=c;c.getAudioTracks().length||c.getVideoTracks();c.getTracks().forEach(function(b){b.onended=a.g.bind(a)})};
Ki.prototype.stop=function(){this.f&&(this.f.getTracks().forEach(function(a){a.onended=null;a.stop()}),this.f=null,this.eg&&this.eg())};var Si=function(){},Xi=function(a){var c=Ui.get(a)||null;if(c)return Promise.resolve(c);c=Vi.get(a);c||(c=new Eb,Vi.set(a,c),Wi(a,c));return c.b},Wi=function(a,c){var b=Yi.get(a)||null;if(!b)c.reject(Error("No corresponding bundle for "+a));else if(!Zi.has(b)){var d=$i.get(b);d||(aj.info("Loading bundle "+b+" for module "+a),d=bj(b),$i.set(b,d));d.catch(function(e){c.reject(e)})}},bj=function(a){var c=new Eb;c.b.then(function(){aj.info("Bundle "+a+" loaded")},function(d){aj.error("Failed to load bundle "+
a);throw d;});var b=document.createElement("script");b.src=chrome.extension.getURL(a);b.setAttribute("type","text/javascript");b.async=!0;b.onload=function(){return c.resolve(void 0)};b.onerror=function(){return c.reject(Error("Failed to load bundle "+a))};document.head.appendChild(b);return c.b},cj=function(a,c){if(Ui.has(a))throw Error("Duplicate module "+a);Ui.set(a,c);(a=Vi.get(a))&&a.resolve(c)};
Si.prototype.handleEvent=function(a,c){for(var b=1;b<arguments.length;++b);throw Error("Not implemented");};
var Yi=new Map([["mr.cast.ChannelService","background_script.js"],["mr.cast.SinkDiscoveryService","background_script.js"],["mr.mirror.cast.Service","mirroring_cast_streaming.js"],["mr.cloud.slarti.SinkDiscoveryService","background_script.js"],["mr.cloud.discovery.WeaveSinkDiscoveryService","background_script.js"],["mr.mirror.hangouts.HangoutsService","mirroring_hangouts.js"],["mr.mirror.hangouts.MeetingsService","mirroring_hangouts.js"],["mr.ProviderManager","background_script.js"],["mr.mirror.webrtc.WebRtcService",
"mirroring_webrtc.js"]]),Zi=new Set(["background_script.js"]),aj=hb("mr.Module"),Ui=new Map,Vi=new Map,$i=new Map;var dj,ej={dx:0,Ju:1,Ku:2,qv:3,rv:4,Rv:5,ow:6,bx:7,Ex:8,Fx:9,Ny:10,zz:11,Az:12,Pz:13,eA:14},fj=function(a){void 0==dj&&(Db("MediaRouter.Provider.WakeEvent",a,ej),dj=a)};var ij=function(a){return gj(a)||hj(a)},jj=function(a){try{var c=new URL(a);return"http:"!=c.protocol&&"https:"!=c.protocol?!1:-1==c.hash.indexOf("__castAppId__")}catch(b){return!1}},kj=["https://docs.google.com"],gj=function(a){return a.startsWith("urn:x-org.chromium.media:source:tab:")||-1!=a.indexOf("0F5096E8")},hj=function(a){return"urn:x-org.chromium.media:source:desktop"==a},lj=function(a){var c=a.search("urn:x-org.chromium.media:source:tab:");return-1==c?null:parseInt(a.substr(c+36),10)||null};var mj=function(a,c){this.ra=a;this.g=c||null;this.f=this.b=null;this.R=hb("mr.mirror.Service."+a);this.ea=this.na.bind(this);this.D=!1};q(mj,Si);h=mj.prototype;h.initialize=function(a,c){this.D||(this.g=a,this.D=!0,this.Dg(c))};h.Dg=function(){};h.getName=function(){return this.ra};
h.Jj=function(a,c,b,d,e){var f=this;this.R.info("Start mirroring on route "+a.id);if(!this.D)return xi(Error("Not initialized"));var g=new Promise(function(k,m){f.l().then(function(){var p=nj(c,b,d);return(new Ki(p)).start()}).then(function(p){if(f.f)throw p.stop(),new Bi("Cannot start multiple streams");f.f=p;p=f.C.bind(f);f.f.eg=p;return e?e(a).b:a}).then(function(p){if(f.b)throw new Bi("Cannot start multiple sessions");if(!f.f)throw new Bi("Media stream ended before session could start.");f.b=
f.zh(b,p);p.wb.vc=f.b.vc;p=f.g.Xi.bind(f.g);f.b.G=p;oj(f.b);return f.b.start(f.f.f)}).then(function(){gj(c)&&!chrome.tabs.onUpdated.hasListener(f.ea)&&chrome.tabs.onUpdated.addListener(f.ea);return f.Rc(a,c,b)}).then(function(){k(a)}).catch(function(p){pj(f,p);return f.C().then(function(){m(p)})})});return yi(g)};h.Kj=function(a,c,b,d,e,f){this.R.info("Update mirroring on route "+a.id);return this.D?yi(qj(this,a,c,b,d,f)):xi(Error("Not initialized"))};
var qj=function(a,c,b,d,e,f){if(!a.b)return Promise.reject(new Bi("No session to update streams on",7));if(!a.b.On())return Promise.reject(new Bi("Session does not support updating stream",7));var g=!1;return new Promise(function(k,m){var p=nj(b,d,e);(new Ki(p)).start().then(function(u){a.f&&(a.f.eg=null,a.f.stop(),a.fh());a.f=u;u=a.C.bind(a);a.f.eg=u;g=!0;return f?f(c).b:c}).then(function(){if(!a.b)throw new Bi("Session ended while updating stream");if(!a.f)throw new Bi("Media stream ended before session could be updated.");
return a.b.Un(a.f.f)}).then(a.Rc.bind(a,c,b,d)).then(function(){return k(c)}).catch(function(u){pj(a,u);if(g)return a.C().then(function(){m(u)});m(u)})})};
mj.prototype.Rc=function(a,c,b){var d=this;return new Promise(function(e,f){if(d.b){gj(c)?(rj(d.b,a.wb.tabId),d.gh()):jj(c)?(rj(d.b,a.wb.tabId),d.bi()):d.dh();f=d.f;var g=a.sinkId;b.shouldCaptureAudio&&f.f&&!f.f.getAudioTracks().length&&d.g.cf(ti(new oi(ni,"notification"),g));oj(d.b);e()}else f(new Bi("Session gone before executing post-startup steps",7))})};
var pj=function(a,c){c.reason=null!=c.reason?c.reason:9;a.R.error("Failed to start mirroring: "+c.message+(",  reason = "+c.reason+": "+c.stack));a.fg(c.reason)};mj.prototype.l=function(){var a=this;return this.D?this.C().then(function(c){c&&a.eh();return c}):Promise.reject("Not initialized")};
mj.prototype.C=function(){var a=this;chrome.tabs.onUpdated.removeListener(this.ea);var c=this.f;this.f=null;c&&(c.eg=null);var b=this.b;this.b=null;var d;b?d=this.zi(b).catch(function(e){return a.R.error("Error in before-cleanup steps",e)}).then(function(){return b.stop()}).catch(function(e){return a.R.error("Error stopping session",e)}).then(function(){a.g.Yh(b.f.id)}).catch(function(e){return a.R.error("Error in ended callbacks",e)}).then(function(){return!0}):d=Promise.resolve(!1);c&&(d=d.then(function(e){c.stop();
a.fh();return e}));return d};mj.prototype.zi=function(){return Promise.resolve()};mj.prototype.na=function(a,c,b){fj(14);this.b&&sj(this.b,a,c,b)};var nj=function(a,c,b){if(gj(a))return new Gi("tab",c);if(hj(a))return new Gi("desktop",c);if(jj(a)){if(!b)throw new Bi("Missing offscreen tab presentation id");return new Gi("offscreen_tab",c,a,b)}throw new Bi("Source URN does not suggest a known capture type.");};h=mj.prototype;h.zh=function(){};h.gh=function(){};h.dh=function(){};h.bi=function(){};
h.eh=function(){};h.fg=function(){};h.fh=function(){};h.Ij=function(){return eb()};h.createMediaRouteController=function(){return eb()};var tj=function(a,c,b){this.f=a;this.h=c;this.b=void 0===b?null:b;this.g=null},uj=function(a){switch(a.f){case "mirror_tab":return a.b?"Casting tab ("+a.b+")":"Casting tab";case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return a.b?"Casting media ("+a.b+")":"Casting media";case "presentation":return"Casting "+(a.b||"site");default:return""}},vj=function(a){if(a.h)return"Casting active";switch(a.f){case "mirror_tab":return"Casting tab";
case "mirror_desktop":return"Casting desktop";case "mirror_file":return"Casting local content";case "media_remoting":return"Casting media";case "presentation":return"Casting site";default:return""}};var wj=function(a){return(new Promise(function(c){chrome.tabs.get(a,c)})).then(function(c){if(!c)throw Error("No such tab "+a);return c})};var xj=function(a,c){this.f=a;this.G=void 0===c?null:c;c=null;var b=a.mediaSource;if(jj(b)){var d="presentation";c=(new URL(b)).origin}else gj(b)?d="mirror_tab":hj(b)&&(d="mirror_desktop");this.vc=new tj(d,a.offTheRecord,c);this.g=this.tabId=null;this.K=!1},rj=function(a,c){a.tabId!=c?(a.tabId=c,wj(c).then(function(b){a.g=b;oj(a)})):Promise.resolve()},sj=function(a,c,b,d){c==a.tabId&&("complete"==b.status||b.favIconUrl&&"complete"==d.status)&&(a.g=d,oj(a))},oj=function(a){if(a.g){a.vc.g=a.g.title;
a.vc.h=a.g.incognito;var c=new URL(a.g.url);"file:"==c.protocol?(a.vc.f="mirror_file",a.vc.b=null):(a.vc.f=a.K?"media_remoting":"mirror_tab",a.vc.b="https:"==c.protocol?c.origin.substr(8):c.origin)}a.f.description=uj(a.vc);a.G&&a.G(a.f,a.vc);a.xn()};h=xj.prototype;h.start=function(){};h.On=function(){return!1};h.Un=function(){};h.stop=function(){return Promise.resolve()};h.xn=function(){};var Bj=function(){var a=this;this.f=1920;this.b=1080;this.maxWidth=this.f;this.maxHeight=this.b;this.minHeight=this.minWidth=180;this.senderSideLetterboxing=!1;this.minFrameRate=0;this.maxFrameRate=30;this.minVideoBitrate=300;this.maxVideoBitrate=5E3;this.audioBitrate=0;this.animatedLatencyMillis=this.minLatencyMillis=this.maxLatencyMillis=400;this.dscpEnabled=["Mac","Linux","ChromeOS"].includes(Di())||Ci();this.enableLogging=!0;this.useTdls=!1;this.shouldCaptureAudio=this.shouldCaptureVideo=!0;var c=
window.localStorage?window.localStorage.getItem(yj):null;if(c)try{var b=JSON.parse(String(c));if(b instanceof Object)zj(this,b),hb("mr.mirror.Settings").H(function(){return"Initial mr.mirror.Settings overridden to: "+Aj(a)});else throw Error("localStorage["+yj+"] does not parse as an Object: "+c);}catch(d){throw hb("mr.mirror.Settings").error(yj+' must be of the form \'{"maxWidth":640, "maxHeight":360}\'.',d),Error("Overrides not parseable.  See ERROR log for details.");}};
Bj.prototype.clone=function(){var a=new Bj;zj(a,this);return a};
var Aj=function(a){return JSON.stringify(a,function(c,b){if(0==c.length||!c.endsWith("_"))return b})},zj=function(a,c){for(var b=l(Object.keys(c)),d=b.next();!d.done;d=b.next())d=d.value,d.endsWith("_")||typeof c[d]!==typeof a[d]||(a[d]=c[d])},Cj=function(a){var c=Math.round(screen.width*window.devicePixelRatio),b=Math.round(screen.height*window.devicePixelRatio);b>c&&(b=l([b,c]),c=b.next().value,b=b.next().value);a.maxHeight*c<a.maxWidth*b?(c=Math.min(a.maxWidth,c),c-=c%160,b=90*c/160):(b=Math.min(a.maxHeight,
b),b-=b%90,c=160*b/90);if(c<Math.max(160,a.minWidth)||b<Math.max(90,a.minHeight))c=Math.max(160,a.minWidth),b=Math.max(90,a.minHeight);a.maxWidth=c;a.maxHeight=b},yj="mr.mirror.Settings.Overrides";var Dj=function(a,c){this.type=a;this.data=c},Ej=function(a){a=JSON.parse(a);if(!a.type)throw Error("Invalid message");return new Dj(a.type,a.data)},Fj=function(a,c,b,d,e){this.description=a;this.settings=c||null;this.mediaConstraints=b||null;this.presentationUrl=d||null;this.presentationId=e||null};var Ij=function(a,c){this.m=hb("cv2.PeerConnection");this.G=Gj;this.ga=Hj(this,c);this.h=this.ga.createDataChannel(a,{reliable:!1});this.F=new Eb;this.l=!1;this.g=0;this.f=null;this.o=this.j=0;this.b=!1;this.C=function(){};this.w=function(){};this.D=function(){};this.u=function(){}},Jj=function(a,c){a.w=c},Kj=function(a,c){a.D=c},Lj=function(a,c){a.u=c},Mj=function(a,c){a.C=c},Nj=function(a,c){a.h.onmessage=function(b){c(b.data)}},Oj=function(a){var c={};c.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);
return c},Hj=function(a,c){var b=Oj(c);c=new webkitRTCPeerConnection(b);c.onicecandidate=a.J.bind(a);c.onicegatheringstatechange=a.T.bind(a);c.oniceconnectionstatechange=a.N.bind(a);a.m.info(function(){return"Created webkitRTCPeerConnnection with config: "+JSON.stringify(b)});return c};Ij.prototype.start=function(){this.b||(this.b=!0,Pj(this))};Ij.prototype.stop=function(){this.m.info("Stopping peer connection...");this.b&&(this.b=!1,"closed"!=this.ga.signalingState&&this.ga.close());this.ga=null};
var Pj=function(a){a.m.info("Sending offer to peer.");a.j=Date.now();a.ga.createOffer(a.K.bind(a),function(c){a.m.H("Error creating offer.",c)},a.G);a.F.b.then(function(c){a.C(c)})};Ij.prototype.K=function(a){var c=this;this.m.info(function(){return"Setting local description: "+JSON.stringify(a)});this.ga.setLocalDescription(a,function(){c.m.info("Local description set successfully")},function(b){c.m.H("Error setting local description.",b)})};
var Qj=function(a,c){ob(a.m,function(){return"<===: "+JSON.stringify(c)});var b=new RTCSessionDescription(c);a.m.info(function(){return"Setting remote description: "+JSON.stringify(b)});a.ga.setRemoteDescription(b,function(){a.m.info("Remote description set successfully.")},function(d){a.m.H("Error setting remote description.",d)})};
Ij.prototype.J=function(a){var c=this;a.candidate?(this.g++,this.o=Date.now(),1==this.g?this.f=setTimeout(function(){c.m.info("ICE candidate gathering timed out.");c.f=null;Rj(c)},5E3):this.l&&this.m.H("Received ICE candidate after resolving session description.")):(this.m.info("End of ICE candidates."),vb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",Date.now()-this.j),Rj(this),0<this.g&&vb("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.o-this.j))};
Ij.prototype.T=function(){"completed"==this.ga.iceGatheringState&&Rj(this)};var Rj=function(a){clearTimeout(a.f);a.f=null;if(!a.l){a.m.info("Resolving sesion description after gathering "+a.g+" ICE candidates.");var c=a.ga.localDescription;a.F.resolve({type:c.type,sdp:c.sdp});a.l=!0}};
Ij.prototype.N=function(a){var c=this;if(this.ga){var b=this.ga.iceConnectionState;this.m.info("New ICE connection state: "+b+".");"connected"==b?this.w("iceconnected"):"completed"==b?this.w("icecompleted"):"failed"==b?(this.m.H(function(){return"Ice connection failed: "+JSON.stringify(a)}),this.D("icefailed")):"closed"==b?this.u("iceclosed"):"disconnected"==b&&(this.m.H("Ice connection state is bad."),this.b&&(this.m.info("Restarting ICE."),this.ga.createOffer(this.K.bind(this),function(d){c.m.H("Error creating new offer.",
d)},Sj)))}};var Gj={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},Sj={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};var Tj=function(){var a=window.crypto.getRandomValues(new Uint8Array(16));return Pb(a,function(c){c=c.toString(16);return 1<c.length?c:"0"+c}).join("")},Uj=function(a){for(var c=[],b=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);128>e?c[b++]=e:(2048>e?c[b++]=e>>6|192:(55296==(e&64512)&&d+1<a.length&&56320==(a.charCodeAt(d+1)&64512)?(e=65536+((e&1023)<<10)+(a.charCodeAt(++d)&1023),c[b++]=e>>18|240,c[b++]=e>>12&63|128):c[b++]=e>>12|224,c[b++]=e>>6&63|128),c[b++]=e&63|128)}return c},Vj=function(a){for(var c=
[],b=0,d=0;b<a.length;){var e=a[b++];if(128>e)c[d++]=String.fromCharCode(e);else if(191<e&&224>e){var f=a[b++];c[d++]=String.fromCharCode((e&31)<<6|f&63)}else if(239<e&&365>e){f=a[b++];var g=a[b++],k=a[b++];e=((e&7)<<18|(f&63)<<12|(g&63)<<6|k&63)-65536;c[d++]=String.fromCharCode(55296+(e>>10));c[d++]=String.fromCharCode(56320+(e&1023))}else f=a[b++],g=a[b++],c[d++]=String.fromCharCode((e&15)<<12|(f&63)<<6|g&63)}return c.join("")};var Wj={},Xj=null,Zj=function(a){var c;!1===c||void 0===c?c=0:!0===c&&(c=3);Yj();c=Wj[c];for(var b=[],d=0;d<a.length;d+=3){var e=a[d],f=d+1<a.length,g=f?a[d+1]:0,k=d+2<a.length,m=k?a[d+2]:0,p=e>>2;e=(e&3)<<4|g>>4;g=(g&15)<<2|m>>6;m&=63;k||(m=64,f||(g=64));b.push(c[p],c[e],c[g]||"",c[m]||"")}return b.join("")},bk=function(a){var c=a.length,b=3*c/4;b%3?b=Math.floor(b):-1!="=.".indexOf(a[c-1])&&(b=-1!="=.".indexOf(a[c-2])?b-2:b-1);var d=new Uint8Array(b),e=0;ak(a,function(f){d[e++]=f});return d.subarray(0,
e)},ak=function(a,c){function b(m){for(;d<a.length;){var p=a.charAt(d++),u=Xj[p];if(null!=u)return u;if(!od(p))throw Error("Unknown base64 encoding at char: "+p);}return m}Yj();for(var d=0;;){var e=b(-1),f=b(0),g=b(64),k=b(64);if(64===k&&-1===e)break;c(e<<2|f>>4);64!=g&&(c(f<<4&240|g>>2),64!=k&&c(g<<6&192|k))}},Yj=function(){if(!Xj){Xj={};for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),c=["+/=","+/","-_=","-_.","-_"],b=0;5>b;b++){var d=a.concat(c[b].split(""));
Wj[b]=d;for(var e=0;e<d.length;e++){var f=d[e];void 0===Xj[f]&&(Xj[f]=e)}}}};var ck=0,dk=0,ek=function(a){var c=0>a;a=Math.abs(a);var b=a>>>0;a=Math.floor((a-b)/4294967296);a>>>=0;c&&(a=~a>>>0,b=(~b>>>0)+1,4294967295<b&&(b=0,a++,4294967295<a&&(a=0)));ck=b;dk=a},fk=function(a){var c=0>a?1:0;a=c?-a:a;if(0===a)0<1/a?ck=dk=0:(dk=0,ck=2147483648);else if(isNaN(a))dk=0,ck=2147483647;else if(3.4028234663852886E38<a)dk=0,ck=(c<<31|2139095040)>>>0;else if(1.1754943508222875E-38>a)a=Math.round(a/Math.pow(2,-149)),dk=0,ck=(c<<31|a)>>>0;else{var b=Math.floor(Math.log(a)/Math.LN2);a*=
Math.pow(2,-b);a=Math.round(8388608*a)&8388607;dk=0;ck=(c<<31|b+127<<23|a)>>>0}},gk=function(a,c){return 4294967296*c+(a>>>0)},hk=function(a,c){var b=c&2147483648;b&&(a=~a+1>>>0,c=~c>>>0,0==a&&(c=c+1>>>0));a=gk(a,c);return b?-a:a},ik=function(a,c){function b(e,f){e=e?String(e):"";return f?"0000000".slice(e.length)+e:e}if(2097151>=c)return""+(4294967296*c+a);var d=(a>>>24|c<<8)>>>0&16777215;c=c>>16&65535;a=(a&16777215)+6777216*d+6710656*c;d+=8147497*c;c*=2;1E7<=a&&(d+=Math.floor(a/1E7),a%=1E7);1E7<=
d&&(c+=Math.floor(d/1E7),d%=1E7);return b(c,0)+b(d,c)+b(a,1)},jk=function(a,c){var b=c&2147483648;b&&(a=~a+1>>>0,c=~c+(0==a?1:0)>>>0);a=ik(a,c);return b?"-"+a:a},kk=function(a){if(a.constructor===Uint8Array)return a;if(a.constructor===ArrayBuffer)return new Uint8Array(a);if(a.constructor===Array)return new Uint8Array(a);if(a.constructor===String)return bk(a);Ib("Type not convertible to Uint8Array.");return new Uint8Array(0)};var mk=function(a,c,b){this.f=null;this.b=this.g=this.j=0;this.l=!1;a&&lk(this,a,c,b)},nk=[],ok=function(a,c,b){if(nk.length){var d=nk.pop();a&&lk(d,a,c,b);return d}return new mk(a,c,b)};mk.prototype.clone=function(){return ok(this.f,this.j,this.g-this.j)};mk.prototype.clear=function(){this.f=null;this.b=this.g=this.j=0;this.l=!1};var lk=function(a,c,b,d){a.f=kk(c);a.j=Ha(b)?b:0;a.g=Ha(d)?a.j+d:a.f.length;a.b=a.j};mk.prototype.reset=function(){this.b=this.j};
var pk=function(a,c){for(var b=128,d=0,e=0,f=0;4>f&&128<=b;f++)b=a.f[a.b++],d|=(b&127)<<7*f;128<=b&&(b=a.f[a.b++],d|=(b&127)<<28,e|=(b&127)>>4);if(128<=b)for(f=0;5>f&&128<=b;f++)b=a.f[a.b++],e|=(b&127)<<7*f+3;if(128>b)return c(d>>>0,e>>>0);Ib("Failed to read varint, encoding is invalid.");a.l=!0};
mk.prototype.h=function(){var a=this.f;var c=a[this.b+0];var b=c&127;if(128>c)return this.b+=1,b;c=a[this.b+1];b|=(c&127)<<7;if(128>c)return this.b+=2,b;c=a[this.b+2];b|=(c&127)<<14;if(128>c)return this.b+=3,b;c=a[this.b+3];b|=(c&127)<<21;if(128>c)return this.b+=4,b;c=a[this.b+4];b|=(c&15)<<28;if(128>c)return this.b+=5,b>>>0;this.b+=5;128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&128<=a[this.b++]&&this.b++;return b};mk.prototype.w=mk.prototype.h;
var qk=function(a){var c=a.f[a.b+0];var b=a.f[a.b+1];var d=a.f[a.b+2],e=a.f[a.b+3];a.b+=4;b=(c<<0|b<<8|d<<16|e<<24)>>>0;a=2*(b>>31)+1;c=b>>>23&255;b&=8388607;return 255==c?b?NaN:Infinity*a:0==c?a*Math.pow(2,-149)*b:a*Math.pow(2,c-150)*(b+Math.pow(2,23))};mk.prototype.o=function(){return this.w()};var rk=function(a){this.b=ok(a,void 0,void 0);this.w=this.b.b;this.h=this.f=-1;this.j=!1},sk=function(a){return 4==a.h};rk.prototype.reset=function(){this.b.reset();this.h=this.f=-1};
var tk=function(a){var c=a.b;if(c.b==c.g)return!1;(c=a.j)||(c=a.b,c=c.l||0>c.b||c.b>c.g);if(c)return Ib("Decoder hit an error"),!1;a.w=a.b.b;var b=a.b.h();c=b>>>3;b&=7;if(0!=b&&5!=b&&1!=b&&2!=b&&3!=b&&4!=b)return Ib("Invalid wire type: %s (at position %s)",b,a.w),a.j=!0,!1;a.f=c;a.h=b;return!0},uk=function(a){switch(a.h){case 0:if(0!=a.h)Ib("Invalid wire type for skipVarintField"),uk(a);else{for(a=a.b;a.f[a.b]&128;)a.b++;a.b++}break;case 1:1!=a.h?(Ib("Invalid wire type for skipFixed64Field"),uk(a)):
(a=a.b,a.b+=8);break;case 2:if(2!=a.h)Ib("Invalid wire type for skipDelimitedField"),uk(a);else{var c=a.b.h();a=a.b;a.b+=c}break;case 5:5!=a.h?(Ib("Invalid wire type for skipFixed32Field"),uk(a)):(a=a.b,a.b+=4);break;case 3:c=a.f;do{if(!tk(a)){Ib("Unmatched start-group tag: stream EOF");a.j=!0;break}if(4==a.h){a.f!=c&&(Ib("Unmatched end-group tag"),a.j=!0);break}uk(a)}while(1);break;default:Ib("Invalid wire encoding for field.")}};
rk.prototype.g=function(a,c){var b=this.b.g,d=this.b.h();d=this.b.b+d;this.b.g=d;c(a,this);this.b.b=d;this.b.g=b};
var vk=function(a){return!!a.b.h()},wk=function(a){return pk(a.b,hk)},xk=function(a){var c=a.b.h();a=a.b;var b=a.f,d=a.b,e=d+c,f=[];for(c="";d<e;){var g=b[d++];if(128>g)f.push(g);else if(192>g)continue;else if(224>g){var k=b[d++];f.push((g&31)<<6|k&63)}else if(240>g){k=b[d++];var m=b[d++];f.push((g&15)<<12|(k&63)<<6|m&63)}else if(248>g){k=b[d++];m=b[d++];var p=b[d++];g=(g&7)<<18|(k&63)<<12|(m&63)<<6|p&63;g-=65536;f.push((g>>10&1023)+55296,(g&1023)+56320)}8192<=f.length&&(c+=String.fromCharCode.apply(null,
f),f.length=0)}if(8192>=f.length)f=String.fromCharCode.apply(null,f);else{b="";for(e=0;e<f.length;e+=8192)b+=String.fromCharCode.apply(null,ic(f,e,e+8192));f=b}a.b=d;return c+f},yk=function(a,c){var b=a.b.h();b=a.b.b+b;for(var d=[];a.b.b<b;)d.push(c.call(a.b));return d};var zk=function(a,c){this.b=a;this.f=c},Ak=function(a){return new zk((a.b>>>1|(a.f&1)<<31)>>>0,a.f>>>1>>>0)},Bk=function(a){return new zk(a.b<<1>>>0,(a.f<<1|a.b>>>31)>>>0)};zk.prototype.add=function(a){return new zk((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};zk.prototype.sub=function(a){return new zk((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};
var Ck=function(a){var c=a&65535,b=a>>>16;a=10*c+65536*(0*c&65535)+65536*(10*b&65535);for(c=0*b+(0*c>>>16)+(10*b>>>16);4294967296<=a;)a-=4294967296,c+=1;return new zk(a>>>0,c>>>0)};
zk.prototype.toString=function(){for(var a="",c=this;0!=c.b||0!=c.f;){var b=new zk(0,0);c=new zk(c.b,c.f);for(var d=new zk(10,0),e=new zk(1,0);!(d.f&2147483648);)d=Bk(d),e=Bk(e);for(;0!=e.b||0!=e.f;)0>=(d.f<c.f||d.f==c.f&&d.b<c.b?-1:d.f==c.f&&d.b==c.b?0:1)&&(b=b.add(e),c=c.sub(d)),d=Ak(d),e=Ak(e);b=[b,c];c=b[0];a=b[1].b+a}""==a&&(a="0");return a};
var Dk=function(a){for(var c=new zk(0,0),b=new zk(0,0),d=0;d<a.length;d++){if("0">a[d]||"9"<a[d])return null;b.b=parseInt(a[d],10);var e=Ck(c.b);c=Ck(c.f);c.f=c.b;c.b=0;c=e.add(c).add(b)}return c};zk.prototype.clone=function(){return new zk(this.b,this.f)};var Ek=function(a,c){this.b=a;this.f=c};Ek.prototype.add=function(a){return new Ek((this.b+a.b&4294967295)>>>0>>>0,((this.f+a.f&4294967295)>>>0)+(4294967296<=this.b+a.b?1:0)>>>0)};
Ek.prototype.sub=function(a){return new Ek((this.b-a.b&4294967295)>>>0>>>0,((this.f-a.f&4294967295)>>>0)-(0>this.b-a.b?1:0)>>>0)};Ek.prototype.clone=function(){return new Ek(this.b,this.f)};Ek.prototype.toString=function(){var a=0!=(this.f&2147483648),c=new zk(this.b,this.f);a&&(c=(new zk(0,0)).sub(c));return(a?"-":"")+c.toString()};var Fk=function(){this.b=[]};Fk.prototype.length=function(){return this.b.length};Fk.prototype.end=function(){var a=this.b;this.b=[];return a};
var Gk=function(a,c,b){for(;0<b||127<c;)a.b.push(c&127|128),c=(c>>>7|b<<25)>>>0,b>>>=7;a.b.push(c)},Hk=function(a,c){for(;127<c;)a.b.push(c&127|128),c>>>=7;a.b.push(c)},Ik=function(a,c){if(0<=c)Hk(a,c);else{for(var b=0;9>b;b++)a.b.push(c&127|128),c>>=7;a.b.push(1)}},Jk=function(a,c){a.b.push(c>>>0&255);a.b.push(c>>>8&255);a.b.push(c>>>16&255);a.b.push(c>>>24&255)};var C=function(){this.w=[];this.j=0;this.g=new Fk;this.l=[]},Lk=function(a,c){Kk(a,c,2);c=a.g.end();a.w.push(c);a.j+=c.length;c.push(a.j);return c},Mk=function(a,c){var b=c.pop();for(b=a.j+a.g.length()-b;127<b;)c.push(b&127|128),b>>>=7,a.j++;c.push(b);a.j++};C.prototype.reset=function(){this.w=[];this.g.end();this.j=0;this.l=[]};
var D=function(a){for(var c=new Uint8Array(a.j+a.g.length()),b=a.w,d=b.length,e=0,f=0;f<d;f++){var g=b[f];c.set(g,e);e+=g.length}b=a.g.end();c.set(b,e);a.w=[c];return c},Kk=function(a,c,b){Hk(a.g,8*c+b)};C.prototype.f=function(a,c){null!=c&&null!=c&&(Kk(this,a,0),Ik(this.g,c))};
var G=function(a,c,b){null!=b&&null!=b&&(Kk(a,c,0),a=a.g,ek(b),Gk(a,ck,dk))},Nk=function(a,c,b){if(null!=b){var d=b;(b=0<d.length&&"-"==d[0])&&(d=d.substring(1));d=Dk(d);null===d?b=null:(b&&(d=(new zk(0,0)).sub(d)),b=new Ek(d.b,d.f));Kk(a,c,0);Gk(a.g,b.b,b.f)}};C.prototype.h=function(a,c){null!=c&&null!=c&&(Kk(this,a,0),Hk(this.g,c))};
var Ok=function(a,c,b){null!=b&&null!=b&&(Kk(a,c,0),a=a.g,ek(b),Gk(a,ck,dk))},Pk=function(a,c,b){null!=b&&(b=Dk(b),Kk(a,c,0),Gk(a.g,b.b,b.f))},Qk=function(a,c,b){null!=b&&(Kk(a,c,5),Jk(a.g,b))},Rk=function(a,c,b){null!=b&&(Kk(a,c,5),a=a.g,fk(b),Jk(a,ck))},Sk=function(a,c,b){if(null!=b){Kk(a,c,1);a=a.g;var d=b;d=(b=0>d?1:0)?-d:d;0===d?(dk=0<1/d?0:2147483648,ck=0):isNaN(d)?(dk=2147483647,ck=4294967295):1.7976931348623157E308<d?(dk=(b<<31|2146435072)>>>0,ck=0):2.2250738585072014E-308>d?(d/=Math.pow(2,
-1074),dk=(b<<31|d/4294967296)>>>0,ck=d>>>0):(c=Math.floor(Math.log(d)/Math.LN2),1024==c&&(c=1023),d*=Math.pow(2,-c),dk=(b<<31|c+1023<<20|1048576*d&1048575)>>>0,ck=4503599627370496*d>>>0);Jk(a,ck);Jk(a,dk)}},H=function(a,c,b){null!=b&&(Kk(a,c,0),a.g.b.push(b?1:0))},I=function(a,c,b){null!=b&&(Kk(a,c,0),Ik(a.g,b))},K=function(a,c,b){if(null!=b){c=Lk(a,c);for(var d=a.g,e=0;e<b.length;e++){var f=b.charCodeAt(e);if(128>f)d.b.push(f);else if(2048>f)d.b.push(f>>6|192),d.b.push(f&63|128);else if(65536>f)if(55296<=
f&&56319>=f&&e+1<b.length){var g=b.charCodeAt(e+1);56320<=g&&57343>=g&&(f=1024*(f-55296)+g-56320+65536,d.b.push(f>>18|240),d.b.push(f>>12&63|128),d.b.push(f>>6&63|128),d.b.push(f&63|128),e++)}else d.b.push(f>>12|224),d.b.push(f>>6&63|128),d.b.push(f&63|128)}Mk(a,c)}},Tk=function(a,c,b){null!=b&&(b=kk(b),Kk(a,c,2),Hk(a.g,b.length),c=a.g.end(),a.w.push(c),a.w.push(b),a.j+=c.length+b.length)};C.prototype.b=function(a,c,b){null!=c&&(a=Lk(this,a),b(c,this),Mk(this,a))};
var Uk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Kk(e,c,0),Ik(e.g,f))}},Vk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Kk(e,c,0),e=e.g,ek(f),Gk(e,ck,dk))}},Wk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++){var e=a,f=b[d];null!=f&&(Kk(e,c,0),Hk(e.g,f))}},Xk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)Qk(a,c,b[d])},Yk=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)I(a,c,b[d])},Zk=function(a,c,b){if(null!=
b)for(var d=0;d<b.length;d++)K(a,c,b[d])},$k=function(a,c,b){if(null!=b)for(var d=0;d<b.length;d++)Tk(a,c,b[d])},L=function(a,c,b,d){if(null!=b)for(var e=0;e<b.length;e++){var f=Lk(a,c);d(b[e],a);Mk(a,f)}},al=function(a,c,b,d){if(null!=b)for(var e=0;e<b.length;e++)Kk(a,c,3),d(b[e],a),Kk(a,c,4)},bl=function(a,c,b){if(null!=b&&b.length){c=Lk(a,c);for(var d=0;d<b.length;d++)Ik(a.g,b[d]);Mk(a,c)}},cl=function(a,c,b){if(null!=b&&b.length){c=Lk(a,c);for(var d=0;d<b.length;d++)Ik(a.g,b[d]);Mk(a,c)}};var el=function(a){this.f=a;this.b={};this.g=!0;if(0<this.f.length){for(a=0;a<this.f.length;a++){var c=this.f[a],b=c[0];this.b[b.toString()]=new dl(b,c[1])}this.g=!0}};el.prototype.oc=function(){var a;if(!this.g){this.f.length=0;var c=fl(this);c.sort();for(var b=0;b<c.length;b++){var d=this.b[c[b]];(a=d.b)&&a.oc();this.f.push([d.key,d.value])}this.g=!0}return this.f};var gl=function(a){this.b=0;this.f=a};
gl.prototype.next=function(){return this.b<this.f.length?{done:!1,value:this.f[this.b++]}:{done:!0,value:void 0}};"undefined"!=typeof Symbol&&(gl.prototype[Symbol.iterator]=function(){return this});h=el.prototype;h.clear=function(){this.b={};this.g=!1};h.entries=function(){var a=[],c=fl(this);c.sort();for(var b=0;b<c.length;b++){var d=this.b[c[b]];a.push([d.key,d.value])}return new gl(a)};h.keys=function(){var a=[],c=fl(this);c.sort();for(var b=0;b<c.length;b++)a.push(this.b[c[b]].key);return new gl(a)};
h.values=function(){var a=[],c=fl(this);c.sort();for(var b=0;b<c.length;b++)a.push(this.b[c[b]].value);return new gl(a)};h.forEach=function(a,c){var b=fl(this);b.sort();for(var d=0;d<b.length;d++){var e=this.b[b[d]];a.call(c,e.value,e.key,this)}};h.set=function(a,c){var b=new dl(a);b.value=c;this.b[a.toString()]=b;this.g=!1;return this};h.get=function(a){if(a=this.b[a.toString()])return a.value};h.has=function(a){return a.toString()in this.b};
h.s=function(a,c,b,d){var e=fl(this);e.sort();for(var f=0;f<e.length;f++){var g=this.b[e[f]];c.l.push(Lk(c,a));b.call(c,1,g.key);d.call(c,2,g.value);Mk(c,c.l.pop())}};var fl=function(a){a=a.b;var c=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c},dl=function(a,c){this.key=a;this.value=c;this.b=void 0};var M=function(){},hl="function"==typeof Uint8Array,N=function(a,c,b,d,e,f){a.b=null;c||(c=b?[b]:[]);a.yf=b?String(b):void 0;a.j=0===b?-1:0;a.f=c;a:{b=a.f.length;c=-1;if(b&&(c=b-1,b=a.f[c],!(null===b||"object"!=typeof b||Va(b)||hl&&b instanceof Uint8Array))){a.l=c-a.j;a.g=b;break a}-1<d?(a.l=Math.max(d,c+1-a.j),a.g=null):a.l=Number.MAX_VALUE}a.o={};if(e)for(d=0;d<e.length;d++)c=e[d],c<a.l?(c+=a.j,a.f[c]=a.f[c]||il):(jl(a),a.g[c]=a.g[c]||il);if(f&&f.length)for(d=0;d<f.length;d++)kl(a,f[d])},il=Object.freeze?
Object.freeze([]):[],jl=function(a){var c=a.l+a.j;a.f[c]||(a.g=a.f[c]={})},ll=function(a,c,b,d){for(var e in b){var f=b[e],g=f.Cq;if(!f.Bi)throw Error("Message extension present that was generated without binary serialization support");var k=d.call(a,g);if(null!=k)if(g.Yd)if(f.Bl)f.Bi.call(c,g.Ll,k,f.Bl);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else f.Bi.call(c,g.Ll,k)}},O=function(a,c){if(c<a.l){c+=
a.j;var b=a.f[c];return b===il?a.f[c]=[]:b}if(a.g)return b=a.g[c],b===il?a.g[c]=[]:b},ml=function(a,c){a=O(a,c);return null==a?a:+a},nl=function(a,c){a=O(a,c);return null==a?a:!!a},ol=function(a,c){var b=O(a,c);a.o||(a.o={});if(!a.o[c]){for(var d=0;d<b.length;d++)b[d]=+b[d];a.o[c]=!0}return b},pl=function(a){if(null==a||a instanceof Uint8Array)return a;if(Ia(a))return bk(a);Ib("Cannot coerce to Uint8Array: "+Sa(a));return null},rl=function(a){ql(a);return!a.length||a[0]instanceof Uint8Array?a:Pb(a,
pl)},ql=function(a){if(a&&1<a.length){var c=Sa(a[0]);Mb(a,function(b){Sa(b)!=c&&Ib("Inconsistent type in JSPB repeated field array. Got "+Sa(b)+" expected "+c)})}},P=function(a,c,b){a=O(a,c);return null==a?b:a},sl=function(a,c,b){a=nl(a,c);return null==a?b:a},tl=function(a,c){a=ml(a,c);return null==a?0:a},Q=function(a,c,b){c<a.l?a.f[c+a.j]=b:(jl(a),a.g[c]=b);return a},vl=function(a,c,b){return ul(a,c,b,"")},wl=function(a,c,b){ul(a,c,b,0)},ul=function(a,c,b,d){b!==d?Q(a,c,b):a.f[c+a.j]=null;return a},
xl=function(a,c,b,d){(b=kl(a,b))&&b!==c&&void 0!==d&&(a.b&&b in a.b&&(a.b[b]=void 0),Q(a,b,void 0));return Q(a,c,d)},kl=function(a,c){for(var b,d,e=0;e<c.length;e++){var f=c[e],g=O(a,f);null!=g&&(b=f,d=g,Q(a,f,void 0))}return b?(Q(a,b,d),b):0},R=function(a,c,b,d){a.b||(a.b={});if(!a.b[b]){var e=O(a,b);if(d||e)a.b[b]=new c(e)}return a.b[b]},T=function(a,c,b){yl(a,c,b);c=a.b[b];c==il&&(c=a.b[b]=[]);return c},yl=function(a,c,b){a.b||(a.b={});if(!a.b[b]){for(var d=O(a,b),e=[],f=0;f<d.length;f++)e[f]=
new c(d[f]);a.b[b]=e}},U=function(a,c,b){a.b||(a.b={});var d=b?b.oc():b;a.b[c]=b;return Q(a,c,d)},Al=function(a,c,b){var d=zl[0];a.b||(a.b={});var e=b?b.oc():b;a.b[c]=b;xl(a,c,d,e)},Bl=function(a,c,b){a.b||(a.b={});b=b||[];for(var d=[],e=0;e<b.length;e++)d[e]=b[e].oc();a.b[c]=b;return Q(a,c,d)},Cl=function(a,c,b,d,e){yl(a,d,c);var f=a.b[c];f||(f=a.b[c]=[]);b=b?b:new d;a=O(a,c);void 0!=e?(f.splice(e,0,b),a.splice(e,0,b.oc())):(f.push(b),a.push(b.oc()));return b},Dl=function(a){if(a.b)for(var c in a.b){var b=
a.b[c];if(Va(b))for(var d=0;d<b.length;d++)b[d]&&b[d].oc();else b&&b.oc()}};M.prototype.oc=function(){Dl(this);return this.f};M.prototype.Ca=hl?function(){var a=Uint8Array.prototype.toJSON;Uint8Array.prototype.toJSON=function(){return Zj(this)};try{return JSON.stringify(this.f&&this.oc(),El)}finally{Uint8Array.prototype.toJSON=a}}:function(){return JSON.stringify(this.f&&this.oc(),El)};var El=function(a,c){return r(c)&&(isNaN(c)||Infinity===c||-Infinity===c)?String(c):c};
M.prototype.toString=function(){Dl(this);return this.f.toString()};M.prototype.w=function(a){if(this.g)return this.b||(this.b={}),a.Yd?(!this.b[175237375]&&this.g[175237375]&&(this.b[175237375]=new a.Yd(this.g[175237375])),this.b[175237375]):this.g[175237375]};
var Gl=function(a,c){a=a||{};c=c||{};var b={},d;for(d in a)b[d]=0;for(d in c)b[d]=0;for(d in b)if(!Fl(a[d],c[d]))return!1;return!0},Fl=function(a,c){if(a==c)return!0;if(!Ya(a)||!Ya(c))return r(a)&&isNaN(a)||r(c)&&isNaN(c)?String(a)==String(c):!1;if(a.constructor!=c.constructor)return!1;if(hl&&a.constructor===Uint8Array){if(a.length!=c.length)return!1;for(var b=0;b<a.length;b++)if(a[b]!=c[b])return!1;return!0}if(a.constructor===Array){var d=void 0,e=void 0,f=Math.max(a.length,c.length);for(b=0;b<f;b++){var g=
a[b],k=c[b];g&&g.constructor==Object&&(d=g,g=void 0);k&&k.constructor==Object&&(e=k,k=void 0);if(!Fl(g,k))return!1}return d||e?(d=d||{},e=e||{},Gl(d,e)):!0}if(a.constructor===Object)return Gl(a,c);throw Error("Invalid type in JSPB array");};M.prototype.clone=function(){return Hl(this)};
var Hl=function(a){return new a.constructor(Il(a.oc()))},Il=function(a){if(Va(a)){for(var c=Array(a.length),b=0;b<a.length;b++){var d=a[b];null!=d&&(c[b]="object"==typeof d?Il(d):d)}return c}if(hl&&a instanceof Uint8Array)return new Uint8Array(a);c={};for(b in a)d=a[b],null!=d&&(c[b]="object"==typeof d?Il(d):d);return c};var Jl=function(a){N(this,a,0,-1,null,null)};x(Jl,M);var Kl=function(a){N(this,a,0,-1,null,null)};x(Kl,M);var Ml=function(a,c){for(;tk(c)&&!sk(c);)switch(c.f){case 1:var b=pk(c.b,hk);Q(a,1,b);break;case 2:b=xk(c);Q(a,2,b);break;case 3:b=new Kl;c.g(b,Ll);U(a,3,b);break;default:uk(c)}return a};Jl.prototype.s=function(){var a=new C;Nl(this,a);return D(a)};
var Nl=function(a,c){var b=O(a,1);null!=b&&G(c,1,b);b=O(a,2);null!=b&&K(c,2,b);b=R(a,Kl,3);null!=b&&c.b(3,b,Ol)},Ll=function(a,c){for(;tk(c)&&!sk(c);)switch(c.f){case 1:var b=xk(c);Q(a,1,b);break;case 2:b=pk(c.b,hk);Q(a,2,b);break;default:uk(c)}return a};Kl.prototype.s=function(){var a=new C;Ol(this,a);return D(a)};var Ol=function(a,c){var b=O(a,1);null!=b&&K(c,1,b);b=O(a,2);null!=b&&G(c,2,b)};Jl.prototype.Pb=function(){return O(this,1)};var Pl=function(a,c){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=c;this.logRecord=this.deviceJustSetUp=void 0};w("castApp.eventPage.Message",Pl);var Ql=function(a,c,b){this.ipAddress=a;this.appId=c;this.sessionId=b};Pl.DeviceData=Ql;Pl.DeviceJustSetUp=function(a,c,b,d){this.ipAddress=a;this.name=c;this.udn=b;this.modelName=d};Pl.DeviceCapabilities=function(){};
Pl.LogRecord=function(a,c,b,d){this.levelValue=a;this.msg=c;this.loggerName=b;this.time=d};var Rl=function(a,c){this.type=a;this.entryPoint=c};w("castApp.frontEnd.ExtensionMessage",Rl);var Sl=function(a){return"urn:x-cast:com.google.cast."+a},Tl=Sl("tp.connection"),Ul=Sl("receiver"),Vl=Sl("remoting"),Wl=Sl("media"),Xl=Sl("webrtc"),Yl=Sl("broadcast"),Zl=Qc({kA:Tl,lA:Sl("tp.heartbeat"),Uy:Ul,Zy:Vl,cx:Wl,gx:Sl("media.universalRemote.optIn"),SA:Xl,su:Yl});var $l=function(a){return"available"==a||"available_rescan"==a};var am=function(a,c,b,d,e){this.id=a;this.friendlyName=c;this.iconType=b||"generic";this.description=void 0===d?null:d;this.domain=void 0===e?null:e};var bm=window.localStorage,cm=0,em=function(a){return(a=window.localStorage.getItem(dm(a,!1)))?JSON.parse(a):null},fm=function(a){return(a=window.localStorage.getItem(dm(a,!0)))?JSON.parse(a):null},hm=function(a){if(gm.has(a.Fa()))throw Error("Duplicate instance name "+a.Fa());gm.set(a.Fa(),a);a.pb()},nm=function(a){for(var c=0,b=l(Object.keys(bm)),d=b.next();!d.done;d=b.next()){d=d.value;var e=d.length+window.localStorage.getItem(d).length;d.startsWith("mr.")?cm+=e:c+=e}im=a;(window.localStorage.getItem("version")&&
window.localStorage.getItem("version")!==chrome.runtime.getManifest().version||jm(a))&&km();lm.info("initialize: "+cm+" chars used, "+c+" other chars");chrome.runtime.onSuspend.addListener(mm)},im=null,lm=hb("mr.PersistentDataManager"),gm=new Map,dm=function(a,c){return"mr."+(c?"persistent.":"temp.")+a.Fa()},jm=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},mm=function(){lm.info("onSuspend");om("version",chrome.runtime.getManifest().version);
im&&om("mrInstanceId",im);for(var a=gm.get("LogManager"),c=l(gm),b=c.next();!b.done;b=c.next())b=l(b.value),b.next(),b=b.next().value,b!=a&&pm(b);a&&pm(a)},pm=function(a){try{var c=a.rb();c&&void 0!=c[0]&&om(dm(a,!1),JSON.stringify(c[0]));c&&void 0!=c[1]&&om(dm(a,!0),JSON.stringify(c[1]))}catch(b){lm.error("Error while saving data for "+a.Fa()+": "+b.message)}},om=function(a,c){var b=window.localStorage.getItem(a);b=null!=b?c.length-b.length:a.length+c.length;52E5<cm+b&&(lm.H("Unable to write "+b+
" chars"),km());if(52E5<cm+b)throw lm.error("Unable to write "+b+" chars after clearing temporary"),Error("Setting the value of '"+a+"' would exceed the quota, according to accounting.");try{window.localStorage.setItem(a,c)}catch(d){throw Error("Setting the value of '"+a+"' would exceed the quota, according to the browser.");}cm+=b},qm=function(a){a=0==a.size%2?new Blob([a,new Uint8Array([0,0])]):new Blob([a,new Uint8Array([1])]);return new Promise(function(c,b){var d=new FileReader;d.onloadend=function(){if(d.error)b(d.error);
else try{for(var e=d.result,f=[],g=0,k=e.byteLength;g<k;g+=8192)f.push(String.fromCharCode.apply(null,new Uint16Array(e,g,Math.min(k-g,8192)/2)));om("mr.temp.mirror.cast.Service.eventsBlob",f.join(""));c()}catch(m){b(m)}};d.readAsArrayBuffer(a)})},km=function(){for(var a=l(Object.keys(bm)),c=a.next();!c.done;c=a.next())c=c.value,c.startsWith("mr.temp.")&&(cm-=c.length+window.localStorage.getItem(c).length,delete window.localStorage[c]);lm.info("removeTemporary_: "+cm+" chars used")};var rm=(new Map).set("+","-").set("/","_").set("=","."),sm=(new Map).set("-","+").set("_","/").set(".","="),tm=function(a){return atob(a.replace(/[-_.]/g,function(c){return sm.get(c)}))},um=function(a){return btoa(String.fromCharCode.apply(String,n(a))).replace(/[+/=]/g,function(c){return rm.get(c)})};var vm=function(){this.b=[];this.j=[];this.w=[];this.g=[];this.g[0]=128;for(var a=1;64>a;++a)this.g[a]=0;this.h=this.f=0;this.reset()};vm.prototype.reset=function(){this.b[0]=1732584193;this.b[1]=4023233417;this.b[2]=2562383102;this.b[3]=271733878;this.b[4]=3285377520;this.h=this.f=0};
var wm=function(a,c,b){b=void 0===b?0:b;var d=a.w;if("string"===typeof c)for(var e=0;16>e;e++)d[e]=c.charCodeAt(b)<<24|c.charCodeAt(b+1)<<16|c.charCodeAt(b+2)<<8|c.charCodeAt(b+3),b+=4;else for(e=0;16>e;e++)d[e]=c[b]<<24|c[b+1]<<16|c[b+2]<<8|c[b+3],b+=4;for(c=16;80>c;c++)b=d[c-3]^d[c-8]^d[c-14]^d[c-16],d[c]=(b<<1|b>>>31)&4294967295;c=a.b[0];b=a.b[1];e=a.b[2];for(var f=a.b[3],g=a.b[4],k,m,p=0;80>p;p++)40>p?20>p?(k=f^b&(e^f),m=1518500249):(k=b^e^f,m=1859775393):60>p?(k=b&e|f&(b|e),m=2400959708):(k=
b^e^f,m=3395469782),k=(c<<5|c>>>27)+k+g+m+d[p]&4294967295,g=f,f=e,e=(b<<30|b>>>2)&4294967295,b=c,c=k;a.b[0]=a.b[0]+c&4294967295;a.b[1]=a.b[1]+b&4294967295;a.b[2]=a.b[2]+e&4294967295;a.b[3]=a.b[3]+f&4294967295;a.b[4]=a.b[4]+g&4294967295};
vm.prototype.update=function(a,c){c=void 0===c?a.length:c;for(var b=c-64,d=0,e=this.j,f=this.f;d<c;){if(0==f)for(;d<=b;)wm(this,a,d),d+=64;if("string"===typeof a)for(;d<c;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){wm(this,e);f=0;break}}else for(;d<c;)if(e[f]=a[d],++f,++d,64==f){wm(this,e);f=0;break}}this.f=f;this.h+=c};
vm.prototype.digest=function(){var a=[],c=8*this.h;56>this.f?this.update(this.g,56-this.f):this.update(this.g,64-(this.f-56));for(var b=63;56<=b;b--)this.j[b]=c&255,c/=256;wm(this,this.j);for(b=c=0;5>b;b++)for(var d=24;0<=d;d-=8)a[c]=this.b[b]>>d&255,++c;return a};var xm=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)};var zm=function(){this.j=xm();this.f=new ym(null,null);this.b=new ym(null,null);this.w=[];this.g=this.h=0;hm(this)},Bm=function(){Am||(Am=new zm);return Am},Cm=function(a,c){c=c.toLowerCase();var b=new vm;b.update(c);b.update(a.j);return"r"+um(b.digest())},Dm=function(){var a=Bm();return a.f.model?a.f:a.b.model?a.b:new ym(null,null)};zm.prototype.Fa=function(){return"SinkUtils"};
zm.prototype.rb=function(){return[{recentLaunchedDevice:this.f,recentDiscoveredDevice:this.b},{receiverIdToken:this.j,fixedIpList:this.w.join(","),castControlPort:this.h,lastCloudSinkCheckTimeMillis:this.g}]};
zm.prototype.pb=function(){var a=em(this);a&&(this.f=a.recentLaunchedDevice||new ym(null,null),this.b=a.recentDiscoveredDevice||new ym(null,null));if(a=fm(this))this.j=a.receiverIdToken||xm(),this.w=a.fixedIpList&&a.fixedIpList.split(",")||[],this.h=a.castControlPort||0,this.g=a.lastCloudSinkCheckTimeMillis||0};var Am=null,ym=function(a,c){this.model=a;this.ip=c};var Em=function(a,c){this.Dc=this.Ef=this.Wd=this.La=this.pc=null;this.Ec=new am(c,a);this.lc={};this.Nh={};this.Ie=!1};Em.prototype.getId=function(){return this.Ec.id};Em.prototype.update=function(a){if(this.getId()!=a.getId())return!1;var c=!1;this.Ec.friendlyName!=a.Ec.friendlyName&&(this.Ec.friendlyName=a.Ec.friendlyName,c=!0);this.Wd!=a.Wd&&(this.Wd=a.Wd,c=!0);this.Ef!=a.Ef&&(this.Ef=a.Ef,c=!0);this.pc!=a.pc&&(this.pc=a.pc,c=!0);this.La!=a.La&&(this.La=a.La,c=!0);return c};Em.prototype.Yb=function(){return this.pc};
Em.prototype.Fb=function(){return this.La};var Fm=function(a,c){return a.lc[c]||"unknown"},Gm=function(a){var c=new Em(a.Ec.friendlyName,"");c.Ec.id=a.Ec.id;c.pc=a.pc;c.La=a.La;c.Wd=a.Wd;c.Ef=a.Ef;c.Dc=a.Dc;c.lc=a.lc;c.Nh=a.Nh;c.Ie=a.Ie;return c};var Hm=function(a,c,b,d,e,f){this.f=new am(a,c,d&1?"cast":d&32?"cast_audio_group":"cast_audio");this.Dc=b||null;this.b=d||null;this.pc=e||null;this.La=f||null;this.lc={};this.Gi=!1};Hm.prototype.update=function(a,c,b,d){var e=!1;this.f.friendlyName!=a&&(this.f.friendlyName=a,e=!0);null!=c&&this.pc!=c&&(this.pc=c,e=!0);null!=b&&this.La!=b&&(this.La=b,e=!0);null!=d&&this.b!=d&&(this.b=d,e=!0);return e};Hm.prototype.getId=function(){return this.f.id};Hm.prototype.Yb=function(){return this.pc};
Hm.prototype.Fb=function(){return this.La};var Im=function(a,c){return a.lc[c]||"unknown"};var Jm="StopIteration"in Ga?Ga.StopIteration:{message:"StopIteration",stack:""},Km=function(){};Km.prototype.next=function(){throw Jm;};Km.prototype.Rb=function(){return this};
var Lm=function(a){if(a instanceof Km)return a;if("function"==typeof a.Rb)return a.Rb(!1);if(Wa(a)){var c=0,b=new Km;b.next=function(){for(;;){if(c>=a.length)throw Jm;if(c in a)return a[c++];c++}};return b}throw Error("Not implemented");},Mm=function(a,c,b){if(Wa(a))try{Mb(a,c,b)}catch(d){if(d!==Jm)throw d;}else{a=Lm(a);try{for(;;)c.call(b,a.next(),void 0,a)}catch(d){if(d!==Jm)throw d;}}},Nm=function(a,c){a=Lm(a);try{for(;!c.call(void 0,a.next(),void 0,a););}catch(b){if(b!==Jm)throw b;}},Om=function(a){if(Wa(a))return y(a);
a=Lm(a);var c=[];Mm(a,function(b){c.push(b)});return c};var Qm=function(a,c){this.f={};this.b=[];this.h=this.g=0;var b=arguments.length;if(1<b){if(b%2)throw Error("Uneven number of arguments");for(var d=0;d<b;d+=2)this.set(arguments[d],arguments[d+1])}else a&&Pm(this,a)};Qm.prototype.sa=function(){return this.g};Qm.prototype.pa=function(){Rm(this);for(var a=[],c=0;c<this.b.length;c++)a.push(this.f[this.b[c]]);return a};Qm.prototype.Lb=function(){Rm(this);return this.b.concat()};var Tm=function(a,c){return Sm(a.f,c)};
Qm.prototype.Jf=function(a){for(var c=0;c<this.b.length;c++){var b=this.b[c];if(Sm(this.f,b)&&this.f[b]==a)return!0}return!1};Qm.prototype.equals=function(a,c){if(this===a)return!0;if(this.g!=a.sa())return!1;c=c||Um;Rm(this);for(var b,d=0;b=this.b[d];d++)if(!c(this.get(b),a.get(b)))return!1;return!0};var Um=function(a,c){return a===c};Qm.prototype.Vb=function(){return 0==this.g};Qm.prototype.clear=function(){this.f={};this.h=this.g=this.b.length=0};
Qm.prototype.remove=function(a){return Sm(this.f,a)?(delete this.f[a],this.g--,this.h++,this.b.length>2*this.g&&Rm(this),!0):!1};var Rm=function(a){if(a.g!=a.b.length){for(var c=0,b=0;c<a.b.length;){var d=a.b[c];Sm(a.f,d)&&(a.b[b++]=d);c++}a.b.length=b}if(a.g!=a.b.length){var e={};for(b=c=0;c<a.b.length;)d=a.b[c],Sm(e,d)||(a.b[b++]=d,e[d]=1),c++;a.b.length=b}};Qm.prototype.get=function(a,c){return Sm(this.f,a)?this.f[a]:c};
Qm.prototype.set=function(a,c){Sm(this.f,a)||(this.g++,this.b.push(a),this.h++);this.f[a]=c};var Pm=function(a,c){if(c instanceof Qm)for(var b=c.Lb(),d=0;d<b.length;d++)a.set(b[d],c.get(b[d]));else for(b in c)a.set(b,c[b])};Qm.prototype.forEach=function(a,c){for(var b=this.Lb(),d=0;d<b.length;d++){var e=b[d],f=this.get(e);a.call(c,f,e,this)}};Qm.prototype.clone=function(){return new Qm(this)};var Vm=function(a){Rm(a);for(var c={},b=0;b<a.b.length;b++){var d=a.b[b];c[d]=a.f[d]}return c};
Qm.prototype.Rb=function(a){Rm(this);var c=0,b=this.h,d=this,e=new Km;e.next=function(){if(b!=d.h)throw Error("The map has changed since the iterator was created");if(c>=d.b.length)throw Jm;var f=d.b[c++];return a?f:d.f[f]};return e};var Sm=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};var Wm=function(a,c){this.h=c;this.f=a;this.f.qa=this.qa.bind(this);this.b=new Qm;this.j=new Qm;this.m=hb("mr.cast.SinkDiscoveryService");this.g={vg:0,Jg:0}};q(Wm,Si);Wm.prototype.init=function(){hm(this);cj("mr.cast.SinkDiscoveryService",this)};
var dn=function(a,c){a.m.info("addSinks returned "+c.length+" sinks");ob(a.m,function(){return"....the list is: "+JSON.stringify(c)});var b=new Set(a.b.Lb());c.forEach(function(e){var f=e.sink_id;var g=e.extra_data.cast_media_sink,k=g.ip_endpoint?g.ip_endpoint.address:g.ip_address,m=g.ip_endpoint?g.ip_endpoint.port:Bm().h||8009;f=new Hm(f,e.name,g.model_name,g.capabilities,k.address_bytes.join("."),m);g=a.b.get(f.getId());k=a.f;e=e.extra_data.cast_media_sink.cast_channel_id;m=f.getId();var p=k.f.get(m);
if(!p||p.channelId!=e){Xm.info("Added cast channel "+e+" to receiver: "+m);p&&k.b.remove(p.channelId);p={auth:"ssl_verified",ipAddress:f.Yb(),port:f.Fb()};p={channelId:e,readyState:"open",keepAlive:!0,audioOnly:!(f.b&1),connectInfo:p};k.f.set(m,p);k.b.set(e,m);var u=k.h.get(m);u&&u.channelId!=e&&(Xm.info("Re-connected to receiver: "+f.getId()),Ym(k.g,u,p),Zm(k.j.j,f,!0));k.h.set(m,p)}if(g){if(k=g.update(f.f.friendlyName,f.Yb(),f.Fb(),f.b))g.Gi=!1;k&&$m(a.h,g)}else a.m.info("Adding sink "+f.getId()),
an(a,f),g=a.h,g.g.onSinkAvailabilityUpdated(g,1),$m(g,f),Zm(g.j,f),Bm().b=new ym(f.Dc,f.Yb());b.delete(f.getId())});b.forEach(function(e){var f=a.f,g=f.h.get(e);g&&(bn(f.g,g),f.h.remove(e));cn(a,e)});var d=a.b.sa();a.g={vg:d,Jg:d}};Wm.prototype.Ze=function(){return this.g};
var an=function(a,c){var b=a.b.get(c.getId()),d=null,e=c.Yb(),f=c.Fb();null!=e&&null!=f&&(d=a.j.get(e+":"+f));if(b&&!d){var g=c.Yb(),k=c.Fb();g&&k&&a.j.remove(g+":"+k)}d&&!b&&a.b.remove(d.getId());a.b.set(c.getId(),c);null!=e&&null!=f&&a.j.set(e+":"+f,c)},cn=function(a,c){var b=a.b.get(c);if(b){a.m.info("Removing sink "+c);a.b.remove(c);c=b.Yb();var d=b.Fb();null!=c&&null!=d&&a.j.remove(c+":"+d);a=a.h;if(0==a.b.b.sa())a.g.onSinkAvailabilityUpdated(a,0);c=a.j;b=b.getId();(b=en(c.b,b))&&b.session&&
fn(c,b.session.sessionId);gn(a.F);a.g.gd()}},jn=function(a){a.m.info("Pruning inactive sinks.");var c=new Set;a.b.forEach(function(b){hn(a.f,b)||c.add(b.getId())});c.forEach(function(b){return cn(a,b)})};Wm.prototype.qa=function(a){return this.b.get(a,null)};var kn=function(a,c){var b=[];Mm(a.b.Rb(!1),function(d){$l(Im(d,c))&&b.push(d)});return b};Wm.prototype.Fa=function(){return"cast.SinkDiscoveryService"};
Wm.prototype.rb=function(){var a=this,c={};Mm(this.b.Rb(!0),function(b){var d=a.b.get(b);d={id:d.getId(),ip:d.Yb(),port:d.Fb(),friendlyName:d.f.friendlyName,modelName:d.Dc,capabilities:d.b,discoveredByDial:d.Gi,appStatusMap:d.lc};c[b]=d});return[new ln(c,this.g)]};
Wm.prototype.pb=function(){var a=em(this);if(a&&4==a.version){this.g=a.deviceCounts;a=a.sinkMap;for(var c in a){var b=void 0,d=a[c],e=new Hm("",d.friendlyName,d.modelName,d.capabilities,d.ip,d.port);e.f.id=d.id;e.Gi=d.discoveredByDial;e.lc=d.appStatusMap;for(b in e.lc)"unavailable"==e.lc[b]&&(e.lc[b]="unavailable_rescan");b=e;this.qa(b.getId())||an(this,b)}jn(this)}};var ln=function(a,c){this.sinkMap=a;this.deviceCounts=c;this.version=4};var mn={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var nn=function(){this.type="GET_STATUS";this.requestId=0};var on=function(a,c){this.requestId=a;this.ih=c;this.Pn=null};on.prototype.b=function(){};var pn=function(){this.b=new Qm},qn=function(a,c){a.b.set(c.requestId,c);c.Pn=setTimeout(function(){a.b.remove(c.requestId);c.b()},c.ih)},rn=function(a,c){var b=a.b.get(c);if(!b)return null;clearTimeout(b.Pn);a.b.remove(c);return b};var sn=function(a,c,b){this.type="APPLICATION_BROADCAST";this.requestId=0;this.appIds=a;this.namespace=c;this.message=b};var tn=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var un=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var vn=function(a){this.f=a;this.b=1E3*Math.floor(1E6*Math.random())},wn=function(a){var c=a.b++;0==c&&(c=a.b++);return c};vn.prototype.Fa=function(){return"IdGenerator."+this.f};vn.prototype.rb=function(){return[this.b]};vn.prototype.pb=function(){var a=em(this);a&&(this.b=a)};var xn=function(a,c){this.f=a;this.g=c;this.b=new pn;this.h=new vn("cast.RequestIdGenerator")};xn.prototype.init=function(){hm(this.h)};var zn=function(a,c,b,d){var e=wn(a.h);c.requestId=e;c=new Eb;b=new yn(e,c,r(b)&&0<b?b:6E5,d);qn(a.b,b);return b};
xn.prototype.sendRequest=function(a,c,b,d,e,f){var g=this;if(!Zl.hasOwnProperty(b))return Promise.reject(Error("Custom namespace is not supported"));var k=zn(this,a,Ha(d)?d:3E3,e),m=k.Cb;An(this.f,c,b,a,e||this.g,f).then(null,function(){rn(g.b,k.requestId);m.reject(Bn)});return m.b};
xn.prototype.sendMessage=function(a,c,b,d,e,f){var g=this,k=zn(this,a,Ha(d)?d:3E3,e),m=k.Cb;An(this.f,c,b,a,e||this.g,f).then(function(){rn(g.b,k.requestId);m.resolve(!0)},function(){rn(g.b,k.requestId);m.reject(Bn)});return m.b};
var Cn=function(a,c,b){var d=new tn(c.appId);d.language=c.language?c.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return a.sendRequest(d,b,Ul,c.requestSessionTimeout)},Dn=Error("Timeout"),Bn=Error("Failed to send message"),yn=function(a,c,b,d){on.call(this,a,b);this.Cb=c;this.sourceId=d};q(yn,on);yn.prototype.b=function(){this.Cb.reject(Dn)};var En=function(a){return a.sa&&"function"==typeof a.sa?a.sa():Wa(a)||Ia(a)?a.length:Fc(a)},Fn=function(a){if(a.pa&&"function"==typeof a.pa)return a.pa();if(Ia(a))return a.split("");if(Wa(a)){for(var c=[],b=a.length,d=0;d<b;d++)c.push(a[d]);return c}return Ic(a)},Gn=function(a){if(a.Lb&&"function"==typeof a.Lb)return a.Lb();if(!a.pa||"function"!=typeof a.pa){if(Wa(a)||Ia(a)){var c=[];a=a.length;for(var b=0;b<a;b++)c.push(b);return c}return Jc(a)}},Hn=function(a){return a.Vb&&"function"==typeof a.Vb?
a.Vb():Wa(a)||Ia(a)?Xb(a):Mc(a)},In=function(a,c,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(c,b);else if(Wa(a)||Ia(a))Mb(a,c,b);else for(var d=Gn(a),e=Fn(a),f=e.length,g=0;g<f;g++)c.call(b,e[g],d&&d[g],a)},Jn=function(a,c,b){if("function"==typeof a.map)return a.map(c,b);if(Wa(a)||Ia(a))return Pb(a,c,b);var d=Gn(a),e=Fn(a),f=e.length;if(d){var g={};for(var k=0;k<f;k++)g[d[k]]=c.call(b,e[k],d[k],a)}else for(g=[],k=0;k<f;k++)g[k]=c.call(b,e[k],void 0,a);return g},Kn=function(a,c){if("function"==
typeof a.every)return a.every(c,void 0);if(Wa(a)||Ia(a))return Sb(a,c,void 0);for(var b=Gn(a),d=Fn(a),e=d.length,f=0;f<e;f++)if(!c.call(void 0,d[f],b&&b[f],a))return!1;return!0};var Mn=function(a){this.b=new Qm;a&&Ln(this,a)},Nn=function(a){var c=typeof a;return"object"==c&&a||"function"==c?"o"+(a[Za]||(a[Za]=++ab)):c.substr(0,1)+a};Mn.prototype.sa=function(){return this.b.sa()};Mn.prototype.add=function(a){this.b.set(Nn(a),a)};var Ln=function(a,c){c=Fn(c);for(var b=c.length,d=0;d<b;d++)a.add(c[d])};h=Mn.prototype;h.removeAll=function(a){a=Fn(a);for(var c=a.length,b=0;b<c;b++)this.remove(a[b])};h.remove=function(a){return this.b.remove(Nn(a))};h.clear=function(){this.b.clear()};
h.Vb=function(){return this.b.Vb()};h.contains=function(a){return Tm(this.b,Nn(a))};h.pa=function(){return this.b.pa()};h.clone=function(){return new Mn(this)};h.equals=function(a){return this.sa()==En(a)&&On(this,a)};var On=function(a,c){var b=En(c);if(a.sa()>b)return!1;!(c instanceof Mn)&&5<b&&(c=new Mn(c));return Kn(a,function(d){var e=c;return e.contains&&"function"==typeof e.contains?e.contains(d):e.Jf&&"function"==typeof e.Jf?e.Jf(d):Wa(e)||Ia(e)?Wb(e,d):Lc(e,d)})};Mn.prototype.Rb=function(){return this.b.Rb(!1)};var Qn=function(a,c){this.h=a;this.g=c;this.f=new Qm;this.b=new Mn;this.j=0;this.o=new Qm("serviceCheck",this.Sq.bind(this),"startDeviceMonitor",this.Tq.bind(this),"releaseDeviceMonitor",this.Rq.bind(this),"deviceJustSetUp",this.Oq.bind(this),"logRecord",this.Pq.bind(this));chrome.runtime.onMessage.addListener(this.l.bind(this));chrome.runtime.onMessageExternal.addListener(this.w.bind(this));Pn(this,"serviceReady")};Qn.prototype.m=hb("castApp.eventPage.Service");
var gn=function(a){if(Rn(a)){var c=new Mn;Mm(a.h.b.Rb(!1),function(d){var e=d.Yb();c.add(e);Tm(this.f,e)||this.g.sendRequest(new nn,d,Ul)}.bind(a));var b=!1;a.f.Lb().forEach(function(d){c.contains(d)||(this.f.remove(d),b=!0)}.bind(a));b&&Sn(a)}},Rn=function(a){if(0===a.b.sa())return!1;var c=v();3E4<c-a.j&&(a.j=c,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(b){0===b.length?(this.m.info("No tabs found. Clearing device monitor clients."),
this.b.clear()):this.m.info(function(){return"Tab check found active tabs: "+b.map(function(d){return d.id})})}.bind(a)));c=a.b.sa();a.m.info("Monitor client count: "+c);return 0<c};Qn.prototype.l=function(a,c,b){if("object"!==typeof a||"cast_app"!==a.type)return!1;var d=this.o.get(a.subtype);if(!d)return!1;if(!a.originId)return Ib("Missing origin ID in the incoming message."),!1;try{var e=d(a,c,b);e&&b(e)}catch(f){this.m.error("Error while handling request",f)}return!1};
var Pn=function(a,c,b){var d=new Pl(c,b);ob(a.m,function(){return"Sending message: "+JSON.stringify(d)});chrome.runtime.sendMessage(d)};h=Qn.prototype;h.Sq=function(){Pn(this,"serviceReady")};h.Tq=function(a){this.b.contains(a.originId)?this.m.info("Client: "+a.originId+"already registered, dispatching current device list."):(this.m.info("Registering monitor client: "+a.originId),this.b.add(a.originId));Sn(this);Tn(this)};h.Rq=function(a){this.m.info("Unregistering monitor client: "+a.originId);this.b.remove(a.originId)};
h.Oq=function(a){a=a.deviceJustSetUp.udn.replace(/-/g,"").toLowerCase();this.m.info("Device just set up: "+a.slice(-4))};h.Pq=function(a){a=a.logRecord;kb({level:rb(a.levelValue),R:a.loggerName,time:a.time,message:a.msg})};var Sn=function(a){var c=a.f.pa();Pn(a,"devices",c)},Tn=function(a){a.h.b.pa().forEach(function(c){this.g.sendRequest(new nn,c,Ul)}.bind(a))};
Qn.prototype.w=function(a,c,b){switch(a.type){case "handshake":b(new Rl("handshake"));break;case "launch":c=c.tab&&r(c.tab.id)?c.tab.id:null,null===c||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(c,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.VERSION=[1,2];w("chrome.cast.VERSION",chrome.cast.VERSION);chrome.cast.Mt=!0;w("chrome.cast.usingPresentationApi",chrome.cast.Mt);chrome.cast.Error=function(a,c,b){this.code=a;this.description=c||null;this.details=b||null};w("chrome.cast.Error",chrome.cast.Error);chrome.cast.rp=function(a){this.platform=a;this.packageId=this.url=null};w("chrome.cast.SenderApplication",chrome.cast.rp);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};w("chrome.cast.Image",chrome.cast.Image);
chrome.cast.Volume=function(a,c){this.level=Ha(a)?a:null;this.muted=Ha(c)?c:null};w("chrome.cast.Volume",chrome.cast.Volume);chrome.cast.nd={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};w("chrome.cast.AutoJoinPolicy",chrome.cast.nd);chrome.cast.qh={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};w("chrome.cast.DefaultActionPolicy",chrome.cast.qh);chrome.cast.Vd={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
w("chrome.cast.Capability",chrome.cast.Vd);chrome.cast.qd={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};w("chrome.cast.ErrorCode",chrome.cast.qd);chrome.cast.bp={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
w("chrome.cast.ReceiverAvailability",chrome.cast.bp);chrome.cast.sp={CHROME:"chrome",IOS:"ios",ANDROID:"android"};w("chrome.cast.SenderPlatform",chrome.cast.sp);chrome.cast.rh={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};w("chrome.cast.ReceiverType",chrome.cast.rh);chrome.cast.qo={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};w("chrome.cast.DialAppState",chrome.cast.qo);chrome.cast.rg={CAST:"cast",STOP:"stop"};w("chrome.cast.ReceiverAction",chrome.cast.rg);
chrome.cast.bl={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};w("chrome.cast.SessionStatus",chrome.cast.bl);chrome.cast.jl={ATTENUATION:"attenuation",FIXED:"fixed",MASTER:"master"};w("chrome.cast.VolumeControlType",chrome.cast.jl);chrome.cast.co=function(a,c,b,d,e){this.sessionRequest=a;this.sessionListener=c;this.receiverListener=b;this.autoJoinPolicy=d||chrome.cast.nd.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=e||chrome.cast.qh.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};w("chrome.cast.ApiConfig",chrome.cast.co);chrome.cast.so=function(a,c){this.appName=a;this.launchParameter=c||null};w("chrome.cast.DialRequest",chrome.cast.so);
chrome.cast.Ik=function(a,c,b){this.receiver=a;this.appState=c;this.extraData=b||null};w("chrome.cast.DialLaunchData",chrome.cast.Ik);chrome.cast.ro=function(a,c){this.doLaunch=a;this.launchParameter=c||null};w("chrome.cast.DialLaunchResponse",chrome.cast.ro);chrome.cast.al=function(a,c,b){this.appId=a;this.capabilities=Va(c)?c:[chrome.cast.Vd.VIDEO_OUT,chrome.cast.Vd.AUDIO_OUT];this.requestSessionTimeout=b||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
w("chrome.cast.SessionRequest",chrome.cast.al);
chrome.cast.li=function(a,c,b,d){this.label=a;a=c;xd.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(rd,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(sd,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(td,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(ud,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(vd,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(wd,"&#0;")));this.friendlyName=a;this.capabilities=b||[];this.volume=d||null;this.receiverType=chrome.cast.rh.CAST;this.displayStatus=this.isActiveInput=null};
w("chrome.cast.Receiver",chrome.cast.li);chrome.cast.cp=function(a,c){this.statusText=a;this.appImages=c;this.showStop=null};w("chrome.cast.ReceiverDisplayStatus",chrome.cast.cp);chrome.cast.fl=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};w("chrome.cast.Timeout",chrome.cast.fl);chrome.cast.timeout=new chrome.cast.fl;w("chrome.cast.timeout",chrome.cast.timeout);chrome.cast.Ck="auto-join";chrome.cast.Wk="cast-session_";chrome.cast.media.yo={SDR:"sdr",HDR:"hdr",DV:"dv"};w("chrome.cast.media.HdrType",chrome.cast.media.yo);chrome.cast.media.zo={AAC:"aac",AC3:"ac3",MP3:"mp3",TS:"ts",TS_AAC:"ts_aac",E_AC3:"e_ac3",FMP4:"fmp4"};w("chrome.cast.media.HlsSegmentFormat",chrome.cast.media.zo);chrome.cast.media.Ao={MPEG2_TS:"mpeg2_ts",FMP4:"fmp4"};w("chrome.cast.media.HlsVideoSegmentFormat",chrome.cast.media.Ao);chrome.cast.media.ye={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};
w("chrome.cast.media.MediaCommand",chrome.cast.media.ye);chrome.cast.media.Yo={ALBUM:"ALBUM",PLAYLIST:"PLAYLIST",AUDIOBOOK:"AUDIOBOOK",RADIO_STATION:"RADIO_STATION",PODCAST_SERIES:"PODCAST_SERIES",TV_SERIES:"TV_SERIES",VIDEO_PLAYLIST:"VIDEO_PLAYLIST",LIVE_TV:"LIVE_TV",MOVIE:"MOVIE"};w("chrome.cast.media.QueueType",chrome.cast.media.Yo);chrome.cast.media.gi={GENERIC_CONTAINER:0,AUDIOBOOK_CONTAINER:1};w("chrome.cast.media.ContainerType",chrome.cast.media.gi);
chrome.cast.media.ze={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4,AUDIOBOOK_CHAPTER:5};w("chrome.cast.media.MetadataType",chrome.cast.media.ze);chrome.cast.media.PlayerState={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};w("chrome.cast.media.PlayerState",chrome.cast.media.PlayerState);chrome.cast.media.mi={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};w("chrome.cast.media.RepeatMode",chrome.cast.media.mi);
chrome.cast.media.ep={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};w("chrome.cast.media.ResumeState",chrome.cast.media.ep);chrome.cast.media.dl={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};w("chrome.cast.media.StreamType",chrome.cast.media.dl);chrome.cast.media.Co={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};w("chrome.cast.media.IdleReason",chrome.cast.media.Co);chrome.cast.media.Bp={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};
w("chrome.cast.media.TrackType",chrome.cast.media.Bp);chrome.cast.media.yp={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};w("chrome.cast.media.TextTrackType",chrome.cast.media.yp);chrome.cast.media.up={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};w("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.up);chrome.cast.media.zp={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};
w("chrome.cast.media.TextTrackWindowType",chrome.cast.media.zp);chrome.cast.media.vp={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};w("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.vp);chrome.cast.media.wp={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};w("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.wp);
chrome.cast.media.Ep={LIKE:"LIKE",DISLIKE:"DISLIKE",FOLLOW:"FOLLOW",UNFOLLOW:"UNFOLLOW"};w("chrome.cast.media.UserAction",chrome.cast.media.Ep);chrome.cast.media.wo=function(){this.customData=null};w("chrome.cast.media.GetStatusRequest",chrome.cast.media.wo);chrome.cast.media.No=function(){this.customData=null};w("chrome.cast.media.PauseRequest",chrome.cast.media.No);chrome.cast.media.Oo=function(){this.customData=null};w("chrome.cast.media.PlayRequest",chrome.cast.media.Oo);chrome.cast.media.qp=function(){this.customData=this.resumeState=this.currentTime=null};w("chrome.cast.media.SeekRequest",chrome.cast.media.qp);
chrome.cast.media.tp=function(){this.customData=null};w("chrome.cast.media.StopRequest",chrome.cast.media.tp);chrome.cast.media.Ip=function(a){this.volume=a;this.customData=null};w("chrome.cast.media.VolumeRequest",chrome.cast.media.Ip);chrome.cast.media.Eo=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};w("chrome.cast.media.LoadRequest",chrome.cast.media.Eo);
chrome.cast.media.Ry=function(a){this.type="PRECACHE";this.requestId=0;this.precacheData=a};chrome.cast.media.vo=function(a,c){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=c||null};w("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.vo);chrome.cast.media.fi=function(a){this.containerType=a=void 0===a?chrome.cast.media.gi.GENERIC_CONTAINER:a;this.containerDuration=this.containerImages=this.sections=this.title=void 0};w("chrome.cast.media.ContainerMetadata",chrome.cast.media.fi);
chrome.cast.media.sc=function(a){this.metadataType=this.type=a;this.queueItemId=this.sectionStartTimeInContainer=this.sectionStartAbsoluteTime=this.sectionStartTimeInMedia=this.sectionDuration=void 0};w("chrome.cast.media.MediaMetadata",chrome.cast.media.sc);chrome.cast.media.Ok=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ze.GENERIC);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=void 0};q(chrome.cast.media.Ok,chrome.cast.media.sc);
w("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.Ok);chrome.cast.media.Qk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ze.MOVIE);this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=void 0};q(chrome.cast.media.Qk,chrome.cast.media.sc);w("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.Qk);
chrome.cast.media.il=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ze.TV_SHOW);this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=void 0};q(chrome.cast.media.il,chrome.cast.media.sc);w("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.il);
chrome.cast.media.Rk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ze.MUSIC_TRACK);this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=void 0};q(chrome.cast.media.Rk,chrome.cast.media.sc);w("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.Rk);
chrome.cast.media.Xk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ze.PHOTO);this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=void 0};q(chrome.cast.media.Xk,chrome.cast.media.sc);w("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.Xk);chrome.cast.media.Ek=function(){chrome.cast.media.fi.call(this,chrome.cast.media.gi.AUDIOBOOK_CONTAINER);this.releaseDate=this.publisher=this.narrators=this.authors=void 0};
q(chrome.cast.media.Ek,chrome.cast.media.fi);w("chrome.cast.media.AudiobookContainerMetadata",chrome.cast.media.Ek);chrome.cast.media.Dk=function(){chrome.cast.media.sc.call(this,chrome.cast.media.ze.AUDIOBOOK_CHAPTER);this.images=this.subtitle=this.bookTitle=this.chapterNumber=this.title=this.chapterTitle=void 0};q(chrome.cast.media.Dk,chrome.cast.media.sc);w("chrome.cast.media.AudiobookChapterMediaMetadata",chrome.cast.media.Dk);
chrome.cast.media.Go=function(a,c){this.contentId=a;this.contentUrl=void 0;this.streamType=chrome.cast.media.dl.BUFFERED;this.contentType=c;this.metadata=null;this.entity=void 0;this.duration=null;this.startAbsoluteTime=void 0;this.customData=this.textTrackStyle=this.tracks=null;this.userActionStates=this.hlsVideoSegmentFormat=this.hlsSegmentFormat=this.vmapAdsRequest=this.breakClips=this.breaks=void 0};w("chrome.cast.media.MediaInfo",chrome.cast.media.Go);
chrome.cast.media.So=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};w("chrome.cast.media.QueueItem",chrome.cast.media.So);chrome.cast.media.oo="CC1AD845";w("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.oo);chrome.cast.media.timeout={};chrome.cast.media.timeout.load=0;w("chrome.cast.media.timeout.load",chrome.cast.media.timeout.load);
chrome.cast.media.timeout.Ya=0;w("chrome.cast.media.timeout.getStatus",chrome.cast.media.timeout.Ya);chrome.cast.media.timeout.play=0;w("chrome.cast.media.timeout.play",chrome.cast.media.timeout.play);chrome.cast.media.timeout.pause=0;w("chrome.cast.media.timeout.pause",chrome.cast.media.timeout.pause);chrome.cast.media.timeout.seek=0;w("chrome.cast.media.timeout.seek",chrome.cast.media.timeout.seek);chrome.cast.media.timeout.stop=0;w("chrome.cast.media.timeout.stop",chrome.cast.media.timeout.stop);
chrome.cast.media.timeout.setVolume=0;w("chrome.cast.media.timeout.setVolume",chrome.cast.media.timeout.setVolume);chrome.cast.media.timeout.Ii=0;w("chrome.cast.media.timeout.editTracksInfo",chrome.cast.media.timeout.Ii);chrome.cast.media.timeout.Gs=0;w("chrome.cast.media.timeout.queue",chrome.cast.media.timeout.Gs);chrome.cast.media.Ap=function(a,c){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=c;this.customData=this.subtype=this.language=this.name=null};
w("chrome.cast.media.Track",chrome.cast.media.Ap);chrome.cast.media.xp=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};w("chrome.cast.media.TextTrackStyle",chrome.cast.media.xp);
chrome.cast.media.Uo=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.mi.OFF;this.customData=null};w("chrome.cast.media.QueueLoadRequest",chrome.cast.media.Uo);chrome.cast.media.Ro=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};w("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.Ro);
chrome.cast.media.Zo=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};w("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.Zo);chrome.cast.media.To=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};w("chrome.cast.media.QueueJumpRequest",chrome.cast.media.To);
chrome.cast.media.Xo=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};w("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.Xo);chrome.cast.media.Vo=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};w("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.Vo);
chrome.cast.media.Wo=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};w("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.Wo);chrome.cast.media.ho=function(a,c,b){this.id=a;this.breakClipIds=c;this.position=b;this.duration=void 0;this.isWatched=!1;this.isEmbedded=void 0};w("chrome.cast.media.Break",chrome.cast.media.ho);
chrome.cast.media.io=function(a){this.id=a;this.vastAdsRequest=this.customData=this.hlsSegmentFormat=this.clickThroughUrl=this.posterUrl=this.whenSkippable=this.duration=this.title=this.contentType=this.contentUrl=this.contentId=void 0};w("chrome.cast.media.BreakClip",chrome.cast.media.io);chrome.cast.media.Gp=function(){this.adsResponse=this.adTagUrl=void 0};w("chrome.cast.media.VastAdsRequest",chrome.cast.media.Gp);
chrome.cast.media.jo=function(){this.whenSkippable=this.breakClipId=this.breakId=this.currentBreakClipTime=this.currentBreakTime=void 0};w("chrome.cast.media.BreakStatus",chrome.cast.media.jo);chrome.cast.media.Do=function(a,c,b,d){this.start=a;this.end=c;this.isMovingWindow=b;this.isLiveDone=d};w("chrome.cast.media.LiveSeekableRange",chrome.cast.media.Do);
chrome.cast.media.Qo=function(a,c,b,d,e,f,g){this.id=a;this.queueType=this.entity=void 0;this.name=c;this.description=b;this.repeatMode=d;this.shuffle=!1;this.items=e;this.startIndex=f;this.startTime=g;this.containerMetadata=void 0};w("chrome.cast.media.QueueData",chrome.cast.media.Qo);chrome.cast.media.Fp=function(a){this.userAction=a;this.customData=void 0};w("chrome.cast.media.UserActionState",chrome.cast.media.Fp);chrome.cast.media.Hp=function(a,c,b){this.width=a;this.height=c;this.hdrType=b};
w("chrome.cast.media.VideoInformation",chrome.cast.media.Hp);chrome.cast.media.W=function(a,c){this.sessionId=a;this.mediaSessionId=c;this.media=null;this.videoInfo=this.queueData=void 0;this.playbackRate=1;this.playerState=chrome.cast.media.PlayerState.IDLE;this.currentTime=0;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.mi.OFF;this.liveSeekableRange=this.breakStatus=void 0};
w("chrome.cast.media.Media",chrome.cast.media.W);chrome.cast.media.W.prototype.Ya=function(){};chrome.cast.media.W.prototype.getStatus=chrome.cast.media.W.prototype.Ya;chrome.cast.media.W.prototype.play=function(){};chrome.cast.media.W.prototype.play=chrome.cast.media.W.prototype.play;chrome.cast.media.W.prototype.ys=function(){};chrome.cast.media.W.prototype.playWithContext=chrome.cast.media.W.prototype.ys;chrome.cast.media.W.prototype.pause=function(){};chrome.cast.media.W.prototype.pause=chrome.cast.media.W.prototype.pause;
chrome.cast.media.W.prototype.xs=function(){};chrome.cast.media.W.prototype.pauseWithContext=chrome.cast.media.W.prototype.xs;chrome.cast.media.W.prototype.seek=function(){};chrome.cast.media.W.prototype.seek=chrome.cast.media.W.prototype.seek;chrome.cast.media.W.prototype.stop=function(){};chrome.cast.media.W.prototype.stop=chrome.cast.media.W.prototype.stop;chrome.cast.media.W.prototype.setVolume=function(){};chrome.cast.media.W.prototype.setVolume=chrome.cast.media.W.prototype.setVolume;
chrome.cast.media.W.prototype.Ii=function(){};chrome.cast.media.W.prototype.editTracksInfo=chrome.cast.media.W.prototype.Ii;chrome.cast.media.W.prototype.Is=function(){};chrome.cast.media.W.prototype.queueInsertItems=chrome.cast.media.W.prototype.Is;chrome.cast.media.W.prototype.Hs=function(){};chrome.cast.media.W.prototype.queueAppendItem=chrome.cast.media.W.prototype.Hs;chrome.cast.media.W.prototype.Ss=function(){};chrome.cast.media.W.prototype.queueUpdateItems=chrome.cast.media.W.prototype.Ss;
chrome.cast.media.W.prototype.Ns=function(){};chrome.cast.media.W.prototype.queuePrev=chrome.cast.media.W.prototype.Ns;chrome.cast.media.W.prototype.Ms=function(){};chrome.cast.media.W.prototype.queueNext=chrome.cast.media.W.prototype.Ms;chrome.cast.media.W.prototype.Js=function(a){Un(this,a)};chrome.cast.media.W.prototype.queueJumpToItem=chrome.cast.media.W.prototype.Js;chrome.cast.media.W.prototype.Rs=function(){};chrome.cast.media.W.prototype.queueSetRepeatMode=chrome.cast.media.W.prototype.Rs;
chrome.cast.media.W.prototype.Ps=function(){};chrome.cast.media.W.prototype.queueRemoveItems=chrome.cast.media.W.prototype.Ps;chrome.cast.media.W.prototype.Os=function(a){Un(this,a)};chrome.cast.media.W.prototype.queueRemoveItem=chrome.cast.media.W.prototype.Os;chrome.cast.media.W.prototype.Qs=function(){};chrome.cast.media.W.prototype.queueReorderItems=chrome.cast.media.W.prototype.Qs;
chrome.cast.media.W.prototype.Ls=function(a,c,b,d){a=Un(this,a);0>a||(0>c?d&&d(new chrome.cast.Error(chrome.cast.qd.INVALID_PARAMETER)):a==c&&b&&b())};chrome.cast.media.W.prototype.queueMoveItemToNewIndex=chrome.cast.media.W.prototype.Ls;chrome.cast.media.W.prototype.It=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.W.prototype.supportsCommand=chrome.cast.media.W.prototype.It;chrome.cast.media.W.prototype.Iq=function(){return this.currentTime};
chrome.cast.media.W.prototype.getEstimatedTime=chrome.cast.media.W.prototype.Iq;chrome.cast.media.W.prototype.Gq=function(){if(this.breakStatus&&void 0!==this.breakStatus.currentBreakTime)return this.breakStatus.currentBreakTime};chrome.cast.media.W.prototype.getEstimatedBreakTime=chrome.cast.media.W.prototype.Gq;chrome.cast.media.W.prototype.Fq=function(){if(this.breakStatus&&void 0!==this.breakStatus.currentBreakClipTime)return this.breakStatus.currentBreakClipTime};
chrome.cast.media.W.prototype.getEstimatedBreakClipTime=chrome.cast.media.W.prototype.Fq;chrome.cast.media.W.prototype.Hq=function(){if(this.liveSeekableRange&&void 0!==this.liveSeekableRange.start&&void 0!==this.liveSeekableRange.end)return this.liveSeekableRange};chrome.cast.media.W.prototype.getEstimatedLiveSeekableRange=chrome.cast.media.W.prototype.Hq;chrome.cast.media.W.prototype.wi=function(){};chrome.cast.media.W.prototype.addUpdateListener=chrome.cast.media.W.prototype.wi;
chrome.cast.media.W.prototype.xi=function(){};chrome.cast.media.W.prototype.addUpdateListenerWithContext=chrome.cast.media.W.prototype.xi;chrome.cast.media.W.prototype.dk=function(){};chrome.cast.media.W.prototype.removeUpdateListener=chrome.cast.media.W.prototype.dk;chrome.cast.media.W.prototype.ek=function(){};chrome.cast.media.W.prototype.removeUpdateListenerWithContext=chrome.cast.media.W.prototype.ek;var Un=function(a,c){return Tb(a.items,function(b){return b.itemId==c})};var Vn=function(a,c,b){this.sessionId=a;this.namespaceName=c;this.message=b};var Wn=function(a,c){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=c||null};chrome.cast.ca=function(a,c,b,d,e){this.sessionId=a;this.appId=c;this.displayName=b;this.statusText=null;this.appImages=d;this.receiver=e;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.bl.CONNECTED;this.transportId=""};w("chrome.cast.Session",chrome.cast.ca);chrome.cast.ca.prototype.wt=function(a,c,b){this.In(null,a,c,b)};chrome.cast.ca.prototype.setReceiverVolumeLevel=chrome.cast.ca.prototype.wt;
chrome.cast.ca.prototype.In=function(a,c,b,d){c=new Wn(new chrome.cast.Volume(c,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,c,b,d)};chrome.cast.ca.prototype.setReceiverVolumeLevelWithContext=chrome.cast.ca.prototype.In;chrome.cast.ca.prototype.vt=function(a,c,b){this.Hn(null,a,c,b)};chrome.cast.ca.prototype.setReceiverMuted=chrome.cast.ca.prototype.vt;
chrome.cast.ca.prototype.Hn=function(a,c,b,d){a=new Wn(new chrome.cast.Volume(null,c),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,d)};chrome.cast.ca.prototype.setReceiverMutedWithContext=chrome.cast.ca.prototype.Hn;chrome.cast.ca.prototype.leave=function(a,c){null.leaveSession(this.sessionId,a,c)};chrome.cast.ca.prototype.leave=chrome.cast.ca.prototype.leave;chrome.cast.ca.prototype.stop=function(){};chrome.cast.ca.prototype.stop=chrome.cast.ca.prototype.stop;
chrome.cast.ca.prototype.Gt=function(){};chrome.cast.ca.prototype.stopWithContext=chrome.cast.ca.prototype.Gt;chrome.cast.ca.prototype.sendMessage=function(){};chrome.cast.ca.prototype.sendMessage=chrome.cast.ca.prototype.sendMessage;chrome.cast.ca.prototype.it=function(){};chrome.cast.ca.prototype.sendMessageWithContext=chrome.cast.ca.prototype.it;chrome.cast.ca.prototype.wi=function(){};chrome.cast.ca.prototype.addUpdateListener=chrome.cast.ca.prototype.wi;chrome.cast.ca.prototype.xi=function(){};
chrome.cast.ca.prototype.addUpdateListenerWithContext=chrome.cast.ca.prototype.xi;chrome.cast.ca.prototype.dk=function(){};chrome.cast.ca.prototype.removeUpdateListener=chrome.cast.ca.prototype.dk;chrome.cast.ca.prototype.ek=function(){};chrome.cast.ca.prototype.removeUpdateListenerWithContext=chrome.cast.ca.prototype.ek;chrome.cast.ca.prototype.Wp=function(){};chrome.cast.ca.prototype.addMessageListener=chrome.cast.ca.prototype.Wp;chrome.cast.ca.prototype.Xp=function(){};
chrome.cast.ca.prototype.addMessageListenerWithContext=chrome.cast.ca.prototype.Xp;chrome.cast.ca.prototype.Up=function(){};chrome.cast.ca.prototype.addMediaListener=chrome.cast.ca.prototype.Up;chrome.cast.ca.prototype.Vp=function(){};chrome.cast.ca.prototype.addMediaListenerWithContext=chrome.cast.ca.prototype.Vp;chrome.cast.ca.prototype.bt=function(){};chrome.cast.ca.prototype.removeMediaListener=chrome.cast.ca.prototype.bt;chrome.cast.ca.prototype.ct=function(){};
chrome.cast.ca.prototype.removeMediaListenerWithContext=chrome.cast.ca.prototype.ct;chrome.cast.ca.prototype.dt=function(){};chrome.cast.ca.prototype.removeMessageListener=chrome.cast.ca.prototype.dt;chrome.cast.ca.prototype.et=function(){};chrome.cast.ca.prototype.removeMessageListenerWithContext=chrome.cast.ca.prototype.et;chrome.cast.ca.prototype.nr=function(a){a.sessionId=this.sessionId};chrome.cast.ca.prototype.loadMedia=chrome.cast.ca.prototype.nr;
chrome.cast.ca.prototype.Ks=function(a){a.sessionId=this.sessionId};chrome.cast.ca.prototype.queueLoad=chrome.cast.ca.prototype.Ks;var Zn=function(a,c){if(!c.applications||1!=c.applications.length)return null;var b=c.applications[0];a=Xn(a);a=new chrome.cast.ca(b.sessionId,b.appId,b.displayName,b.appImages,a);a.senderApps=b.senderApps;a.namespaces=b.namespaces||[];a.transportId=b.transportId;a.statusText=b.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||Yn(a)))return null;a.receiver.volume=c.volume;Ja(c.isActiveInput)&&(a.receiver.isActiveInput=c.isActiveInput);return a},$n=function(a){var c=[];if(!a)return c;
a&1&&c.push(chrome.cast.Vd.VIDEO_OUT);a&2&&c.push(chrome.cast.Vd.VIDEO_IN);a&4&&c.push(chrome.cast.Vd.AUDIO_OUT);a&8&&c.push(chrome.cast.Vd.AUDIO_IN);a&32&&c.push(chrome.cast.Vd.MULTIZONE_GROUP);return c},Xn=function(a){var c=Cm(Bm(),a.getId());return new chrome.cast.li(c,a.f.friendlyName,$n(a.b))},ao=function(a,c){if(a.statusText!=c.statusText)return!0;var b=a.namespaces||[],d=c.namespaces||[];if(b.length!=d.length)return!0;for(var e={og:0};e.og<b.length;e={og:e.og},e.og++)if(!d.some(function(f){return function(g){return g.name==
b[f.og].name}}(e)))return!0;return a.receiver.volume.level!==c.receiver.volume.level||a.receiver.volume.muted!==c.receiver.volume.muted?!0:!1},bo=function(a){Va(a)?a.forEach(bo):Ya(a)&&Object.keys(a).forEach(function(c){null===a[c]?delete a[c]:(Ya(a[c])||Va(a[c]))&&bo(a[c])})},co=function(a){return a.namespaces.some(function(c){return c.name==Wl})},Yn=function(a){return null!==a&&"MultizoneLeader"==a.appId},eo=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==a};var fo=function(a,c,b){this.type=a;this.message=c;this.sequenceNumber=Ha(b)?b:-1;this.timeoutMillis=0;this.clientId=""};var go=function(a,c){this.h=a;this.b=c;this.g=[];this.f=new pn},io=function(a,c){return(a=ho(a.b,c))?a.routeId:null};go.prototype.listen=function(a,c){this.g[a]=c};var ko=function(a,c,b,d){ob(jo,"Sending to "+b);ob(jo,JSON.stringify(d));d.clientId=b;a.h.g.he(c,d)},lo=function(a,c,b){var d=ho(a.b,c);d&&d.b?ko(a,d.routeId,c,b):a.connect(c).then(function(e){e?(e=io(a,c))?ko(a,e,c,b):jo.H("No route for "+c):jo.H("No connected client "+c)},null)};
go.prototype.connect=function(a){var c=ho(this.b,a);if(null!=c&&c.b)return Promise.resolve(!0);c=io(this,a);if(!c)return jo.H("No route for client "+a),Promise.resolve(!1);if(a=this.f.b.get(c,null))return a.Cb.b;a=new Eb;qn(this.f,new mo(c,a));return a.b};var jo=hb("mr.cast.ApiMessenger"),mo=function(a,c){on.call(this,a,3E4);this.Cb=c};q(mo,on);mo.prototype.b=function(){this.Cb.resolve(!1)};var no=function(a,c,b){this.g=a;this.b=c;this.f=b},oo=function(a){var c="cast-dial:"+a.g,b=new URLSearchParams;a.b&&b.set("dialPostData",a.b);a.f&&b.set("clientId",a.f);(a=b.toString())&&(c+="?"+a);return c};var po=function(a,c,b,d,e,f,g,k,m,p){this.j=a;this.b=c||null;this.f=b||null;this.g=d||null;this.h=Ha(e)?e:null;this.u=f||null;this.D=g||null;this.o=k||!1;this.l=m||null;this.w=p||null},qo=function(a,c){return(a=a.match(c+"=([^/]*)"))?a[1]:null},so=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:Ob(Pb(a,function(c){c=qo(c,"__castAppId__");if(!c)return null;c=c.match(ro);if(!c||0==c.length)return null;var b=[];3==c.length&&c[2]&&(b=c[2].split(","));return{appId:c[1],capabilities:b}}),
function(c){return null!=c})},to=function(a){return Pb(a.j,function(c){return c.appId})},uo=function(a){return a.f?a.f:chrome.cast.nd.TAB_AND_ORIGIN_SCOPED},vo=function(a){var c=a.j.map(function(b){var d="cast:"+b.appId,e=new URLSearchParams;b.capabilities&&0<b.capabilities.length&&e.set("capabilities",b.capabilities.join(","));a.b&&e.set("clientId",a.b);a.f&&e.set("autoJoinPolicy",a.f);a.g&&e.set("defaultActionPolicy",a.g);null!=a.h&&e.set("launchTimeout",String(a.h));a.o&&e.set("invisibleSender",
"true");a.l&&(e.set("broadcastNamespace",a.l),e.set("broadcastId",String(Math.random())));a.w&&e.set("broadcastMessage",encodeURIComponent(JSON.stringify(a.w)));return d+"?"+e.toString()});a.u&&c.push(oo(new no(a.u,a.D,a.b)));return c},xo=function(a,c){a=to(a);var b=wo(c);return Rb(a,function(d){return Wb(b,d)})},yo=function(a){try{var c=new URL(a)}catch(u){return null}if("https:"==c.protocol)if("https:"!=c.protocol||"google.com"!=c.host||"/cast"!=c.pathname)a=null;else{var b=c.hash;if((a=so(b))&&
0!=a.length){c=qo(b,"__castClientId__");var d=qo(b,"__castAutoJoinPolicy__"),e=qo(b,"__castDefaultActionPolicy__");var f=qo(b,"__castLaunchTimeout__");null==f?f=null:(f=Number(f),f=!isNaN(f)&&0<f?f:null);var g=qo(b,"__dialAppName__"),k=qo(b,"__dialPostData__");var m=qo(b,"__castInvisibleSender__");m=null===m?null:"true"==m;var p=qo(b,"__castBroadcastNamespace__");b=(b=qo(b,"__castBroadcastMessage__"))?JSON.parse(decodeURIComponent(b)):null;a=new po(a,c,d,e,f,g,k,m,p,b)}else a=null}else if("cast:"==
c.protocol){a=c.pathname;d=c.searchParams.get("capabilities");a={appId:a,capabilities:d?d.split(","):[]};k=c.searchParams;c=k.get("clientId");d=k.get("autoJoinPolicy");e=k.get("defaultActionPolicy");b=Number(k.get("launchTimeout"));if(isNaN(b)||0>=b)b=null;f="true"==k.get("invisibleSender");g=k.get("broadcastNamespace");k=(k=k.get("broadcastMessage"))?JSON.parse(decodeURIComponent(k)):null;a=new po([a],c,d,e,b,void 0,void 0,f,g,k)}else a=null;return a},wo=function(a){return(a=yo(a))?to(a):null},zo=
function(a){return(a=yo(a))?a.b:null},ro=/(^\w+)(?:\(([\w, ]*)\))?$/;var Ao={Tw:0,Gw:1},Bo={MA:0,ap:1,Vy:2},Co={Yx:0,TIMEOUT:1,FAILED:2},Do={rw:0,Dy:1,SEEK:2,Bx:3,Qz:4,hu:5},Eo=function(a){Db("MediaRouter.Cast.Session.Ended",a,Bo)},Fo=function(a){Db("MediaRouter.Cast.Controller.ActionType",a,Do)},Go=function(a){Db("MediaRouter.Cast.Session.Fail",a,Co)};var Ho=function(a,c,b){this.R=hb("mr.MediaRouteController."+a);this.h=new mojo.Binding(mojo.MediaController,this,c);this.f=b;this.b=new mojo.MediaStatus({title:"",description:"",duration:new mojo.TimeDelta({microseconds:0}),current_time:new mojo.TimeDelta({microseconds:0})});this.o=!1;this.h.setConnectionErrorHandler(this.Xm.bind(this));this.f.ptr.setConnectionErrorHandler(this.Xm.bind(this))};h=Ho.prototype;h.Xm=function(){this.fb();this.Vm()};
h.fb=function(){this.o||(this.o=!0,this.h&&(this.h.close(),this.h=null),this.f&&(this.f.ptr.reset(),this.f=null))};h.Vm=function(){};h.play=function(){};h.pause=function(){};h.kk=function(){};h.setVolume=function(){};h.seek=function(){};h.oq=function(a){a.close();throw Error("Not implemented");};Ho.prototype.connectHangoutsMediaRouteController=Ho.prototype.oq;Ho.prototype.seek=Ho.prototype.seek;Ho.prototype.setVolume=Ho.prototype.setVolume;Ho.prototype.setMute=Ho.prototype.kk;Ho.prototype.pause=Ho.prototype.pause;
Ho.prototype.play=Ho.prototype.play;var Io=function(a){var c=new URL(a);a={};a.scheme=c.protocol.replace(":","");a.host=c.hostname;c=c.port?Number.parseInt(c.port,10):0;switch(a.scheme){case "http":a.port=c||80;break;case "https":a.port=c||443;break;default:throw Error("Scheme must be http or https");}a.suborigin="";return new mojo.Origin(a)},Jo=function(a){return new mojo.TimeDelta({microseconds:Math.floor(1E6*a)})};var Ko=function(a,c,b,d){this.type=a;this.mediaSessionId=c;this.requestId=0;this.sessionId=b;this.currentTime=d},Mo=function(a,c,b,d,e){Ho.call(this,"CastRouteController",a,c);this.session=b;this.g=d;this.j=e;this.l=new Date;this.w=new Set;Lo(this);Fo(0)};q(Mo,Ho);
var Lo=function(a){var c=No(a);c&&Oo(a,c);c&&a.j||!a.session.statusText||(a.b.title=a.session.statusText.substring(0,256));a.b.volume=null===a.session.receiver.volume.level?0:a.session.receiver.volume.level;a.b.is_muted=!!a.session.receiver.volume.muted;a.b.can_mute=a.session.receiver.volume.controlType!==chrome.cast.jl.FIXED;a.b.can_set_volume=a.b.can_mute;if(a.f)a.f.onMediaStatusUpdated(a.b)};h=Mo.prototype;h.Vm=function(){Po(this.g.b,this.session.sessionId)};
h.play=function(){var a=No(this);this.b.can_play_pause&&a&&this.b.play_state===mojo.MediaStatus.PlayState.PAUSED&&Qo(this.g,this.session,new Ko("PLAY",a.mediaSessionId,this.session.sessionId));Ro(this,1)};h.pause=function(){var a=No(this);this.b.can_play_pause&&a&&this.b.play_state!==mojo.MediaStatus.PlayState.PAUSED&&Qo(this.g,this.session,new Ko("PAUSE",a.mediaSessionId,this.session.sessionId));Ro(this,1)};
h.seek=function(a){var c=No(this);a=a?a.microseconds/1E6:0;var b;if(b=this.b.can_seek&&c&&0<=a)b=this.b.duration,b=a<=(b?b.microseconds/1E6:0);b&&Qo(this.g,this.session,new Ko("SEEK",c.mediaSessionId,this.session.sessionId,a));Ro(this,2)};h.kk=function(a){this.b.can_mute&&a!==this.b.is_muted&&So(this.g,this.session,new chrome.cast.Volume(null,a));Ro(this,3)};h.setVolume=function(a){this.b.can_set_volume&&0<=a&&1>=a&&So(this.g,this.session,new chrome.cast.Volume(a));Ro(this,4)};
var No=function(a){return a.session.media.find(function(c){return!c.idleReason})||null},Oo=function(a,c){a.j&&c.media&&c.media.metadata&&c.media.metadata.title&&(a.b.title=c.media.metadata.title.substring(0,256));a.b.can_play_pause=c.supportedMediaCommands.includes(chrome.cast.media.ye.PAUSE);a.b.can_seek=c.supportedMediaCommands.includes(chrome.cast.media.ye.SEEK);var b=c.playerState;a.b.play_state=b===chrome.cast.media.PlayerState.PLAYING?mojo.MediaStatus.PlayState.PLAYING:b===chrome.cast.media.PlayerState.PAUSED?
mojo.MediaStatus.PlayState.PAUSED:mojo.MediaStatus.PlayState.BUFFERING;a.b.current_time=c.currentTime?Jo(c.playerState===chrome.cast.media.PlayerState.PLAYING?c.currentTime+(new Date-a.l)/1E3:c.currentTime):Jo(0);a.b.duration=c.media&&c.media.duration?Jo(c.media.duration):Jo(0)},Ro=function(a,c){0==a.w.size&&Fo(5);a.w.has(c)||(Fo(c),a.w.add(c))};Mo.prototype.setVolume=Mo.prototype.setVolume;Mo.prototype.setMute=Mo.prototype.kk;Mo.prototype.seek=Mo.prototype.seek;Mo.prototype.pause=Mo.prototype.pause;
Mo.prototype.play=Mo.prototype.play;var To=function(a){this.f=a;this.m=hb("mr.cast.SessionLauncher")},Uo=function(a,c,b){Db("MediaRouter.Cast.Session.Type",0,Ao);return Cn(a.f,c,b).then(a.b.bind(a,b),function(d){d&&Dn==d?Go(1):Go(0);throw d;})};To.prototype.b=function(a,c){ob(this.m,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==c.type)throw Go(2),Error(c.reason);a=Zn(a,c.status);this.m.info("Launched session: "+a.sessionId);return a};var Vo=function(a){this.b=a;this.m=hb("mr.cast.ReceiverStatusQuerier")},Wo=function(a,c){return(new gf(t(a.f,a,c),3500,5)).start().then(null,function(b){a.m.info("Failed to get receiver status from "+c.getId());throw b;})};Vo.prototype.f=function(a){this.m.info("Query receiver status: "+a.getId());return this.b.sendRequest(new nn,a,Ul)};var Xo=function(a,c,b,d,e,f){this.g=a;this.w=c;this.j=b;this.b=d;this.l=e;this.h=f;this.f=new go(f,b);this.C=new Vo(this.g);this.F=new To(this.g)};Xo.prototype.init=function(){this.j.init();this.f.listen("v2_message",this.D.bind(this));this.f.listen("app_message",this.o.bind(this));this.f.listen("leave_session",this.u.bind(this))};
var $o=function(a,c,b,d){Yo(a.b,c).slice().forEach(function(e){e!=d&&Zo(a,e,b)})},Zo=function(a,c,b){b.clientId=c;lo(a.f,c,b)},ap=function(a,c,b,d){b={receiver:Xn(b),action:d};Zo(a,c,new fo("receiver_action",b))};
Xo.prototype.D=function(a){var c=a.message,b=c.sessionId;if(b){var d=bp(this.b,b);if(d)if(b=cp(this.b,b))if(b=this.w.qa(b))switch(c.type){case "STOP":dp(this,a,b);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":case "PRECACHE":ep(this,a,b,d);break;case "SET_VOLUME":fp(this,a,b);break;default:gp.H("Unknown request")}else hp(this,
a,chrome.cast.qd.INVALID_PARAMETER,"No receiver");else hp(this,a,chrome.cast.qd.INVALID_PARAMETER,"No sink ID");else hp(this,a,chrome.cast.qd.INVALID_PARAMETER,"Unknown session ID")}else hp(this,a,chrome.cast.qd.INVALID_PARAMETER,"No session ID")};
var hp=function(a,c,b,d){b=new chrome.cast.Error(b,d);ip(a,c,b)},ip=function(a,c,b){lo(a.f,c.clientId,new fo("error",b,c.sequenceNumber))},dp=function(a,c,b){var d=c.message;Cb("MediaRouter.Cast.Session.End");var e=d.sessionId,f=jp(a.b,e);f&&(f.j=!0);f=function(){fn(a,e,c)};a.g.sendRequest(d,b,Ul,c.timeoutMillis,c.clientId).then(f,f)},ep=function(a,c,b,d){var e=c.message,f=e.type;f in mn&&(e.type=mn[f]);a.g.sendRequest(e,b,Wl,c.timeoutMillis,c.clientId,d.transportId).then(function(g){kp(a,d,g);lo(a.f,
c.clientId,new fo("v2_message",g,c.sequenceNumber))},function(g){ip(a,c,g)})},fp=function(a,c,b){var d=c.message;delete d.sessionId;a.g.sendRequest(d,b,Ul,c.timeoutMillis,c.clientId).then(function(){lo(a.f,c.clientId,new fo("v2_message",null,c.sequenceNumber))},function(e){ip(a,c,e)})};
Xo.prototype.o=function(a){var c=this,b=a.message,d=b.sessionId;if(d){var e=cp(this.b,d);e?(e=this.w.qa(e))?(d=bp(this.b,d),Ub(d.namespaces,function(f){return f.name==b.namespaceName})?An(this.l,e,b.namespaceName,b.message,a.clientId,d.transportId).then(function(){lo(c.f,a.clientId,new fo("app_message",null,a.sequenceNumber))},function(){hp(c,a,chrome.cast.qd.CHANNEL_ERROR,"Channel to receiver not available")}):hp(this,a,chrome.cast.qd.INVALID_PARAMETER,"Invalid namespace")):gp.H("No receiver from sinkId"):
gp.H("No sinkId from sessionId")}else gp.H("No sessionId")};
Xo.prototype.u=function(a){var c=this;gp.info("Leave session");var b=jp(this.b,a.message);if(b){var d=a.clientId,e=ho(this.j,d);if(e){var f=[],g=[],k=e.tabId,m=e.origin,p=e.autoJoinPolicy;b.f.forEach(function(u){var A=ho(c.j,u);p==chrome.cast.nd.TAB_AND_ORIGIN_SCOPED&&k==A.tabId&&m==A.origin||p==chrome.cast.nd.ORIGIN_SCOPED&&m==A.origin?(A.f=!0,f.push(u)):g.push(u)});lo(this.f,d,new fo("leave_session",null,a.sequenceNumber));f.forEach(function(u){(u=ho(c.j,u))&&lp(c.h,u.routeId,!0,!0)});b.f=g}else gp.H("No client record")}else gp.H("No session")};
var mp=function(a,c,b){co(c)&&a.g.sendRequest(new nn,b,Wl,void 0,void 0,c.transportId).catch(Qa)},Zm=function(a,c,b){var d=c.getId();gp.info("Query status for "+d);Wo(a.C,c).then(function(e){np(a,d,e);b&&(e=op(a.b,d))&&mp(a,e,c)},Qa)},pp=function(a,c){if("*"==c.destinationId)return!0;c=c.destinationId;if(c==a.l.w||null!=ho(a.j,c))return!0;gp.info("Invalid destination "+c);return!1},tp=function(a,c,b){ob(gp,function(){return"Cast message: "+JSON.stringify(b)});if(pp(a,b))if(b.namespace_==Vl||b.namespace_==
Xl)(c=en(a.b,c))&&c.b.forEach(function(f){var g=a.h,k=g.f.get(f);k&&k.Kf&&g.g.Wh(f,b)});else{var d=JSON.parse(b.data),e=qp(a,d);e=e?e.sourceId:void 0;switch(d.type){case "RECEIVER_STATUS":np(a,c,d);break;case "MEDIA_STATUS":rp(a,c,b,e)}}else sp(a.l,c,b.destinationId,b.sourceId,!1)},qp=function(a,c){a=rn(a.g.b,c.requestId);if(!a)return null;var b=a.Cb;switch(c.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete c.requestId;b.reject(new chrome.cast.Error(chrome.cast.qd.SESSION_ERROR,
c.reason||c.type,c));break;default:b.resolve(c)}return a},up=function(a,c,b){ob(gp,function(){return"App message: "+JSON.stringify(b)});if(c=op(a.b,c)){var d;"*"==b.destinationId?d=Yo(a.b,c.sessionId):d=[b.destinationId];var e=new Vn(c.sessionId,b.namespace_,b.data);d.forEach(function(f){lo(a.f,f,new fo("app_message",e))})}else gp.H("No session for incoming app message")},vp=function(a,c){a.forEach(function(b){b.sessionId=c;var d=b.supportedMediaCommands,e=[];d&1&&e.push(chrome.cast.media.ye.PAUSE);
d&2&&e.push(chrome.cast.media.ye.SEEK);d&4&&e.push(chrome.cast.media.ye.STREAM_VOLUME);d&8&&e.push(chrome.cast.media.ye.STREAM_MUTE);b.supportedMediaCommands=e});return a},kp=function(a,c,b){c=c.sessionId;b.sessionId=c;b=vp(b.status,c);wp(a.b,c,b);if((a=jp(a.b,c))&&a.controller&&(a=a.controller,a.l=new Date,(b=No(a))?Oo(a,b):(a.j&&(a.b.title=""),a.b.can_play_pause=!1,a.b.can_seek=!1),a.f))a.f.onMediaStatusUpdated(a.b)},xp=function(a,c){if(c=op(a.b,c)){c=c.sessionId;var b=jp(a.b,c);b&&b.j||fn(a,c)}},
fn=function(a,c,b){b&&Zo(a,b.clientId,b);(b=jp(a.b,c))&&b.b.slice().forEach(function(d){lp(a.h,d,!0)});yp(a.b,c);zp(a.h)},np=function(a,c,b){ob(gp,"Receiver status for "+c);var d=b.status;if(d)if(b=a.w.qa(c)){d=Zn(b,d);var e=en(a.b,c);e?d?d.sessionId==e.session.sessionId?(c=e.session,ao(c,d)&&(ob(gp,"Updating session "+d.sessionId),e.g&&(c.statusText=d.statusText),c.namespaces=d.namespaces,c.receiver.volume=d.receiver.volume,Ap(a.h,e),$o(a,c.sessionId,new fo("update_session",c)),e.controller&&Lo(e.controller))):
(xp(a,c),Eo(1),Bp(a.h,null,b,null,d)):(xp(a,c),Eo(1)):d&&Bp(a.h,null,b,null,d)}else Cb("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),gp.H("Got message from receiver "+c+", but sink is no longer available.")},rp=function(a,c,b,d){if(c=op(a.b,c))if(b=JSON.parse(b.data))kp(a,c,b),$o(a,b.sessionId,new fo("v2_message",b),d)},Cp=function(a,c){var b=$n(c.b);return(c=Ub(a.j,function(d){return Sb(d.capabilities,function(e){return Wb(b,e)})}))?c.appId:to(a)[0]},Dp=function(a,c,b){var d=yo(c);
if(!d)return Promise.reject(Error("Invalid source "+c));var e=Cp(d,b),f=new sb("MediaRouter.Cast.Session.Launch");return Uo(a.F,new chrome.cast.al(e,void 0,null==d.h?chrome.cast.timeout.requestSession:d.h),b).then(function(g){gp.info("Launched session "+g.sessionId+" for appId "+e);f.end("Success");return g},function(g){gp.error("Failed to session for appId "+e);f.end("Failure");throw g;})};
Xo.prototype.createMediaRouteController=function(a,c,b){a=Ep(this.b,a);if(!a)return Error("Session not found for the route");var d=a.session;if(a.controller)return Error("Controller already exists for the route");var e=Fp(this,d.sessionId);if(!e)return Error("Sink not found for the route");a.controller=new Mo(c,b,d,this,a.g);mp(this,d,e);return null};
var Qo=function(a,c,b){var d=Fp(a,c.sessionId);d&&a.g.sendRequest(b,d,Wl,0,"",c.transportId).catch(function(e){gp.H("Failed to send a media control request: "+e)})},So=function(a,c,b){b=new Wn(b);(c=Fp(a,c.sessionId))&&a.g.sendRequest(b,c,Ul).catch(function(d){gp.H("Failed to send a volume control request: "+d)})},Fp=function(a,c){return(c=cp(a.b,c))?a.w.qa(c):null},gp=hb("mr.cast.ApiHandler");var Gp=function(a){return"0F5096E8"==a||"85CDB22F"==a};var Hp=function(a,c,b,d,e){for(var f=[],g=4;g<arguments.length;++g)f[g-4]=arguments[g];var k=this;this.j=a;this.w=c;this.Hj=b;this.f=d;this.h=f;this.b=!1;this.g=function(m){for(var p=[],u=0;u<arguments.length;++u)p[u-0]=arguments[u];return k.uq.apply(k,n(p))}};h=Hp.prototype;h.addListener=function(){this.b||(this.b=!0,this.f.addListener.apply(this.f,[this.g].concat(n(this.h))))};h.removeListener=function(){this.b&&(this.f.removeListener(this.g),this.b=!1)};
h.kh=function(a){for(var c=0;c<arguments.length;++c);return!0};h.uq=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];var d=this;fj(this.j);if(!this.kh.apply(this,n(c)))return!1;Xi(this.Hj).then(function(e){return e.handleEvent.apply(e,[d.f].concat(n(c)))});return this.Ei()};h.Fa=function(){return"mr.EventListener."+this.w};h.rb=function(){return[this.b]};h.pb=function(){em(this)&&this.addListener()};h.Ei=function(){};var Ip=null,Jp=null,Kp=function(){Ip||(Ip=new Hp(2,"CastChannelMessageListener","mr.cast.ChannelService",chrome.cast.channel.onMessage));Jp||(Jp=new Hp(1,"CastChannelErrorListener","mr.cast.ChannelService",chrome.cast.channel.onError));return[Ip,Jp]};var Lp=function(){},Mp=function(a){if(!a.startsWith("urn:x-org.chromium:media:route:"))return null;var c=a.substring(31);if(!c)return null;var b=c.match(/([^/]*)\/([^-/]*)-([^/]*)\/(.*)/);if(!b)return null;c=new Lp;c.f=a;a=l(b);a.next();c.b=a.next().value;c.h=a.next().value;c.j=a.next().value;c.g=a.next().value;return c};var Np=function(a,c,b,d,e,f){this.id=a;this.presentationId=c;this.sinkId=b;this.mediaSource=d;this.isLocal=e;this.description=f;this.iconUrl=null;this.allowStop=!0;this.customControllerPath=null;this.supportsMediaRouteController=!1;this.controllerType=mojo&&mojo.RouteControllerType&&mojo.RouteControllerType.kNone;this.forDisplay=!0;this.offTheRecord=!1;this.Kf=e;this.isOffscreenPresentation=!1},Op=function(a,c,b,d,e,f){c=d&&jj(d)?a:"urn:x-org.chromium:media:route:"+a+"/"+c+"-"+b+"/"+d;return new Np(c,
a,b,d,e,f)};var Pp=function(a,c,b,d){b=Op(b,"cast",c.getId(),a,d,"");b.supportsMediaRouteController=!0;mojo&&mojo.RouteControllerType&&(b.controllerType=d&&gj(a)&&c.b&1&&mojo.RouteControllerType.kMirroring?mojo.RouteControllerType.kMirroring:mojo.RouteControllerType.kGeneric);return b},Qp=function(a,c){var b=c.wb.vc;b&&(c.description=uj(b),a.displayName="",a.statusText="mirror_desktop"==b.f?"":b.g||"")};var Rp=function(a,c,b,d){return{namespace_:a,data:Ia(c)?c:JSON.stringify(c),sourceId:b,destinationId:d}};var Sp=function(a){this.type="CLOSE";this.reasonCode=a};var Tp=function(a){return(a=a.exec($d))?a[1]:""},Up=function(){if($e)return Tp(/Firefox\/([0-9.]+)/);if(Ee||Fe||De)return Xe;if(df)return we()||ce("iPad")||ce("iPod")?Tp(/CriOS\/([0-9.]+)/):Tp(/Chrome\/([0-9.]+)/);if(ef&&!(we()||ce("iPad")||ce("iPod")))return Tp(/Version\/([0-9.]+)/);if(af||bf){var a=/Version\/(\S+).*Mobile\/(\S+)/.exec($d);if(a)return a[1]+"."+a[2]}else if(cf)return(a=Tp(/Android\s+([0-9.]+)/))?a:Tp(/Version\/([0-9.]+)/);return""}(),Vp=function(a){return 0<=zd(Up,a)};var Xp=function(a){this.type="CONNECT";this.origin={};this.userAgent=$d;var c=this.userAgent.indexOf("(")+1;c=this.userAgent.substr(c,this.userAgent.indexOf(")",c)-1-c+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:Up,platform:Wp(),systemVersion:c,connectionType:1};this.connType=a?0:2},Wp=function(){switch(Di()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var Yp=function(a){if(!chrome.runtime.lastError)return null;var c="chrome.cast.channel.send failed, chrome.runtime.lastError: "+(chrome.runtime.lastError.message||"Unknown error");a&&ob(a,c);return Error(c)};var Zp=function(){this.b=new Qm};Zp.prototype.init=function(){hm(this)};var $p=function(a,c,b,d,e){if(!Tm(a.b,[c.channelId,b,d].join("#"))){var f=Rp(Tl,new Xp(e),b,d);chrome.cast.channel.send(c,f,a.f.bind(a));a.b.set([c.channelId,b,d].join("#"),e)}};Zp.prototype.f=function(){Yp(aq)};
var bn=function(a,c){a.b.Lb().forEach(function(b){b.split("#")[0]==c.channelId.toString()&&a.b.remove(b)})},Ym=function(a,c,b){a.b.forEach(function(d,e){var f=e.split("#");f[0]==c.channelId.toString()&&($p(a,b,f[1],f[2],d),a.b.remove(e))})};Zp.prototype.Fa=function(){return"cast.VirtualConnectionManager"};Zp.prototype.rb=function(){var a=Vm(this.b);return[new bq(a)]};Zp.prototype.pb=function(){var a=em(this);if(a)for(var c in a.b)this.b.set(c,a.b[c])};Ra(Zp);
var aq=hb("mr.cast.VirtualConnectionManager"),bq=function(a){this.b=a};var cq=function(a,c){this.j=c;this.w=a;this.f=new Qm;this.b=new Qm;this.g=Zp.Ja();this.qa=null;this.h=new Qm};q(cq,Si);cq.prototype.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];a==chrome.cast.channel.onMessage?this.o.apply(this,n(b)):a==chrome.cast.channel.onError&&this.l.apply(this,n(b))};cq.prototype.init=function(){this.g.init();hm(this);cj("mr.cast.ChannelService",this);Kp().forEach(function(a){return a.addListener()})};
var An=function(a,c,b,d,e,f){e=e||a.w;f=f||"receiver-0";var g=hn(a,c);return g?dq(a,g,b,d,e,f):Promise.reject("Channel not found for "+c.getId())},sp=function(a,c,b,d,e){if(c=a.f.get(c))a=a.g,Tm(a.b,[c.channelId,b,d].join("#"))&&(a.b.remove([c.channelId,b,d].join("#")),b=Rp(Tl,new Sp(e?5:0),b,d),chrome.cast.channel.send(c,b,a.f.bind(a)))};
cq.prototype.o=function(a,c){var b=this.b.get(a.channelId);if(b){var d=this.qa(b);if(d){if(Zl.hasOwnProperty(c.namespace_)){var e=JSON.parse(c.data);switch(e.type){case "CLOSE":this.g.b.remove([a.channelId,c.destinationId,c.sourceId].join("#"));return;case "RPC":break;default:ob(Xm,function(){return"Got message "+(e.type||e.responseType)+" from "+d.getId()})}}else ob(Xm,"Got message in "+c.namespace_+" from "+d.getId());eq(this.j,d,c)}else Xm.H("Got message for unknown receiver (receiverId="+b+").")}else Xm.H("Got message for unknown channel (channelId="+
a.channelId+").")};var fq=function(a,c){var b=a.b.get(c.channelId);b&&(a.b.remove(c.channelId),a.f.remove(b))};cq.prototype.l=function(a,c){Xm.H(function(){return"Channel error: "+JSON.stringify(a)+(c?", "+JSON.stringify(c):"")});fq(this,a)};
var hn=function(a,c){c=c.getId();(a=a.f.get(c))||Xm.info("Channel not found for receiver: "+c);return a},dq=function(a,c,b,d,e,f){$p(a.g,c,e,f,0==f.indexOf("receiver-0"));bo(d);var g=Rp(b,d,e,f);"object"===typeof d&&"RPC"==d.type||ob(Xm,function(){return"Channel is sending message: "+JSON.stringify(g)});return new Promise(function(k,m){chrome.cast.channel.send(c,g,function(p){p?p.errorState?(m(Error("Failed to send message")),fq(a,p)):k(!0):(p=Yp(Xm||void 0),m(p))})})};cq.prototype.Fa=function(){return"cast.ChannelService"};
cq.prototype.rb=function(){return[new gq(Vm(this.f),Vm(this.b),Vm(this.h))]};cq.prototype.pb=function(){var a=em(this);a&&(Pm(this.f,a.f),Pm(this.b,a.b),Pm(this.h,a.g))};var Xm=hb("mr.cast.ChannelService"),gq=function(a,c,b){this.f=a;this.b=c;this.g=b};var hq=function(a,c,b,d,e,f){this.routeId=a;this.clientId=c;this.appIds=b;this.autoJoinPolicy=d;this.origin=e;this.tabId=f;this.f=this.b=!1},iq=function(){this.b=[]};iq.prototype.init=function(){hm(this)};iq.prototype.sa=function(){return this.b.length};var ho=function(a,c){return Ub(a.b,function(b){return b.clientId==c})},jq=function(a,c){return Ub(a.b,function(b){return b.routeId==c})},kq=function(a,c){a.b=Ob(a.b,function(b){return b.clientId!=c})};iq.prototype.Fa=function(){return"cast.ClientRecords"};
iq.prototype.rb=function(){return[new lq(this.b)]};iq.prototype.pb=function(){var a=em(this);a&&(this.b=a.b)};var lq=function(a){this.b=a};var mq=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var nq=function(a,c){this.h=a;this.f=c;this.g=new Mn;this.b=new Qm};nq.prototype.init=function(){hm(this)};var oq=function(a,c){var b=a.b.get(c);b&&(b.bk--,0<b.bk||(Mm(a.f.b.Rb(!1),function(d){switch(Im(d,c)){case "available":d.lc[c]="available_rescan";break;case "unavailable":d.lc[c]="unavailable_rescan"}}),a.b.remove(c)))};h=nq.prototype;
h.Om=function(a){var c=this;Mm(this.b.Rb(!0),function(b){a:{switch(Im(a,b)){case "unknown":case "available_rescan":case "unavailable_rescan":var d=!0;break a}d=!1}if(d){var e=a.getId()+":"+b;c.g.contains(e)||(c.g.add(e),d=function(){c.g.remove(e)},(new gf(c.jq.bind(c,a,b),5500,3)).start().then(c.Rn.bind(c,a,b),function(){c.m.error("Failed to get app availability response for "+a.getId()+", appId "+b+" after 3 attempts.");c.Rn(a,b,"unknown")}).then(d,d))}})};
h.Rn=function(a,c,b){b!=Im(a,c)&&(this.m.info(c+" on "+a.getId()+" is "+b),a.lc[c]=b,$m(this.f.h,a))};
h.jq=function(a,c){var b=this,d=new mq;d.appId=[c];var e=new sb("MediaRouter.Cast.App.Availability");return this.h.sendRequest(d,a,Ul,5E3).then(function(f){e.end("Success");ob(b.m,function(){return"App availability response "+JSON.stringify(f)});for(var g in f.availability){if("APP_AVAILABLE"==f.availability[g])return"available";if("APP_UNAVAILABLE"==f.availability[g])return"unavailable"}return"unknown"},function(f){e.end("Failure");b.m.error("checkAppAvailability_ failed for "+a.getId()+", appId "+
c);throw f;})};h.Fa=function(){return"cast.AppDiscoveryService"};h.rb=function(){return[new pq(Vm(this.b))]};h.pb=function(){var a=em(this);a&&Pm(this.b,a.b)};h.m=hb("mr.cast.AppDiscoveryService");var pq=function(a){this.b=a};var qq=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var rq=function(a,c){this.f=[];this.b=[];this.sinkId=a;this.session=c;this.w=this.h=null;this.offTheRecord=this.j=!1;this.controller=null;this.g=!0},sq=function(){this.m=hb("mr.cast.SessionRecords");this.b=[]};sq.prototype.init=function(){hm(this)};
var yp=function(a,c){a.m.info("Removing session "+c);Po(a,c);a.b=Ob(a.b,function(b){return b.session.sessionId!=c})},Yo=function(a,c){return(a=jp(a,c))?a.f:[]},op=function(a,c){return(a=en(a,c))?a.session:null},tq=function(a,c){return Ub(a.b,function(b){return Wb(b.f,c)})},Ep=function(a,c){return Ub(a.b,function(b){return Wb(b.b,c)})},uq=function(a,c){return Ub(a.b,function(b){return null!=Ub(b.b,function(d){return Mp(d).b==c})})},en=function(a,c){return Ub(a.b,function(b){return b.sinkId==c||b.h==
c})},jp=function(a,c){return Ub(a.b,function(b){return b.session.sessionId==c})},cp=function(a,c){return(a=jp(a,c))?a.sinkId:null},bp=function(a,c){return(a=jp(a,c))?a.session:null},wp=function(a,c,b){var d=bp(a,c);d&&(a=Ob(b,function(e){return e.playerState!=chrome.cast.media.PlayerState.IDLE}),a.forEach(function(e){if(!e.media){var f=Ub(d.media,function(g){return g.mediaSessionId==e.mediaSessionId});f&&(e.media=f.media)}}),d.media=a)};sq.prototype.Fa=function(){return"cast.SessionRecords"};
sq.prototype.rb=function(){return[new vq(this.b)]};sq.prototype.pb=function(){var a=em(this);if(a)for(var c=0;c<a.b.length;c++){var b=a.b[c],d=new rq(b.sinkId,b.session);d.f=b.f;d.b=b.b;d.j=b.j;d.w=b.w;d.h=b.h;d.g=b.g;this.b.push(d)}};
var Po=function(a,c){(a=jp(a,c))&&a.controller&&(a.controller.fb(),a.controller=null)},vq=function(a){var c=[];a=l(a);for(var b=a.next();!b.done;b=a.next()){b=b.value;var d=new rq(b.sinkId,b.session);d.f=b.f;d.b=b.b;d.j=b.j;d.w=b.w;d.h=b.h;d.offTheRecord=b.offTheRecord;d.g=b.g;c.push(d)}this.b=c};var wq=function(a,c,b){var d=Error.call(this);this.message=d.message;"stack"in d&&(this.stack=d.stack);this.name="RouteRequestError";this.message=c||"";if(b)this.stack=b;else if(Error.captureStackTrace)Error.captureStackTrace(this,wq);else if(c=Error().stack)this.stack=c;this.errorCode=a};q(wq,Error);var xq=function(a,c){this.sinks=a;this.origins=c||null},yq=new xq([]);var zq=function(a){this.D="sender-"+ue();this.f=new Qm;this.o=null;hm(this);this.g=a;this.l=new iq;this.h=new sq;this.u=new cq(this.D,this);this.b=new Wm(this.u,this);this.C=new xn(this.u,this.D);this.w=null;this.j=new Xo(this.C,this.b,this.l,this.h,this.u,this);this.F=new Qn(this.b,this.C)};h=zq.prototype;h.getName=function(){return"cast"};
h.initialize=function(a){a=a&&"boolean"===typeof a.enable_cast_sink_query?a.enable_cast_sink_query:!0;this.m.info("Query enabled: "+a);this.C.init();this.h.init();this.j.init();this.u.init();this.b.init();a&&(this.w=new nq(this.C,this.b),this.w.init())};h.Ed=function(){return this.f.pa()};
h.Fg=function(a){var c=this;if(null!=Aq(a))return new xq([]);var b=new Mn;Bq(a).forEach(function(d){kn(c.b,d).map(function(e){return e.f}).forEach(function(e){b.add(e)})});return new xq(b.pa(),-1!=a.indexOf("0F5096E8")?kj:null)};
h.startObservingMediaSinks=function(a){var c=this,b=Aq(a);b?(this.m.info("Received broadcast request "+a),Mm(this.b.b.Rb(!1),function(d){c.C.sendMessage(b,d,Yl).catch(function(e){c.m.error("Broadcast failed "+e.message)})})):this.w&&Bq(a).forEach(function(d){var e=c.w,f=e.b.get(d);f?f.bk++:e.b.set(d,{bk:1});e.m.info("Scanning sinks for app availability");Mm(e.f.b.Rb(!1),e.Om,e)})};h.stopObservingMediaSinks=function(a){var c=this;null!=Aq(a)||this.w&&Bq(a).forEach(function(b){oq(c.w,b)})};
h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.qa=function(a){return(a=this.b.qa(a))?a.f:null};
var Cq=function(a,c,b){a.m.error("Error launching.",b);lp(a,c.id,!1,!0,"error");b=new oi(qq,"warning");si(b,c.id);ti(b,c.sinkId);a.g.cf(b)},Fq=function(a,c,b,d,e,f,g,k){Bm().f=new ym(b.Dc,b.Yb());var m=Pp(c,b,d,!0);m.forDisplay=!1;m.offTheRecord=e;a.f.set(m.id,m);a.g.dg(a,m);zp(a);(e=yo(c))&&e.b&&Dq(a,e,m.id,g,k);return new Promise(function(p,u){ij(c)||jj(c)?(m.wb={tabId:k,sessionId:"",jg:b.Yb()||"",ne:b.Dc||"",Bt:b.f.friendlyName||""},jj(c)&&(m.isOffscreenPresentation=!0),a.g.vj(a,m,d,function(A){return yi(Eq(a,
c,b,d,f,g,k,A))}).b.then(function(){var A=Ep(a.h,m.id);A.g=!1;Qp(A.session,m);A.controller&&(A.controller.j=!1,Lo(A.controller));p(m)},function(A){Cq(a,m,A);u(A)})):Eq(a,c,b,d,f,g,k,m).then(function(){p(m)},function(A){Cq(a,m,A);u(A)})})},Eq=function(a,c,b,d,e,f,g,k){return Dp(a.j,Gq(c,b,e),b).then(function(m){Bp(a,c,b,d,m,f,g,k);return k})};
zq.prototype.createRoute=function(a,c,b,d,e,f,g){var k=this,m=this.b.qa(c);if(!m)return xi(Error("No sink with ID "+c));var p=zo(a);if(p){setTimeout(function(){ap(k.j,p,m,chrome.cast.rg.CAST)},0);var u=function(){return Fq(k,a,m,b,d,e,f,g)},A=ho(this.l,p);if(A)return yi(this.terminateRoute(A.routeId).then(u,u));if(f&&g&&(c=Hq(this,a,f,g,d,e,c)))return c}return yi(Fq(this,a,m,b,d,e,f,g))};
var lp=function(a,c,b,d,e){d=void 0===d?!1:d;e=void 0===e?"closed":e;a.m.info("Remove route "+c);var f=jq(a.l,c);if(f){b=b||f.f;var g=f.clientId;a.m.info("Remove client "+g);for(var k=a.h,m=0;m<k.b.length;m++)cc(k.b[m].f,g);kq(a.l,g)}if(g=Ep(a.h,c))cc(g.b,c),Iq(a,g.b);if(k=a.f.get(c))if(k.Kf&&g&&(sp(a.u,k.sinkId,f?f.clientId:a.D,g.session.transportId,b),k.forDisplay&&f&&(a.o={If:f,Cn:g})),a.f.remove(c),a.g.Ng(k),zp(a),d)a.g.onPresentationConnectionClosed(c,e,"Remove route");else a.g.onPresentationConnectionStateChanged(c,
"terminated")},Ap=function(a,c){c.b.forEach(function(b){if(b=a.f.get(b)){var d=c.session;if(b.forDisplay){var e=Gp(d.appId);e&&!b.isLocal?(b.description=d.statusText||"",d.displayName="",d.statusText=""):e||(b.description=d.statusText||d.displayName);c.controller&&Lo(c.controller)}a.g.hf(b)}})},Jq=function(a,c){Rb(c,function(b){b=a.f.get(b,null);if(!b||!b.mediaSource)return!1;var d=yo(b.mediaSource);d=d?d.o:!1;return b.isLocal&&!d})&&Mb(c,function(b){if(b=a.f.get(b,null))b.isLocal=!0})},Iq=function(a,
c){var b=[],d=[],e=null;c.forEach(function(f){if(f=a.f.get(f)){f.forDisplay=!1;var g=yo(f.mediaSource);g&&Ub(to(g),eo)||(f.Kf?(g=g?uo(g):null,e||g==chrome.cast.nd.CUSTOM_CONTROLLER_SCOPED||(b.push(f),e=f.sinkId)):e&&e!=f.sinkId?b.push(f):d.push(f))}});Mb(0<b.length?b:d,function(f){f.forDisplay=!0})},Dq=function(a,c,b,d,e){var f=c.b;if(f&&!ho(a.l,f)){a.m.info("Add client "+f);var g=to(c);a.l.b.push(new hq(b,f,g,uo(c),d||null,Ha(e)?e:null))}},Bp=function(a,c,b,d,e,f,g,k){var m=en(a.h,b.getId());if(!m){var p=
a.h;m=b.getId();p.m.info("Adding new session: "+m+", "+e.sessionId);var u=jp(p,e.sessionId);u?(Yn(e)?(u.w=e,u.h=m):Yn(u.session)&&(u.w=u.session,u.h=u.sinkId,u.session=e,u.sinkId=m),m=u):(m=new rq(m,e),p.b.push(m))}k&&k.isLocal&&k.wb&&(m.g=!1);var A=null!=c;if(!A&&eo(e.appId))return null;null==c?(u=new po([{appId:e.appId,capabilities:e.capabilities}]),c=vo(u)[0]):u=yo(c);if(p=k){if(!a.f.get(p.id))return a.m.H("Route "+p.id+" not added"),p}else p=Pp(c,b,d||e.sessionId,A),a.f.set(p.id,p);d=p.id;a.m.info("Add route "+
d);c=null;u&&(c=u.b,Dq(a,u,d,f,g));Wb(m.b,d)||m.b.push(d);p.Kf&&(f=a.u,g=c||a.D,d=e.transportId,u=!(u&&u.o),(A=hn(f,b))&&$p(f.g,A,g,d,u));m.offTheRecord=p.offTheRecord;f=m.b;Jq(a,f);Iq(a,f);f=p;g=e.sessionId;Gp(e.appId)?f.isLocal&&g&&f.wb?f.wb.sessionId=g:(f.description=e.statusText||"",e.displayName="",e.statusText=""):f.description=e.statusText||e.displayName;k?a.g.hf(p):a.g.dg(a,p);zp(a);if(k=c)Wb(m.f,c)?k=!1:(m.f.push(c),k=!0);k&&(a=a.j,lo(a.f,c,new fo("new_session",e)),mp(a,e,b));return p};
zq.prototype.terminateRoute=function(a){var c=this,b=this.f.get(a);if(!b)return Promise.reject(new wq(3,"Route in Cast provider not found for routeId  "+a));var d=Ep(this.h,a);if(!d)return lp(this,a,!0),Promise.resolve();var e=d.session.sessionId,f=this.b.qa(b.sinkId);if(!f)return fn(this.j,e),Promise.resolve();(a=jq(this.l,a))&&ap(this.j,a.clientId,f,chrome.cast.rg.STOP);Eo(0);return new Promise(function(g){var k=function(){xp(c.j,f.getId());g()};c.C.sendRequest(new un(e),f,Ul).then(k,k)})};
var Kq=function(a,c){var b=null;Nm(a.f.Rb(!1),function(f){if(!f.Kf)return!1;var g=a.b.qa(f.sinkId);if(!g||!xo(c,Gq(f.mediaSource,g)))return!1;b=f;return!0});if(!b||!b.mediaSource)return null;var d=zo(b.mediaSource);if(!d)return null;var e=ho(a.l,d);return e?(d=tq(a.h,d))?{If:e,Cn:d}:null:null},Hq=function(a,c,b,d,e,f,g){var k=null;Nm(a.f.Rb(!1),function(p){var u=p.wb;return u&&null!=u.tabId&&u.tabId==d&&gj(p.mediaSource)?(k=p,!0):!1});if(!k)return null;var m=function(){return a.createRoute(c,g||k.sinkId,
"",e,f,b,null==d?void 0:d)};return yi(a.terminateRoute(k.id).then(m,m))};h=zq.prototype;h.connectRouteByRouteId=function(a,c,b,d,e){if(!yo(a))return xi(Error("Unsupported presentation URL"));if(!c)return xi(Error("No routeId"));c=Mp(c);c=jp(this.h,c.b);if(!c)return xi(Error("No matching route"));var f=this.b.qa(c.sinkId);return f?(a=Bp(this,a,f,b,c.session,d,e))?wi(a):xi(Error("Failed to create route")):xi(Error("No sink"))};
h.joinRoute=function(a,c,b,d,e,f){var g=yo(a);if(!g)return xi(Error("Unsupported presentation URL"));if(c==chrome.cast.Ck){a:{var k=Kq(this,g);if(!k){if(!this.o||this.o.If.origin!=e||this.o.If.tabId!=f){k=null;break a}k=this.o}switch(uo(g)){case chrome.cast.nd.PAGE_SCOPED:k=null;break a;case chrome.cast.nd.ORIGIN_SCOPED:if(e!=k.If.origin){k=null;break a}break;case chrome.cast.nd.TAB_AND_ORIGIN_SCOPED:if(e!=k.If.origin||f!=k.If.tabId){k=null;break a}}k=jp(this.h,k.Cn.session.sessionId)}if(!k&&(g.g?
g.g:chrome.cast.qh.CREATE_SESSION)!=chrome.cast.qh.CAST_THIS_TAB&&(d=Hq(this,a,e,f,b,d)))return d}else k=Lq(this,c);if(!k)return xi(Error("No matching route"));if(k.offTheRecord!=b)return xi(Error("Off the record mismatch"));d=this.b.qa(k.sinkId);if(!d)return xi(Error("No sink"));a=Bp(this,a,d,c,k.session,e,f);a.offTheRecord=b;return wi(a)};h.detachRoute=function(a){lp(this,a,!1,!0)};
h.Pf=function(a){var c=this.b.qa(a);if(!c)throw Error("Cannot mirror with no sink.");var b=new Bj;c=c.b;c&1||(b.shouldCaptureVideo=!1);c&4||(b.shouldCaptureAudio=!1);b.shouldCaptureAudio&&!b.shouldCaptureVideo&&(b.minLatencyMillis=b.maxLatencyMillis,b.animatedLatencyMillis=b.maxLatencyMillis);b.senderSideLetterboxing=!0;Cj(b);Object.freeze(b);this.m.info(function(){return"Settings for "+a+": "+Aj(b)});if(!b.shouldCaptureAudio&&!b.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture");
return b};h.Of=function(){return"cast_streaming"};h.Xh=function(a){var c=this.f.get(a);c&&c.wb&&c.wb.vc&&(a=Ep(this.h,a))&&(Qp(a.session,c),a.controller&&Lo(a.controller))};
h.sendRouteMessage=function(a,c,b){var d=this;if(!b)return new Promise(function(k,m){"string"!==typeof c&&m(Error("Cannot send non-string messages via ApiHandler."));m=d.j.f;ob(jo,"Received: "+c);var p=JSON.parse(c),u=p.clientId;"client_connect"==p.type?(ob(jo,"App "+u),(p=ho(m.b,u))?(p.b=!0,(m=rn(m.f,p.routeId))&&m.Cb.resolve(!0)):jo.H("Client not found "+u)):io(m,u)?(m=m.g[p.type])&&m(p):jo.H("No route for "+u);k()});var e=Ep(this.h,a);if(!e)return Promise.reject(Error("Not managing the route "+
a));var f=this.b.qa(e.sinkId);if(!f)return Promise.reject(Error("Sink no longer accessible"));var g=(a=jq(this.l,a))?a.clientId:this.D;return new Promise(function(k){An(d.u,f,b.namespace,c,g,e.session.transportId).then(k,k)})};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};h.xg=function(a,c){var b=this.b.qa(c);if(!b)return!1;if(!this.w)return!0;a=Gq(a,b);return(a=wo(a))&&0!=a.length?Rb(a,function(d){return $l(Im(b,d))}):!1};
h.Hf=function(a,c,b){var d=Bq(a);return d&&0!=d.length?c==chrome.cast.Ck?!0:b&&b.mediaSource?(a=wo(b.mediaSource),Rb(a,function(e){return Wb(d,e)})):void 0==c||Lq(this,c)?!0:!1:!1};
var Gq=function(a,c,b){return yo(a)?a:ij(a)||jj(a)?(a={appId:0==(c.b&1)?"85CDB22F":"0F5096E8",capabilities:$n(c.b)},vo(new po([a],void 0,void 0,void 0,b))[0]):a},Bq=function(a){var c=[],b=yo(a);if(b)c=to(b);else if(ij(a)||jj(a))hj(a)||c.push("85CDB22F"),c.push("0F5096E8");return c},Aq=function(a){var c=yo(a);if(!c)return null;a=Bq(a);var b=c.l||"";c=c.w;return b&&c?new sn(a,b,JSON.stringify(c)):null},Lq=function(a,c){return 0==c.indexOf(chrome.cast.Wk)?jp(a.h,c.substr(chrome.cast.Wk.length)):uq(a.h,
c)},eq=function(a,c,b){var d=a.F;if(Rn(d)&&Zl.hasOwnProperty(b.namespace_)){var e=c.Yb();if(e){var f=JSON.parse(b.data);if("RECEIVER_STATUS"===f.type){var g=f.status&&f.status.applications&&f.status.applications[0],k=f=null;g&&(g.appId&&(f=g.appId),g.sessionId&&(k=g.sessionId));g=d.f.get(e);d.f.set(e,new Ql(e,f,k));g&&g.appId===f||Sn(d)}}}a=a.j;c=c.getId();Zl.hasOwnProperty(b.namespace_)?tp(a,c,b):up(a,c,b)},$m=function(a,c){a.w&&a.w.Om(c);gn(a.F);a.g.gd()};h=zq.prototype;h.Fa=function(){return"cast.Provider"};
h.rb=function(){return[new Mq(this.D,Vm(this.f),this.o)]};h.pb=function(){var a=em(this);a&&(this.D=a.g,Pm(this.f,a.f),this.o=a.b)};h.searchSinks=function(){return eb()};h.createMediaRouteController=function(a,c,b){return(a=this.j.createMediaRouteController(a,c,b))?Promise.reject(a):Promise.resolve()};h.provideSinks=function(a){dn(this.b,a)};var zp=function(a){var c=a.Ed().some(function(b){return b.isLocal});a.g.gg(a.Fa(),c)};zq.prototype.m=hb("mr.CastProvider");
var Mq=function(a,c,b){this.g=a;this.f=c;this.b=b};var Nq=function(){this.b=[]};Nq.prototype.listen=function(a,c,b){this.b.push({type:a,Vc:c,target:b})};var Oq=function(a,c,b){var d=a.b.findIndex(function(e){return"internal_message"==e.type&&e.Vc==c&&e.target==b});-1!=d&&a.b.splice(d,1)},Pq=function(a,c){a.b.forEach(function(b){b.type==c.type&&Promise.resolve().then(function(){return b.Vc.call(b.target,c)})})};var aaa={SUCCESS:0,jp:1,iu:2,ju:3,IA:4,vz:5},baa={SUCCESS:0,wz:1,jp:2,Yz:3},caa={SUCCESS:0,sy:1,Cw:2},Qq=function(a){Db("MediaRouter.Dial.CreateRoute",a,aaa)},Rq=function(a){Db("MediaRouter.Dial.TerminateRoute",a,baa)},Sq=function(a){Db("MediaRouter.Dial.ParseMessage",a,caa)};var Tq=function(a,c,b,d){c="["+c+"]: "+b+" "+d.responseURL+" => "+d.status+" ("+d.statusText+")";200<=d.status&&299>=d.status?a.info(c):ob(a,c)};var daa=function(){this.name="unknown";this.state="error";this.b=null;this.allowStop=!0;this.resource=null;this.extraData={}},Uq=function(){var a=Error.call(this);this.message=a.message;"stack"in a&&(this.stack=a.stack)};q(Uq,Error);var Wq=function(a){if(void 0===c){Vq||(Vq=new jf(10,2E3));var c=Vq}this.f=a;this.b=c;this.m=hb("mr.dial.Client")};
Wq.prototype.launchApp=function(a,c){var b=this;return this.b.send(Xq(this,a),"POST",c,{timeoutMillis:15E3}).then(function(d){return Yq(b,"launchApp","POST",d)})};
var $q=function(a,c){return Zq(a,c).then(function(b){return b.resource?b.resource:(a.m.H("stopApp: Resource path for not available for app "+c+": using fallback path."),"run")},function(){a.m.H("stopApp: getAppInfo failed: using fallback path.");return"run"}).then(function(b){return a.b.send(Xq(a,c)+"/"+b,"DELETE")}).then(function(b){return Yq(a,"stopApp","DELETE",b)})},Zq=function(a,c){return a.b.send(Xq(a,c),"GET",void 0,{Sm:3}).then(function(b){Tq(a.m,"GetAppInfo","GET",b);if(!(200<=b.status&&
299>=b.status)){if(404==b.status)throw new Uq;throw Error("Response error: "+b.status);}b=b.responseText;b=(new DOMParser).parseFromString(b,"text/xml");b=b.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length?null:b;if(!b)throw a.m.info("Invalid or empty response"),Error("Invalid or empty response");var d=b.getElementsByTagName("service");if(!d||1!=d.length)throw a.m.info("Invalid GET response (invalid service)"),Error("Invalid GET response (invalid service)");b=new daa;for(var e=
0,f=d[0].childNodes.length;e<f;e++){var g=d[0].childNodes[e];if("state"==g.nodeName){a:switch(g.textContent){case "running":g="running";break a;case "stopped":g="stopped";break a;default:g="error"}b.state=g}else"name"==g.nodeName?b.name=g.textContent:"link"==g.localName?b.resource=g.getAttribute("href"):"options"==g.nodeName?b.allowStop="false"!=g.getAttribute("allowStop"):b.extraData[g.nodeName]=g.innerHTML}if("unknown"==b.name)throw a.m.info("GET response missing name value"),Error("GET response missing name value");
if(b.name!=c)throw a.m.info("GET app name mismatch"),Error("GET app name mismatch");if("error"==b.state)throw a.m.info("GET response missing state value"),Error("GET response missing state value");if((d=/installable=(.+)/.exec(b.state))&&d[1])b.state="installable",b.b=d[1];else if("running"!=b.state&&"stopped"!=b.state)throw a.m.info("GET response has invalid state value"),Error("GET response has invalid state value");return b})},Xq=function(a,c){a=a.f.Wd;"/"!=a.charAt(a.length-1)&&(a+="/");return a+
c},Yq=function(a,c,b,d){return new Promise(function(e,f){Tq(a.m,c,b,d);200<=d.status&&299>=d.status?e():f(Error(d.statusText))})},Vq=null;var eaa=function(a,c){this.Kc=a;this.appName=c};var ar=function(a){this.b=new Map;this.f=a};ar.prototype.init=function(){hm(this)};ar.prototype.clear=function(){this.b.clear()};ar.prototype.add=function(a){if(!this.b.get(a.Kc.id)){this.b.set(a.Kc.id,a);var c=this.f;br(c);c.h.dg(c,a.Kc)}};var cr=function(a,c){a=l(a.b);for(var b=a.next();!b.done;b=a.next())if(b=l(b.value),b.next(),b=b.next().value,b.Kc.sinkId==c)return b;return null},er=function(a,c){var b=a.b.get(c);b&&(a.b.delete(c),dr(a.f,b))};
ar.prototype.Ed=function(){return Array.from(this.b.values(),function(a){return a.Kc})};ar.prototype.Fa=function(){return"dial.ActivityRecords"};ar.prototype.rb=function(){return[Array.from(this.b)]};ar.prototype.pb=function(){var a=em(this);a&&(this.b=new Map(a))};var fr=function(a){this.g=a;this.m=hb("mr.dial.SinkDiscoveryService");this.b=new Map;this.f={vg:0,Jg:0};this.h=0};fr.prototype.init=function(){hm(this)};
var haa=function(a,c){a.m.info("addSinks returned "+c.length+" sinks");ob(a.m,function(){return"....the list is: "+JSON.stringify(c)});var b=new Set(a.b.keys());c.forEach(function(f){var g=f.sink_id,k=f.extra_data.dial_media_sink,m=faa.test(k.model_name);f=new Em(f.name,g);f.pc=k.ip_address.address_bytes?k.ip_address.address_bytes.join("."):k.ip_address.address.join(".");f.Wd=k.app_url.url;f.Dc=k.model_name;f.Ie=!m;gaa(a,f);b.delete(f.getId())});var d=[];b.forEach(function(f){var g=a.b.get(f);d.push(g);
a.b.delete(f)});0<d.length&&a.g.uj(d);var e=a.b.size;a.f={vg:e,Jg:e}},gaa=function(a,c){ob(a.m,"mayAddSink, id = "+c.getId());var b=a.b.get(c.getId());b?b.update(c)&&(ob(a.m,"Updated sink "+b.getId()),a.g.Rh(b)):(ob(a.m,function(){return"Adding new sink "+c.getId()+": name = "+(c.Ec.friendlyName+(c.pc?", ip = "+c.pc:"")+(c.Dc?", model = "+c.Dc:"")+", apps = "+JSON.stringify(c.lc))}),a.b.set(c.getId(),c),a.g.tj(c))};fr.prototype.qa=function(a){return this.b.get(a)||null};
var jaa=function(a,c){var b=[];a.b.forEach(function(d){"available"==Fm(d,c)&&b.push(d.Ec)});return new xq(b,iaa[c])};fr.prototype.Ze=function(){return this.f};fr.prototype.Fa=function(){return"dial.DialSinkDiscoveryService"};fr.prototype.rb=function(){return[new kaa(Array.from(this.b),this.f),{deviceCountMetricsRecordTime:this.h}]};
fr.prototype.pb=function(){var a=em(this);if(a){for(var c=l(a.sinks),b=c.next();!b.done;b=c.next())b=b.value,this.b.set(b[0],Gm(b[1]));this.f=a.deviceCounts}if(a=fm(this))this.h=a.deviceCountMetricsRecordTime};
var iaa={YouTube:"https://tv.youtube.com https://tv-green-qa.youtube.com https://tv-release-qa.youtube.com https://web-green-qa.youtube.com https://web-release-qa.youtube.com https://www.youtube.com".split(" "),Netflix:["https://www.netflix.com"],Pandora:["https://www.pandora.com"],Radio:["https://www.pandora.com"],Hulu:["https://www.hulu.com"],Vimeo:["https://www.vimeo.com"],Dailymotion:["https://www.dailymotion.com"],"com.dailymotion":["https://www.dailymotion.com"]},faa=/Eureka Dongle|Chromecast Audio|Chromecast Ultra/i,
kaa=function(a,c){this.sinks=a;this.deviceCounts=c};var gr=function(a){return Promise.all(a.map(function(c){return c.then(function(b){return{de:!0,value:b}},function(b){return{de:!1,reason:b}})}))};var hr=function(a,c){this.m=hb("mr.dial.AppDiscoveryService");this.b=new Set;this.f=a;this.w=c;this.j=new Map;this.l=new Map;this.g=null;this.h=!1};hr.prototype.init=function(){hm(this)};hr.prototype.start=function(){this.m.info("Starting periodic scanning.");this.h||(this.h=!0,ir(this))};hr.prototype.stop=function(){this.m.info("Stopping periodic scanning.");this.h&&(this.h=!1,this.g&&(clearTimeout(this.g),this.g=null),this.j.clear())};
var ir=function(a){a.m.info("Start app status scan.");var c=[];Array.from(a.f.b.values()).forEach(function(b){c.push.apply(c,jr(a,b))});Array.from(a.w.b.values()).forEach(function(b){c.push(laa(a,b))});gr(c).then(function(){a.h&&!a.g&&(ob(a.m,"Scan complete; scheduling for next scan."),a.g=setTimeout(function(){ob(a.m,"Start app status scan (timer-based)");a.g=null;ir(a)},6E4))})},jr=function(a,c){if(!c.Ie)return[];for(var b=[],d=l(a.b),e=d.next();!e.done;e=d.next())b.push(a.o(e.value,c));return b};
hr.prototype.o=function(a,c){var b=this;if("unknown"!=Fm(c,a)&&36E5>Date.now()-(c.Nh[a]||0)||!c.Ie)return Promise.resolve();ob(this.m,"Querying "+c.getId()+" for "+a+" to update app status");return kr(this,c,a).then(function(d){a:if("Netflix"==d.name)d=!d.extraData||"websocket"!=d.extraData.capabilities||"running"!=d.state&&"stopped"!=d.state?"unavailable":"available";else switch(d.state){case "running":case "stopped":d="available";break a;default:d="unavailable"}lr(b,c,a,d)},function(d){d instanceof
Uq?lr(b,c,a,"unavailable"):(b.m.H("Failed to process app availability; "+c.getId()+" does not support app availability"),c.Ie=!1)})};
var laa=function(a,c){var b=a.f.qa(c.Kc.sinkId);if(!b)return a.m.H("Activity refers to nonexistent sink: "+c.Kc.id),Promise.resolve();if(!b.Ie)return Promise.resolve();var d=c.appName;ob(a.m,"Querying "+b.getId()+" for "+d+" to update activity");return kr(a,b,d).then(function(e){"running"!=e.state&&nr(a,b,d)},function(){return nr(a,b,d)})},maa=function(a,c){var b=a.l.get(c.getId());b||(b=new Wq(c),ob(a.m,"Created DIAL client for "+c.getId()),a.l.set(c.getId(),b));return b},kr=function(a,c,b){var d=
naa(c,b),e=a.j.get(d);if(e)return e;e=Zq(maa(a,c),b);a.j.set(d,e);c=function(){a.j.delete(d)};e.then(c,c);return e},naa=function(a,c){return a.getId()+":"+c},lr=function(a,c,b,d){ob(a.m,"Got app status "+d+" from "+c.getId()+" for "+b);var e=Fm(c,b);c.lc[b]=d;c.Nh[b]=Date.now();d!=e&&a.f.g.Rh(c)},nr=function(a,c,b){(c=cr(a.w,c.getId()))&&c.appName==b&&er(a.w,c.Kc.id)},oaa=function(a,c){return Array.from(a.f.b.values()).some(function(b){return"unknown"==Fm(b,c)})};hr.prototype.Fa=function(){return"dial.AppDiscoveryService"};
hr.prototype.rb=function(){return[Array.from(this.b)]};hr.prototype.pb=function(){var a=em(this);this.b=new Set(a||[])};var or=function(a,c){this.appName=a;this.launchParameter=void 0===c?"":c},qr=function(a){try{var c=new URL(a)}catch(b){return pr.info("Invalid URL: "+a),null}switch(c.protocol){case "dial:":a:if(a=c.pathname,a.match(/^\w+$/)){if(c=c.searchParams.get("postData")||void 0)try{c=tm(c)}catch(b){pr.H("Invalid base64 encoded postData:"+c);a=null;break a}a=new or(a,c)}else pr.H("Invalid app name: "+a),a=null;return a;case "https:":return paa(c);default:return ob(pr,"Unhandled protocol: "+c.protocol),null}},
paa=function(a){var c=a.hash;if(!c)return null;a=(a=qaa.exec(c))?a[1]:null;if(!a)return null;a=decodeURIComponent(a);if(c=(c=raa.exec(c))?c[1]:void 0)try{c=tm(c)}catch(b){return pr.H("Invalid base64 encoded postData:"+c),null}return new or(a,c)},pr=hb("mr.dial.PresentationUrl"),qaa=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,raa=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var rr=function(a,c){this.h=a;this.f=c||new fr(this);this.g=new ar(this);this.b=null;this.m=hb("mr.DialProvider")};h=rr.prototype;h.getName=function(){return"dial"};h.Ze=function(){return this.f.Ze()};h.initialize=function(a){a=a&&0==a.enable_dial_sink_query?!1:!0;this.m.info("Dial sink query enabled: "+a+"...");this.g.init();this.f.init();a?(this.b=this.b||new hr(this.f,this.g),this.b.init()):this.b=null;br(this)};
h.Fg=function(a){if(!this.b)return yq;ob(this.m,"GetAvailableSinks for "+a);return(a=qr(a))?jaa(this.f,a.appName):yq};h.startObservingMediaSinks=function(a){if(this.b){var c=qr(a);if(c){a=this.b;c=c.appName;if(!a.b.has(c)||oaa(a,c))a.b.add(c),0!=a.f.b.size&&(a.h?Array.from(a.f.b.values()).forEach(a.o.bind(a,c)):a.start());br(this)}}};h.stopObservingMediaSinks=function(a){this.b&&(a=qr(a))&&(this.b.b.delete(a.appName),sr(this))};h.startObservingMediaRoutes=function(){br(this)};
h.stopObservingMediaRoutes=function(){sr(this)};var sr=function(a){a.b&&(0==a.f.b.size||0==a.b.b.size&&0==a.g.b.size)&&a.b.stop()},br=function(a){a.b&&0<a.f.b.size&&(0<a.b.b.size||0<a.g.b.size)&&a.b.start()};h=rr.prototype;h.qa=function(a){return(a=this.f.qa(a))?a.Ec:null};h.Ed=function(){return this.g.Ed()};
h.createRoute=function(a,c,b,d){var e=this,f=this.f.qa(c);if(!f)return Qq(1),xi(Error("Unkown sink: "+c));Bm().f=new ym(f.Dc,f.Yb());var g=qr(a);if(!g)return Qq(4),xi(Error("No app name set."));var k=g.appName,m=new Wq(f);return yi(Zq(m,k).then(function(p){if("running"==p.state)return $q(m,k)}).then(function(){return m.launchApp(k,g.launchParameter)}).then(function(){Qq(0);return tr(e,c,a,k,b,d)}).catch(function(p){Qq(3);throw p;}))};h.joinRoute=function(){return xi(Error("Not supported"))};
h.connectRouteByRouteId=function(){return xi(Error("Not supported"))};h.detachRoute=function(){};var tr=function(a,c,b,d,e,f){c=Op(e,a.getName(),c,b,!0,d);c.offTheRecord=f;a.g.add(new eaa(c,d));return c};rr.prototype.tj=function(a){this.h.onSinkAvailabilityUpdated(this,1);this.b&&(br(this),jr(this.b,a));this.h.gd();Bm().b=new ym(a.Dc,a.Yb())};
rr.prototype.uj=function(a){var c=this;if(0==this.f.b.size)this.h.onSinkAvailabilityUpdated(this,0);sr(this);a.forEach(function(b){var d=c.g;b=b.getId();if(b=cr(d,b))d.b.delete(b.Kc.id),dr(d.f,b)});this.h.gd()};rr.prototype.Rh=function(){this.h.gd()};var dr=function(a,c){c=c.Kc;if(c.isLocal)a.h.onPresentationConnectionStateChanged(c.id,"terminated");sr(a);a.h.Ng(c)};h=rr.prototype;
h.terminateRoute=function(a){var c=this.g.b.get(a)||null;if(!c)return Rq(1),Promise.reject(new wq(3,"Route in DIAL provider not found for routeId "+a));er(this.g,a);a=this.f.qa(c.Kc.sinkId);return a?$q(new Wq(a),c.appName).then(function(){Rq(0);return Promise.resolve()}).catch(function(b){Rq(3);return Promise.reject(b)}):(Rq(1),Promise.reject(new wq(3,"Sink in DIAL provider not found for sinkId "+c.Kc.sinkId)))};h.Pf=function(){throw Error("Not implemented.");};h.Of=function(){return null};h.Xh=function(){};
h.sendRouteMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.sendRouteBinaryMessage=function(){return Promise.reject(Error("DIAL sending messages is not supported"))};h.xg=function(a,c){c=this.f.qa(c);return!c||ij(a)?!1:(a=qr(a))?"available"==Fm(c,a.appName):!1};h.Hf=function(){return!1};h.searchSinks=function(){return eb()};h.createMediaRouteController=function(){return eb()};h.provideSinks=function(a){haa(this.f,a)};var ur=function(a){this.l=new fr(this);this.g=new Qm;this.f=a;this.w=this.j=0;this.h=new Mn;this.b=new rr(this,this.l)};h=ur.prototype;h.Fa=function(){return"cast.DialProviderWrapper"};h.rb=function(){return[new saa(Vm(this.g),this.j,this.w,this.h.pa())]};h.pb=function(){var a=em(this);a&&(Pm(this.g,a.f),this.j=a.sequenceNumber,this.w=a.g,Ln(this.h,a.b))};h.getName=function(){return this.b.getName()};h.initialize=function(a){this.b.initialize(a);hm(this)};h.Ed=function(){return this.b.Ed()};
h.Fg=function(a){return(a=vr(a))?this.b.Fg(a):yq};h.startObservingMediaSinks=function(a){(a=vr(a))&&this.b.startObservingMediaSinks(a)};h.stopObservingMediaSinks=function(a){(a=vr(a))&&this.b.stopObservingMediaSinks(a)};h.startObservingMediaRoutes=function(a){(a=vr(a))&&this.b.startObservingMediaRoutes(a)};h.stopObservingMediaRoutes=function(a){(a=vr(a))&&this.b.stopObservingMediaRoutes(a)};h.qa=function(a){return this.b.qa(a)};
var uaa=function(a,c,b,d,e){var f=vr(c);if(!f)return Qq(4),Promise.reject(Error("Invalid source"));var g=qr(f),k=a.l.qa(b);if(!k)return Qq(1),Promise.reject(Error("Attempting custom launch with closed route"));var m=g.appName;if(!m)return Qq(2),Promise.reject(Error("No app name given"));var p=taa(c);return p?Zq(new Wq(k),m).then(function(u){var A=tr(a.b,b,c,m,e,d);u={routeId:A.id,sinkId:k.getId(),appName:m,rl:u,launchParameter:g.launchParameter,session:null,clientId:null};a.g.set(A.id,u);var E=wr(a,
u.sinkId),F=new fo("receiver_action",{receiver:E,action:chrome.cast.rg.CAST});F.clientId=p;a.f.he(u.routeId,F);F=chrome.cast.ca;var J=String(a.w);a.w=(a.w+1)%9007199254740992;E=new F(J,"",u.appName,[],E);u.session=E;u.clientId=p;E=new fo("new_session",E);E.clientId=p;a.f.he(u.routeId,E);return A}).catch(function(u){Qq(3);throw u;}):(Qq(2),Promise.reject(Error("No client ID")))};
ur.prototype.createRoute=function(a,c,b,d,e,f,g){return a.startsWith("cast-dial:")||xr.test(a)?yi(uaa(this,a,c,d,b)):this.b.createRoute(a,c,b,d,e,f,g)};ur.prototype.terminateRoute=function(a){var c=this.g.get(a);if(c&&c.session&&c.clientId){var b={receiver:wr(this,c.sinkId),action:chrome.cast.rg.STOP};b=new fo("receiver_action",b);b.clientId=c.clientId;this.f.he(c.routeId,b);this.f.onPresentationConnectionStateChanged(c.routeId,"terminated")}return this.b.terminateRoute(a)};
ur.prototype.sendRouteMessage=function(a,c,b){try{var d=JSON.parse(c)}catch(e){return Sq(1),Promise.reject(e)}switch(d.type){case "client_connect":return Sq(0),vaa(this,a,d.clientId);case "custom_dial_launch":if(this.h.contains(d.sequenceNumber))return Sq(0),waa(this,a,d).then(function(e){Qq(0);return e}).catch(function(e){Qq(3);throw e;});break;case "v2_message":if("STOP"==d.message.type)return Sq(0),this.terminateRoute(a),Promise.resolve()}Sq(2);return this.b.sendRouteMessage(a,c,b)};
ur.prototype.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
var waa=function(a,c,b){a.h.remove(b.sequenceNumber);b=b.message;c=a.g.get(c);if(!c)return Promise.reject(Error("Unknown route"));if(b&&!b.doLaunch)return Promise.resolve();a=a.l.qa(c.sinkId);if(!a)return Promise.reject(Error("Custom launch response for sink that no longer exists"));a=new Wq(a);var d=c.launchParameter;d=(b?b.launchParameter:null)||d;return a.launchApp(c.appName,d)},wr=function(a,c){a=a.l.qa(c);c=Cm(Bm(),c);c=new chrome.cast.li(c,a.Ec.friendlyName);c.ipAddress=a.Yb();c.receiverType=
chrome.cast.rh.DIAL;return c},vaa=function(a,c,b){c=a.g.get(c);if(!c)return Promise.reject(Error("Unknown route"));var d=wr(a,c.sinkId);d.receiverType=chrome.cast.rh.DIAL;d=new fo("custom_dial_launch",new chrome.cast.Ik(d,c.rl.state,c.rl.extraData));d.clientId=b;b=a.j;a.j=(a.j+1)%9007199254740992;d.sequenceNumber=b;a.h.add(d.sequenceNumber);a.f.he(c.routeId,d);return Promise.resolve()};h=ur.prototype;h.Pf=function(a){return this.b.Pf(a)};h.Of=function(a){return this.b.Of(a)};h.Xh=function(){};
h.xg=function(a,c){return a.startsWith("cast-dial:")||xr.test(a)||this.b.xg(a,c)};h.Hf=function(a,c,b){return this.b.Hf(a,c,b)};h.connectRouteByRouteId=function(a,c,b,d,e){return this.b.connectRouteByRouteId(a,c,b,d,e)};h.joinRoute=function(a,c,b,d,e,f){return this.b.joinRoute(a,c,b,d,e,f)};h.detachRoute=function(a){this.g.remove(a);this.b.detachRoute(a)};h.gd=function(){this.f.gd()};h.onSinkAvailabilityUpdated=function(a,c){this.f.onSinkAvailabilityUpdated(a,c)};
h.dg=function(a,c){this.f.dg(this,c)};h.Ng=function(a){this.f.Ng(a)};h.hf=function(a){this.f.hf(a)};h.Xi=function(){};h.getMirroringServiceHostForTab=function(){};h.getMirroringServiceHostForDesktop=function(){};h.getMirroringServiceHostForOffscreenTab=function(){};h.he=function(a,c){this.f.he(a,c)};h.onPresentationConnectionStateChanged=function(a,c){this.f.onPresentationConnectionStateChanged(a,c)};h.onPresentationConnectionClosed=function(a,c,b){this.f.onPresentationConnectionClosed(a,c,b)};
h.Pi=function(a){return this.f.Pi(a)};h.Ri=function(){return this.f.Ri()};h.cf=function(a){this.f.cf(a)};h.Wh=function(a,c){this.f.Wh(a,c)};h.Yh=function(a){this.f.Yh(a)};h.tj=function(a){this.b.tj(a)};h.uj=function(a){this.b.uj(a)};h.Rh=function(a){this.b.Rh(a)};h.vj=function(){};h.Am=function(){};h.searchSinks=function(a,c){return this.b.searchSinks(a,c)};h.provideSinks=function(a){this.b.provideSinks(a)};h.createMediaRouteController=function(){return eb()};
h.gg=function(a,c){return this.f.gg(a,c)};h.Ze=function(){return this.b.Ze()};
var vr=function(a){try{var c=new URL(a)}catch(e){return null}if("dial:"==c.protocol)return a;if("cast-dial:"==c.protocol){var b=c;a="cast-dial:"!=b.protocol?null:new no(b.pathname,b.searchParams.get("dialPostData"),b.searchParams.get("clientId"));b=a.g;var d=a.b}else if("https:"==c.protocol){a=yo(a);if(!a)return null;b=a.u;d=a.D}b?(a=d||"",b=new URL("dial:"+b),a&&b.searchParams.set("postData",a),b=b.toString()):b=null;return b},taa=function(a){try{var c=new URL(a)}catch(b){return null}return"cast-dial:"==
c.protocol?c.searchParams.get("clientId"):"https:"==c.protocol?zo(a):null},saa=function(a,c,b,d){this.f=a;this.sequenceNumber=c;this.g=b;this.b=d},xr=/__dialAppName__/;var yr=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,xaa=function(a,c){if(a){a=a.split("&");for(var b=0;b<a.length;b++){var d=a[b].indexOf("="),e=null;if(0<=d){var f=a[b].substring(0,d);e=a[b].substring(d+1)}else f=a[b];c(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}},zr=function(a,c,b){b=null!=b?"="+encodeURIComponent(String(b)):"";if(c+=b){b=a.indexOf("#");0>b&&(b=a.length);var d=a.indexOf("?");if(0>d||d>b){d=b;var e=
""}else e=a.substring(d+1,b);a=[a.substr(0,d),e,a.substr(b)];b=a[1];a[1]=c?b?b+"&"+c:c:b;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a},yaa=/#|$/,Ar=function(a,c){var b=a.search(yaa);a:{var d=0;for(var e=c.length;0<=(d=a.indexOf(c,d))&&d<b;){var f=a.charCodeAt(d-1);if(38==f||63==f)if(f=a.charCodeAt(d+e),!f||61==f||38==f||35==f)break a;d+=e+1}d=-1}if(0>d)return null;e=a.indexOf("&",d);if(0>e||e>b)e=b;d+=c.length+1;return decodeURIComponent(a.substr(d,e-d).replace(/\+/g," "))},Br=function(a,c){var b=a.length-
1;0<=b&&a.indexOf("/",b)==b&&(a=a.substr(0,a.length-1));ld(c,"/")&&(c=c.substr(1));return te(a,"/",c)};var Cr=function(a){this.yc=this.w=this.g="";this.La=null;this.h=this.b="";this.j=!1;var c;a instanceof Cr?(this.j=Ha(void 0)?void 0:a.j,Dr(this,a.g),this.w=a.w,this.yc=a.yc,Er(this,a.Fb()),this.b=a.b,Fr(this,a.f.clone()),this.h=a.h):a&&(c=String(a).match(yr))?(this.j=!1,Dr(this,c[1]||"",!0),this.w=Gr(c[2]||""),this.yc=Gr(c[3]||"",!0),Er(this,c[4]),this.b=Gr(c[5]||"",!0),Fr(this,c[6]||"",!0),this.h=Gr(c[7]||"")):(this.j=!1,this.f=new Hr(null,this.j))};
Cr.prototype.toString=function(){var a=[],c=this.g;c&&a.push(Ir(c,Jr,!0),":");var b=this.yc;if(b||"file"==c)a.push("//"),(c=this.w)&&a.push(Ir(c,Jr,!0),"@"),a.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.Fb(),null!=b&&a.push(":",String(b));if(b=this.b)this.yc&&"/"!=b.charAt(0)&&a.push("/"),a.push(Ir(b,"/"==b.charAt(0)?zaa:Aaa,!0));(b=this.f.toString())&&a.push("?",b);(b=this.h)&&a.push("#",Ir(b,Baa));return a.join("")};
Cr.prototype.resolve=function(a){var c=this.clone(),b=!!a.g;b?Dr(c,a.g):b=!!a.w;b?c.w=a.w:b=!!a.yc;b?c.yc=a.yc:b=null!=a.La;var d=a.b;if(b)Er(c,a.Fb());else if(b=!!a.b){if("/"!=d.charAt(0))if(this.yc&&!this.b)d="/"+d;else{var e=c.b.lastIndexOf("/");-1!=e&&(d=c.b.substr(0,e+1)+d)}e=d;if(".."==e||"."==e)d="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){d=ld(e,"/");e=e.split("/");for(var f=[],g=0;g<e.length;){var k=e[g++];"."==k?d&&g==e.length&&f.push(""):".."==k?((1<f.length||1==f.length&&""!=
f[0])&&f.pop(),d&&g==e.length&&f.push("")):(f.push(k),d=!0)}d=f.join("/")}else d=e}b?c.b=d:b=""!==a.f.toString();b?Fr(c,a.f.clone()):b=!!a.h;b&&(c.h=a.h);return c};Cr.prototype.clone=function(){return new Cr(this)};var Dr=function(a,c,b){a.g=b?Gr(c,!0):c;a.g&&(a.g=a.g.replace(/:$/,""))};Cr.prototype.Fb=function(){return this.La};
var Er=function(a,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);a.La=c}else a.La=null},Fr=function(a,c,b){c instanceof Hr?(a.f=c,Caa(a.f,a.j)):(b||(c=Ir(c,Daa)),a.f=new Hr(c,a.j))},Gr=function(a,c){return a?c?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Ir=function(a,c,b){return Ia(a)?(a=encodeURI(a).replace(c,Eaa),b&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},Eaa=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},
Jr=/[#\/\?@]/g,Aaa=/[#\?:]/g,zaa=/[#\?]/g,Daa=/[#\?@]/g,Baa=/#/g,Hr=function(a,c){this.f=this.b=null;this.g=a||null;this.h=!!c},Kr=function(a){a.b||(a.b=new Qm,a.f=0,a.g&&xaa(a.g,function(c,b){a.add(decodeURIComponent(c.replace(/\+/g," ")),b)}))},Mr=function(a){var c=Gn(a);if("undefined"==typeof c)throw Error("Keys are undefined");var b=new Hr(null,void 0);a=Fn(a);for(var d=0;d<c.length;d++){var e=c[d],f=a[d];Va(f)?Lr(b,e,f):b.add(e,f)}return b};h=Hr.prototype;h.sa=function(){Kr(this);return this.f};
h.add=function(a,c){Kr(this);this.g=null;a=Nr(this,a);var b=this.b.get(a);b||this.b.set(a,b=[]);b.push(c);this.f+=1;return this};h.remove=function(a){Kr(this);a=Nr(this,a);return Tm(this.b,a)?(this.g=null,this.f-=this.b.get(a).length,this.b.remove(a)):!1};h.clear=function(){this.b=this.g=null;this.f=0};h.Vb=function(){Kr(this);return 0==this.f};var Or=function(a,c){Kr(a);c=Nr(a,c);return Tm(a.b,c)};h=Hr.prototype;h.Jf=function(a){var c=this.pa();return Wb(c,a)};
h.forEach=function(a,c){Kr(this);this.b.forEach(function(b,d){Mb(b,function(e){a.call(c,e,d,this)},this)},this)};h.Lb=function(){Kr(this);for(var a=this.b.pa(),c=this.b.Lb(),b=[],d=0;d<c.length;d++)for(var e=a[d],f=0;f<e.length;f++)b.push(c[d]);return b};h.pa=function(a){Kr(this);var c=[];if(Ia(a))Or(this,a)&&(c=fc(c,this.b.get(Nr(this,a))));else{a=this.b.pa();for(var b=0;b<a.length;b++)c=fc(c,a[b])}return c};
h.set=function(a,c){Kr(this);this.g=null;a=Nr(this,a);Or(this,a)&&(this.f-=this.b.get(a).length);this.b.set(a,[c]);this.f+=1;return this};h.get=function(a,c){if(!a)return c;a=this.pa(a);return 0<a.length?String(a[0]):c};var Lr=function(a,c,b){a.remove(c);0<b.length&&(a.g=null,a.b.set(Nr(a,c),y(b)),a.f+=b.length)};
Hr.prototype.toString=function(){if(this.g)return this.g;if(!this.b)return"";for(var a=[],c=this.b.Lb(),b=0;b<c.length;b++){var d=c[b],e=encodeURIComponent(String(d));d=this.pa(d);for(var f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}}return this.g=a.join("&")};Hr.prototype.clone=function(){var a=new Hr;a.g=this.g;this.b&&(a.b=this.b.clone(),a.f=this.f);return a};
var Nr=function(a,c){c=String(c);a.h&&(c=c.toLowerCase());return c},Caa=function(a,c){c&&!a.h&&(Kr(a),a.g=null,a.b.forEach(function(b,d){var e=d.toLowerCase();d!=e&&(this.remove(d),Lr(this,e,b))},a));a.h=c};Hr.prototype.extend=function(a){for(var c=0;c<arguments.length;c++)In(arguments[c],function(b,d){this.add(d,b)},this)};var Faa=function(a,c){this.input=a;this.domain=c};var Pr=function(a){this.b=a;this.m=hb("mr.ExternalMessageHandler")};
Pr.prototype.onMessage=function(a,c,b){var d=this;this.m.info("Received a message from "+c.id+" type: "+a.type);var e=chrome.runtime.id;"start"==a.type?(a=a.message,this.b.searchSinks("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new Faa(a.meetingName,a.domain)).then(function(f){var g="PresentationId"+c.id+Gaa++;d.b.createRoute("urn:x-org.chromium.media:source:desktop",f,g).then(function(k){b(new sf(e,"route",k.id))}).catch(function(k){b(new sf(e,"error",k))})},function(){b(new sf(e,"error",
Error("Failed to find sink.")))})):"stop"==a.type?this.b.terminateRoute(a.message.routeId).then(function(){b(new sf(e,"stopped"))}):"subscribe_log_data"==a.type?(jb.push(function(f){chrome.runtime.sendMessage(c.id,new sf(e,"log_message",f))}),b(new sf(e,"subscribed"))):(b(new sf(e,"error",Error("Unhandled message type"))),this.m.error("Unhandled message type "+a.type))};var Gaa=0;var Qr=function(){this.b=[];this.f=[]};h=Qr.prototype;h.enqueue=function(a){if(1E3<=this.sa()){if(this.Vb())throw Error("Empty queue");0==this.b.length&&(this.b=this.f,this.b.reverse(),this.f=[]);this.b.pop()}this.f.push(a)};h.sa=function(){return this.b.length+this.f.length};h.Vb=function(){return 0==this.sa()};h.pa=function(){var a=this.b.slice();a.reverse();a.push.apply(a,n(this.f));return a};h.clear=function(){this.b=[];this.f=[]};var Rr=function(){this.b=new Qr;this.f=Date.now()},Tr=function(){null==Sr&&(Sr=new Rr);return Sr};
Rr.prototype.init=function(){ib=1;var a=hb("browser"),c=window.onerror;window.onerror=function(d,e,f,g,k){try{var m=k.result.error.errors[0];if("usageLimits"==m.domain&&"accessNotConfigured"==m.reason)return!0}catch(p){}c&&c(d,e,f,g,k);a.error("Error: "+d+" ("+e+" @ Line: "+f+")",k)};jb.push(this.h.bind(this));var b=window.localStorage["debug.logs"];b&&(ib=qb(b.toUpperCase()));(b=window.localStorage["debug.console"])&&"false"!=b.toLowerCase()&&jb.push(this.g.bind(this))};
Rr.prototype.h=function(a){this.b.enqueue(Ur(this,a,!1));a=a.Ic;a instanceof Error&&a.stack&&this.b.enqueue(a.stack)};Rr.prototype.g=function(a){var c=[Ur(this,a,!0)];a.Ic&&c.push(a.Ic);switch(a.level){case 3:console.error.apply(console,n(c));break;case 2:console.warn.apply(console,n(c));break;case 1:console.log.apply(console,n(c));break;default:console.debug.apply(console,n(c))}};
var Ur=function(a,c,b){var d=["["];if(b)d.push(("       "+((Date.now()-a.f)/1E3).toFixed(3)).slice(-7));else{a=new Date(c.time);var e=function(f){return 10>f?"0"+f:f};d.push(a.getFullYear().toString(),"-",e(a.getMonth()+1),"-",e(a.getDate())," ",e(a.getHours()),":",e(a.getMinutes()),":",e(a.getSeconds()),".",e(Math.floor(a.getMilliseconds()/10)))}d.push("][",pb[c.level],"][",c.R,"] ",c.message);if(!b&&null!=c.Ic)if(d.push("\n"),c.Ic instanceof Error)d.push(c.Ic.message);else try{d.push(JSON.stringify(c.Ic))}catch(f){d.push(c.Ic.toString())}d.push("\n");
return d.join("")},Haa=function(){var a=Tr();return 0==a.b.sa()?"NA":a.b.pa().join("")},Iaa=function(){var a=Tr();hm(a)};Rr.prototype.Fa=function(){return"LogManager"};Rr.prototype.rb=function(){return[this.b.pa()]};Rr.prototype.pb=function(){var a=this.b.pa();this.b.clear();for(var c=l(em(this)||[]),b=c.next();!b.done;b=c.next())this.b.enqueue(b.value);a=l(a);for(b=a.next();!b.done;b=a.next())this.b.enqueue(b.value)};var Sr=null;var Vr=function(a){this.b=a;this.m=hb("mr.InternalMessageHandler")};
Vr.prototype.onMessage=function(a,c,b){var d=this;if("retrieve_log_data"!=a.type)b(new sf(chrome.runtime.id,"error",Error("Unhandled message type")));else{var e={logs:Haa(),device:Dm()};c=[];var f=rf(e.device.ip).then(function(k){k.b&&(e.device.version=k.b)});c.push(f);var g=this.b.u;g&&(a=Jaa(this,g,a.source).then(function(k){k&&(e.castStreamingLogs=k)},function(){d.m.error("Log upload failed for service: "+g)}),c.push(a));e.dialDeviceCounts=Kaa(this);c.push(Laa(this,e));a=this.b.getMediaSinkServiceStatus().then(function(k){e.mediaSinkServiceStatus=
k.status},function(){d.m.error("Fail to get media sink service status")});c.push(a);this.b.config&&(e.mirroringServiceEnabled=this.b.config.use_mirroring_service,e.nativeCastMrpEnabled=!this.b.config.enable_cast_sink_query,e.nativeDialMrpEnabled=!this.b.config.enable_dial_sink_query);gr(c).then(function(){b(e)})}};
var Laa=function(a,c){return Xi("mr.cast.SinkDiscoveryService").then(function(b){b=b.Ze();c.castDeviceCounts=b.Jg+"."+b.vg},function(){a.m.error("Failed to get device counts for castDeviceCounts.")})},Kaa=function(a){a=Wr(a.b,"dial");if(!a)return"";a=a.Ze();return a.Jg+"."+a.vg},Jaa=function(a,c,b){return Xr(a.b,c).then(function(d){return d.Ij(b)})};var Maa={ACCEPTED:0,ov:1,TIMEOUT:2},Naa={SUCCESS:0,Ev:1},Oaa={Dp:0,ap:1,UA:2,fw:3,ew:4,ux:5,TIMEOUT:6,Ly:7},Paa={cw:0,Zz:1},Qaa={my:0,ax:1,USER:2,Xv:3},Yr=function(a){Db("MediaRouter.Cloud.Knock.Result",a,Maa)},Zr=function(a){Db("MediaRouter.Cloud.Session.Start",a,Naa)},$r=function(a){Db("MediaRouter.Cloud.Session.Type",a,Paa)},as=function(a){Db("MediaRouter.Cloud.Device.UserRole",a,Qaa)};var bs=function(a,c){this.b=a;this.f=c},cs=new bs("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Raa=new bs("https://castedumessaging-pa.googleapis.com/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Saa=new bs("https://www.googleapis.com/calendar/v3",""),Taa=new bs("https://www.googleapis.com/hangouts/v1",""),ds=new bs("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var es=function(a,c,b,d,e,f){b=void 0===b?null:b;a||null==b&&(b="default");this.pm=a;this.Ka=c;this.yc=b;this.Yf=void 0===d?null:d;this.Wc=void 0===e?null:e;this.lf=void 0===f?null:f};es.prototype.f=function(){var a="";this.Wc?a=this.Wc:this.Yf&&(a=this.Yf);return a};es.prototype.Kd=function(){return this.pm};es.prototype.getId=function(){return this.Ka};es.prototype.merge=function(a){!this.lf&&a.lf&&(this.lf=a.lf);!this.Wc&&a.Wc&&(this.Wc=a.Wc);this.Wc&&a.Wc&&this.lf&&(this.Wc=a.Wc)};var fs=function(a,c){this.f=a;this.g=c;this.m=hb("mr.cloud.calendar.CalendarService")},Waa=function(a){return Uaa(a,a.g.b).then(function(c){a.m.info(gs(c.length)+" events discovered before filtering.");return Vaa(a,c)},function(c){a.m.H("Error getting Hangouts from calendar.",c);return[]})},gs=function(a){return 20<a?"20+":a.toString()},Uaa=function(a,c){var b=Date.now();return Xaa(a,c,new Date(b),new Date(b+9E5)).then(function(d){return d.filter(a.b)})};
fs.prototype.b=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};
var Xaa=function(a,c,b,d){c=hs(Saa.b,["calendars",c,"events"],{timeMin:b.toJSON(),timeMax:d.toJSON(),singleEvents:!0});ob(a.m,"Retrieving Hangouts from Calendar: "+c);return is(a.f,c,"GET").then(function(e){return e.items?e.items:[]})},Vaa=function(a,c){var b=[];c.filter(function(d){return d.hangoutLink}).forEach(function(d){var e=new Cr(d.hangoutLink);if("meet.google.com"==e.yc)b.push(new es(!0,e.b.substring(1),void 0,void 0,d.summary));else if(e=e.b.substring(12).split("/"),2==e.length){var f=l(e);
e=f.next().value;f=f.next().value;if(-1!=e.indexOf(".")){var g=f;var k=e}b.push(new es(!1,f+"@"+e,k,g,d.summary,void 0))}else a.m.H("Invalid hangout link from calendar event: "+d.hangoutLink)});a.m.info(gs(b.length)+" events discovered with Hangout links.");return b};var js=function(a){this.b=a;this.id=a.id;this.m=hb("mr.cloud.devices.WeaveDevice")};js.prototype.isAvailable=function(){if(this.getState().appStatus){var a="online"==this.b.connectionStatus,c="available"==this.getState().appStatus,b=ks(this,864E5);ob(this.m,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+c+", checked in: "+b);return a&&c&&b}a=ks(this,9E5);this.m.info("Availability for legacy receiver app: "+a);return a};
var ks=function(a,c){a=a.b.lastUpdateTimeMs?Number(a.b.lastUpdateTimeMs):null;return!!(a&&a>Date.now()-c)};js.prototype.f=function(){return this.getState().settings.receiverName};js.prototype.getId=function(){return this.id};js.prototype.getState=function(){return this.b.state._cloudCast};var ls=function(){this.m=Of("mr.cloud.GcmRegistrationSerializer");this.b=Promise.resolve("")};ls.prototype.register=function(a){var c=this,b=function(){return new Promise(function(d,e){chrome.gcm.register(a,function(f){f?(c.m.info("Got GCM registration ID: "+f),d(f)):e(Error(chrome.runtime.lastError&&chrome.runtime.lastError.message||"unknown error"))})})};return this.b=this.b.then(b,b)};var Yaa=function(a){this.email=a;this.imageUrl=null},Zaa=function(a){this.type=a},ms=function(a,c,b,d){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=c||null;this.flungUrl=b||null;this.presentationId=d||null};q(ms,Zaa);
var ns=function(a,c,b){this.name=a;this.parameters=c;this.minimalRole=null!=b?b:"user"},os={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},$aa=new ns("_knockingStartWebrtcSession",os,"viewer"),aba=new ns("_startWebrtcSession",os),bba=new ns("_stopSession",{},"viewer");var ps=function(a,c){this.j=a;this.w=c;this.f=this.g=this.b=null;this.h=!1;this.m=hb("mr.cloud.devices.WeaveDevicesService");hm(this)};ps.prototype.getDevice=function(a){a=hs(cs.b,["devices",a]);return is(this.j,a,"GET").then(function(c){return new js(c)})};
var cba=function(a){return qs(a,{descriptionSubstring:"Chrome Streaming Receiver"}).catch(function(){return[]})},qs=function(a,c){var b=hs(cs.b,["devices"],c);return is(a.j,b,"GET").then(function(d){var e=(d.devices||[]).filter(function(g){return null!=g.commandDefs&&null!=g.commandDefs._cloudCast}).map(function(g){return new js(g)});if(d=d.nextPageToken){var f=Oc(c);f.token=d;return qs(a,f).then(function(g){return e.concat(g)})}return e})};ps.prototype.Fa=function(){return"WeaveDevicesService"};
ps.prototype.rb=function(){return[new dba(this.b,this.f,this.g)]};ps.prototype.pb=function(){var a=em(this);a&&(this.b=a.lr,this.f=a.gcmRegistrationId,this.g=a.kr)};var eba=function(a){return a.f&&null!=a.g&&a.g+864E5>=Date.now()?Promise.resolve(a.f):a.w.register(["919648714761"]).then(function(c){ob(a.m,"Got GCM ID: "+c);a.f=c;a.g=Date.now();a.b=null;return c},function(c){a.m.H("Error",c);a.f=null;a.g=null;a.b=null;throw c;})};
ps.prototype.subscribe=function(a){var c=this;if(this.h)return Promise.resolve();this.h=!0;if(!a||this.b&&!(this.b+864E5<Date.now()))return Promise.resolve();a={filters:["myDevices"],gcmRegistrationId:a,gcmSenderId:"919648714761",expirationTimeMs:864E5};var b=hs(cs.b,["subscriptions","subscribe"],{});return is(this.j,b,"POST",a).then(function(){ob(c.m,"Subscribed on: "+Date.now());c.b=Date.now();c.h=!1;return Promise.resolve()},function(){c.h=!1;return Promise.resolve()})};
var dba=function(a,c,b){this.lr=a;this.gcmRegistrationId=c;this.kr=b};var rs=function(a,c,b,d,e,f,g,k){var m=Cm(Bm(),a);this.ub=new am(m,c,g,k,e);this.deviceId=a;this.b=b;this.model=d;this.isAvailable=f};ca.Object.defineProperties(rs.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.ub.id}},displayName:{configurable:!0,enumerable:!0,set:function(a){this.ub.friendlyName=a}}});var ss=function(a,c,b,d,e){rs.call(this,a,c,"weave","Chrome Streaming Receiver",d,e,"education");this.vi=b};q(ss,rs);
var ts=function(a){var c=a.yc,b;a.Yf&&a.f()!=a.Yf&&(b=a.Yf);rs.call(this,a.getId(),a.f(),"mesi","Hangout",c,!1,a.Kd()?"meeting":"hangout",b);this.Kd=a.Kd();this.hh=a.lf||""};q(ts,rs);var us=function(a,c,b){rs.call(this,a,c,"slarti","Cast Receiver for Education","default",b,"education")};q(us,rs);var vs=function(a,c,b){this.w=a;this.h=c;this.b=new Map;this.g=new Map;this.f=null;this.j=b};vs.prototype.ie=function(){var a=this.f+this.j;if(null==this.f||a<Date.now())this.f=Date.now(),fba(this);return Array.from(this.b.values())};vs.prototype.qa=function(a){return this.b.get(a)||null};
var fba=function(a){a.w().then(function(c){gba(a,c)})},gba=function(a,c){var b=new Map(a.b),d=new Map,e=new Map,f=[],g=[];c.forEach(function(k){var m=k.id;d.set(m,k);e.set(m,k.deviceId);b.has(m)?b.has(m)&&JSON.stringify(b.get(m))!=JSON.stringify(k)&&g.push(k.ub):f.push(k.ub);b.delete(m)});c=[].concat(n(b.values())).map(function(k){return k.ub});a.g.clear();a.g=e;a.b.clear();a.b=d;hba(a,f,g,c)},hba=function(a,c,b,d){0<c.length&&ws(a.h,c);0<b.length&&xs(a.h,b);0<d.length&&ys(a.h,d)},zs=function(a){for(var c=
{},b=l(a.b.entries()),d=b.next();!d.done;d=b.next()){var e=l(d.value);d=e.next().value;e=e.next().value;c[d]=e}b={};d=l(a.g.entries());for(e=d.next();!e.done;e=d.next()){var f=l(e.value);e=f.next().value;f=f.next().value;b[e]=f}return new iba(c,b,a.f)},As=function(a,c){for(var b in c.sinks){var d=c.sinks[b],e=null;"Hangout"==d.model?e=new ts(new es(d.Kd,d.deviceId,d.ub.domain,d.ub.description,d.ub.friendlyName,d.hh)):"Cast Receiver for Education"==d.model?e=new us(d.deviceId,d.ub.friendlyName,d.isAvailable):
"Chrome Streaming Receiver"==d.model&&(e=new ss(d.deviceId,d.ub.friendlyName,d.vi,d.ub.domain,d.isAvailable));a.b.set(b,e)}for(b in c.b)a.g.set(b,c.b[b]);c.f&&(a.f=c.f)},iba=function(a,c,b){this.sinks=a;this.b=c;this.f=b};var Cs=function(a,c,b){if(!Bs){Nf();var d=Mf;d.f=If;var e=jba;d.b||(d.b=[]);d.b.push(e);Bs=!0}this.g=a;this.h=c;this.b=new vs(this.j.bind(this),b,2E4);this.f=new Map;hm(this)},jba=function(a){kb({R:a.g,level:rb(a.f.value),time:a.j,message:a.getMessage(),Ic:a.b})};Cs.prototype.ie=function(){return this.b.ie()};Cs.prototype.qa=function(a){return this.b.qa(a)};
Cs.prototype.j=function(){var a=this;this.m.info("Fetching hangouts");return gr([kba(this.h),Waa(this.g)]).then(function(c){var b=Array.from(a.f.values());c.forEach(function(e){e.de?b=b.concat(e.value):a.m.error("Error discovering Hangouts",e.reason)});var d=b.reduce(function(e,f){var g=e[f.getId()];g?g.merge(f):g=f;e[g.getId()]=g;return e},{});return Object.keys(d).map(function(e){e=d[e];Cb("MediaRouter.Cloud.Hangout.Sink.Discovered");return new ts(e)})})};
var lba=function(a,c){return Xi("mr.mirror.hangouts.MeetingsService").then(function(b){return b.Zb(c)}).then(function(b){return Ds(a,b)},function(){return c.input.match(/^#/)?Promise.reject(Error("Failed to resolve meeting alias.")):Ds(a,c.input,c.domain)})},Ds=function(a,c,b){b=b||void 0;var d=!b;c=new es(d,d?c:c+"@"+b,b,c,void 0,void 0);a.f.set(c.getId(),c);c=new ts(c);a.b.b.set(c.id,c);return c.ub};Cs.prototype.Fa=function(){return"HangoutSinkDiscoveryService"};
Cs.prototype.rb=function(){for(var a={},c=l(this.f.entries()),b=c.next();!b.done;b=c.next()){var d=l(b.value);b=d.next().value;d=d.next().value;a[b]=d}return[{cache:zs(this.b),manualHangouts:a}]};Cs.prototype.pb=function(){var a=em(this);if(a){As(this.b,a.cache);for(var c in a.manualHangouts){var b=a.manualHangouts[c];this.f.set(c,new es(b.pm,b.Ka,b.yc,b.Yf,b.Wc,b.lf))}}};Cs.prototype.m=hb("mr.cloud.discovery.HangoutSinkDiscoveryService");var Bs=!1;var Fs=function(){this.f=!1;this.b=null;this.g=!1;this.m=hb("mr.cloud.identity.IdentityService");hm(this);mba(this);Es(this)},Gs=function(a){return a.b?a.b.substr(a.b.indexOf("@")+1):""};
Fs.prototype.getAuthToken=function(){return chrome.identity?new Promise(function(a,c){chrome.identity.getAuthToken({interactive:!1},function(b){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==b?c(Error("User is not logged in (no token found)")):a(b)})}):Promise.reject(Error("chrome.identity permission required for auth."))};
var nba=function(a){return new Promise(function(c){chrome.identity.removeCachedAuthToken({token:a},function(){c()})})},Es=function(a){a.getAuthToken().then(function(c){chrome.identity.getProfileUserInfo(function(b){a.f=!!b.email||!!b.id;a.b=b.email||null;c&&!a.f&&(a.g=!0)})},function(c){ob(a.m,"Unable to set sign in and email.",c)})},mba=function(a){chrome.identity.onSignInChanged.addListener(function(c,b){fj(6);a.f=b;a.m.info("Signed in change: "+a.f);a.f?Es(a):(a.b=null,a.g=!1)})},oba=function(a){return a.getAuthToken().then(function(c){var b=
window.gapi;if(!b)return a.m.error("gapi not loaded."),!1;a.m.info("Setting gapi auth token");b.auth.setToken({access_token:c});return!0})};Fs.prototype.Fa=function(){return"IdentityService"};Fs.prototype.rb=function(){return[null,{signedIn:this.f,userEmail:this.b,kioskAuth:this.g}]};Fs.prototype.pb=function(){var a=fm(this);a&&(a.signedIn&&(this.f=a.signedIn),a.userEmail&&(this.b=a.userEmail),a.kioskAuth&&(this.g=a.kioskAuth))};var Hs="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var Is=function(a){var c=a.method,b=a.uri,d=a.baseUrl,e=a.Lc,f=a.nn,g=a.headers,k=a.body,m=a.start,p=a.apiKey,u=a.ih;a=a.ob;this.method=c&&c.toUpperCase()||"GET";(c=b)||(d=[d].concat(n(e||[])).join("/"),d=new Cr(encodeURI(d)),f&&(f=Mr(f),Fr(d,f)),c=d);this.uri=c;p&&this.uri.f.add("key",p);this.b=a||null;this.headers=g||{};(this.body=k)&&(this.headers["Content-Type"]="application/json");this.ih=Ha(u)?u:1E4;this.start=m||v()},pba=function(a){return(a.b?a.b.getAuthToken():Promise.resolve(null)).then(function(c){c&&
(a.headers.Authorization="Bearer "+c);c={method:a.method,headers:a.headers};a.body&&(c.body=JSON.stringify(a.body));return new Request(a.uri.toString(),c)})};var qba={fv:100,dA:101,iy:200,gv:201,ACCEPTED:202,Mx:203,Zx:204,fz:205,ty:206,Ax:207,zx:300,wx:301,Lv:302,Dz:303,Wx:304,OA:305,gA:307,Ay:308,eo:400,AA:401,Lo:402,Kv:403,Sx:404,rx:405,Px:406,Py:407,dz:408,bv:409,Vv:410,Ww:411,Iy:412,az:413,ez:414,HA:415,cz:416,yv:417,GA:422,Zw:423,zv:424,Jy:428,jA:429,bz:431,Bo:500,Tx:501,ou:502,Kz:503,Qv:504,lw:505,yw:507,Gx:511,Sy:1223};var Js=function(a,c){Fb.call(this,c&&c.message||a.statusText);this.code=a.status;this.response=a;this.status=(this.b=c)&&c.status};q(Js,Fb);var uba=function(a){if(rba.has(a.code))return!0;var c=a.b||{};return a.b?sba.has(c.status)?!0:!!(c.errors||[]).find(function(b){return tba.has(b)}):!1},Ks=function(a,c){a=new Response(void 0,{status:c||408,statusText:a});return new Js(a)},rba=new Set([400,401,403,404,405,406,501]),sba=new Set(["PERMISSION_DENIED"]),tba=new Set("authError command_is_in_terminal_state forbidden notFound unmanaged_group_acl acl_entry_bad_scope network_error".split(" "));var W=function(){this.Rc=this.Rc;this.cb=this.cb};W.prototype.Rc=!1;W.prototype.w=function(){return this.Rc};W.prototype.fb=function(){this.Rc||(this.Rc=!0,this.ha())};W.prototype.b=function(a){Ls(this,db(Ms,a))};var Ls=function(a,c){a.Rc?Ha(void 0)?c.call(void 0):c():(a.cb||(a.cb=[]),a.cb.push(Ha(void 0)?t(c,void 0):c))};W.prototype.ha=function(){if(this.cb)for(;this.cb.length;)this.cb.shift()()};
var Ms=function(a){a&&"function"==typeof a.fb&&a.fb()},Ns=function(a){for(var c=0,b=arguments.length;c<b;++c){var d=arguments[c];Wa(d)?Ns.apply(null,d):Ms(d)}};var Os=function(){this.id="Ra"};Os.prototype.toString=function(){return this.id};var X=function(a,c){this.type=a instanceof Os?String(a):a;this.g=this.target=c;this.un=!0};X.prototype.h=function(){this.un=!1};var Ps=!Ee||9<=Number(Ze),vba=Ee&&!Ye("9"),wba=function(){if(!Ga.addEventListener||!Object.defineProperty)return!1;var a=!1,c=Object.defineProperty({},"passive",{get:function(){a=!0}});try{Ga.addEventListener("test",Qa,c),Ga.removeEventListener("test",Qa,c)}catch(b){}return a}();var Qs=function(a,c){X.call(this,a?a.type:"");this.relatedTarget=this.g=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.b=null;a&&this.init(a,c)};x(Qs,X);var xba=xf({2:"touch",3:"pen",4:"mouse"});
Qs.prototype.init=function(a,c){var b=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.g=c;(c=a.relatedTarget)?Ge&&(ye(c,"nodeName")||(c=null)):"mouseover"==b?c=a.fromElement:"mouseout"==b&&(c=a.toElement);this.relatedTarget=c;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:
a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=Ia(a.pointerType)?a.pointerType:xba[a.pointerType]||"";this.state=a.state;this.b=a;a.defaultPrevented&&this.h()};
Qs.prototype.h=function(){Qs.Xa.h.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,vba)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(c){}};var Rs="closure_listenable_"+(1E6*Math.random()|0),Ss=function(a){return!(!a||!a[Rs])},yba=0;var zba=function(a,c,b,d,e){this.listener=a;this.proxy=null;this.src=c;this.type=b;this.capture=!!d;this.Vc=e;this.key=++yba;this.removed=this.wh=!1},Ts=function(a){a.removed=!0;a.listener=null;a.proxy=null;a.src=null;a.Vc=null};var Us=function(a){this.src=a;this.b={};this.f=0};Us.prototype.add=function(a,c,b,d,e){var f=a.toString();a=this.b[f];a||(a=this.b[f]=[],this.f++);var g=Vs(a,c,d,e);-1<g?(c=a[g],b||(c.wh=!1)):(c=new zba(c,this.src,f,!!d,e),c.wh=b,a.push(c));return c};Us.prototype.remove=function(a,c,b,d){a=a.toString();if(!(a in this.b))return!1;var e=this.b[a];c=Vs(e,c,b,d);return-1<c?(Ts(e[c]),bc(e,c),0==e.length&&(delete this.b[a],this.f--),!0):!1};
var Ws=function(a,c){var b=c.type;if(!(b in a.b))return!1;var d=cc(a.b[b],c);d&&(Ts(c),0==a.b[b].length&&(delete a.b[b],a.f--));return d};Us.prototype.removeAll=function(a){a=a&&a.toString();var c=0,b;for(b in this.b)if(!a||b==a){for(var d=this.b[b],e=0;e<d.length;e++)++c,Ts(d[e]);delete this.b[b];this.f--}return c};var Xs=function(a,c,b,d,e){a=a.b[c.toString()];c=-1;a&&(c=Vs(a,b,d,e));return-1<c?a[c]:null};
Us.prototype.hasListener=function(a,c){var b=Ha(a),d=b?a.toString():"",e=Ha(c);return Ec(this.b,function(f){for(var g=0;g<f.length;++g)if(!(b&&f[g].type!=d||e&&f[g].capture!=c))return!0;return!1})};var Vs=function(a,c,b,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.listener==c&&f.capture==!!b&&f.Vc==d)return e}return-1};var Ys="closure_lm_"+(1E6*Math.random()|0),Zs={},$s=0,bt=function(a,c,b,d,e){if(d&&d.once)return at(a,c,b,d,e);if(Va(c)){for(var f=0;f<c.length;f++)bt(a,c[f],b,d,e);return null}b=ct(b);return Ss(a)?a.listen(c,b,Ya(d)?!!d.capture:!!d,e):dt(a,c,b,!1,d,e)},dt=function(a,c,b,d,e,f){if(!c)throw Error("Invalid event type");var g=Ya(e)?!!e.capture:!!e,k=et(a);k||(a[Ys]=k=new Us(a));b=k.add(c,b,d,g,f);if(b.proxy)return b;d=Aba();b.proxy=d;d.src=a;d.listener=b;if(a.addEventListener)wba||(e=g),void 0===e&&
(e=!1),a.addEventListener(c.toString(),d,e);else if(a.attachEvent)a.attachEvent(ft(c.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");$s++;return b},Aba=function(){var a=Bba,c=Ps?function(b){return a.call(c.src,c.listener,b)}:function(b){b=a.call(c.src,c.listener,b);if(!b)return b};return c},at=function(a,c,b,d,e){if(Va(c)){for(var f=0;f<c.length;f++)at(a,c[f],b,d,e);return null}b=ct(b);return Ss(a)?gt(a,
c,b,Ya(d)?!!d.capture:!!d,e):dt(a,c,b,!0,d,e)},ht=function(a,c,b,d,e){if(Va(c))for(var f=0;f<c.length;f++)ht(a,c[f],b,d,e);else d=Ya(d)?!!d.capture:!!d,b=ct(b),Ss(a)?a.K.remove(String(c),b,d,e):a&&(a=et(a))&&(c=Xs(a,c,b,d,e))&&it(c)},it=function(a){if(r(a)||!a||a.removed)return!1;var c=a.src;if(Ss(c))return Ws(c.K,a);var b=a.type,d=a.proxy;c.removeEventListener?c.removeEventListener(b,d,a.capture):c.detachEvent?c.detachEvent(ft(b),d):c.addListener&&c.removeListener&&c.removeListener(d);$s--;(b=et(c))?
(Ws(b,a),0==b.f&&(b.src=null,c[Ys]=null)):Ts(a);return!0},jt=function(a){if(a)if(Ss(a))a.ck(void 0);else if(a=et(a)){var c=0,b;for(b in a.b)for(var d=a.b[b].concat(),e=0;e<d.length;++e)it(d[e])&&++c}},ft=function(a){return a in Zs?Zs[a]:Zs[a]="on"+a},lt=function(a,c,b,d){var e=!0;if(a=et(a))if(c=a.b[c.toString()])for(c=c.concat(),a=0;a<c.length;a++){var f=c[a];f&&f.capture==b&&!f.removed&&(f=kt(f,d),e=e&&!1!==f)}return e},kt=function(a,c){var b=a.listener,d=a.Vc||a.src;a.wh&&it(a);return b.call(d,
c)},Bba=function(a,c){if(a.removed)return!0;if(!Ps){var b=c||Pa("window.event");c=new Qs(b,this);var d=!0;if(!(0>b.keyCode||void 0!=b.returnValue)){a:{var e=!1;if(0==b.keyCode)try{b.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==b.returnValue)b.returnValue=!0}b=[];for(e=c.g;e;e=e.parentNode)b.push(e);a=a.type;for(e=b.length-1;0<=e;e--){c.g=b[e];var f=lt(b[e],a,!0,c);d=d&&f}for(e=0;e<b.length;e++)c.g=b[e],f=lt(b[e],a,!1,c),d=d&&f}return d}return kt(a,new Qs(c,this))},et=function(a){a=a[Ys];return a instanceof
Us?a:null},mt="__closure_events_fn_"+(1E9*Math.random()>>>0),ct=function(a){if(Xa(a))return a;a[mt]||(a[mt]=function(c){return a.handleEvent(c)});return a[mt]};var nt=function(){W.call(this);this.K=new Us(this);this.vf=this;this.D=null};x(nt,W);nt.prototype[Rs]=!0;h=nt.prototype;h.addEventListener=function(a,c,b,d){bt(this,a,c,b,d)};h.removeEventListener=function(a,c,b,d){ht(this,a,c,b,d)};
h.M=function(a){var c,b=this.D;if(b)for(c=[];b;b=b.D)c.push(b);b=this.vf;var d=a.type||a;if(Ia(a))a=new X(a,b);else if(a instanceof X)a.target=a.target||b;else{var e=a;a=new X(d,b);Sc(a,e)}e=!0;if(c)for(var f=c.length-1;0<=f;f--){var g=a.g=c[f];e=g.Nf(d,!0,a)&&e}g=a.g=b;e=g.Nf(d,!0,a)&&e;e=g.Nf(d,!1,a)&&e;if(c)for(f=0;f<c.length;f++)g=a.g=c[f],e=g.Nf(d,!1,a)&&e;return e};h.ha=function(){nt.Xa.ha.call(this);this.ck();this.D=null};h.listen=function(a,c,b,d){return this.K.add(String(a),c,!1,b,d)};
var gt=function(a,c,b,d,e){return a.K.add(String(c),b,!0,d,e)};nt.prototype.ck=function(a){this.K&&this.K.removeAll(a)};nt.prototype.Nf=function(a,c,b){a=this.K.b[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.removed&&f.capture==c){var g=f.listener,k=f.Vc||f.src;f.wh&&Ws(this.K,f);d=!1!==g.call(k,b)&&d}}return d&&0!=b.un};nt.prototype.hasListener=function(a,c){return this.K.hasListener(Ha(a)?String(a):void 0,c)};var ot=function(a,c){this.g=a;this.h=c;this.f=0;this.b=null};ot.prototype.get=function(){if(0<this.f){this.f--;var a=this.b;this.b=a.next;a.next=null}else a=this.g();return a};var pt=function(a,c){a.h(c);100>a.f&&(a.f++,c.next=a.b,a.b=c)};var qt=function(a){Ga.setTimeout(function(){throw a;},0)},rt,Cba=function(){var a=Ga.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!ce("Presto")&&(a=function(){var e=document.createElement("IFRAME");e.style.display="none";oe(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(he(je));e.close();var g="callImmediate"+Math.random(),k="file:"==f.location.protocol?"*":f.location.protocol+"//"+
f.location.host;e=t(function(m){if(("*"==k||m.origin==k)&&m.data==g)this.port1.onmessage()},this);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,k)}}});if("undefined"!==typeof a&&!ce("Trident")&&!ce("MSIE")){var c=new a,b={},d=b;c.port1.onmessage=function(){if(Ha(b.next)){b=b.next;var e=b.Fl;b.Fl=null;e()}};return function(e){d.next={Fl:e};d=d.next;c.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?
function(e){var f=document.createElement("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;f.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){Ga.setTimeout(e,0)}};var st=function(){this.f=this.b=null},ut=new ot(function(){return new tt},function(a){a.reset()});st.prototype.add=function(a,c){var b=ut.get();b.set(a,c);this.f?this.f.next=b:this.b=b;this.f=b};st.prototype.remove=function(){var a=null;this.b&&(a=this.b,this.b=this.b.next,this.b||(this.f=null),a.next=null);return a};var tt=function(){this.next=this.scope=this.b=null};tt.prototype.set=function(a,c){this.b=a;this.scope=c;this.next=null};tt.prototype.reset=function(){this.next=this.scope=this.b=null};var yt=function(a,c){vt||Dba();wt||(vt(),wt=!0);xt.add(a,c)},vt,Dba=function(){if(Ga.Promise&&Ga.Promise.resolve){var a=Ga.Promise.resolve(void 0);vt=function(){a.then(zt)}}else vt=function(){var c=zt;!Xa(Ga.setImmediate)||Ga.Window&&Ga.Window.prototype&&!ce("Edge")&&Ga.Window.prototype.setImmediate==Ga.setImmediate?(rt||(rt=Cba()),rt(c)):Ga.setImmediate(c)}},wt=!1,xt=new st,zt=function(){for(var a;a=xt.remove();){try{a.b.call(a.scope)}catch(c){qt(c)}pt(ut,a)}wt=!1};var At=function(a){a.prototype.$goog_Thenable=!0},Bt=function(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(c){return!1}};var Et=function(a,c){this.b=0;this.l=void 0;this.h=this.f=this.g=null;this.j=this.w=!1;if(a!=Qa)try{var b=this;a.call(c,function(d){Ct(b,2,d)},function(d){if(!(d instanceof Dt))try{if(d instanceof Error)throw d;throw Error("Promise rejected.");}catch(e){}Ct(b,3,d)})}catch(d){Ct(this,3,d)}},Ft=function(){this.next=this.context=this.f=this.h=this.b=null;this.g=!1};Ft.prototype.reset=function(){this.context=this.f=this.h=this.b=null;this.g=!1};
var Gt=new ot(function(){return new Ft},function(a){a.reset()}),Ht=function(a,c,b){var d=Gt.get();d.h=a;d.f=c;d.context=b;return d},It=function(a){if(a instanceof Et)return a;var c=new Et(Qa);Ct(c,2,a);return c},Jt=function(a){return new Et(function(c,b){b(a)})},Lt=function(a,c,b){Kt(a,c,b,null)||yt(db(c,a))},Mt=function(a){return new Et(function(c,b){a.length||c(void 0);for(var d=0,e;d<a.length;d++)e=a[d],Lt(e,c,b)})},Nt=function(a){return new Et(function(c,b){var d=a.length,e=[];if(d)for(var f=
function(p,u){d--;e[p]=u;0==d&&c(e)},g=function(p){b(p)},k=0,m;k<a.length;k++)m=a[k],Lt(m,db(f,k),g);else c(e)})},Ot=function(a){return new Et(function(c){var b=a.length,d=[];if(b)for(var e=function(k,m,p){b--;d[k]=m?{de:!0,value:p}:{de:!1,reason:p};0==b&&c(d)},f=0,g;f<a.length;f++)g=a[f],Lt(g,db(e,f,!0),db(e,f,!1));else c(d)})},Pt=function(){var a,c,b=new Et(function(d,e){a=d;c=e});return new Eba(b,a,c)};Et.prototype.then=function(a,c,b){return Qt(this,Xa(a)?a:null,Xa(c)?c:null,b)};At(Et);
var St=function(a,c,b){c=Ht(c,c,b);c.g=!0;Rt(a,c);return a},Tt=function(a,c){return Qt(a,null,c,void 0)};Et.prototype.cancel=function(a){0==this.b&&yt(function(){var c=new Dt(a);Ut(this,c)},this)};
var Ut=function(a,c){if(0==a.b)if(a.g){var b=a.g;if(b.f){for(var d=0,e=null,f=null,g=b.f;g&&(g.g||(d++,g.b==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(0==b.b&&1==d?Ut(b,c):(f?(d=f,d.next==b.h&&(b.h=d),d.next=d.next.next):Vt(b),Wt(b,e,3,c)))}a.g=null}else Ct(a,3,c)},Rt=function(a,c){a.f||2!=a.b&&3!=a.b||Xt(a);a.h?a.h.next=c:a.f=c;a.h=c},Qt=function(a,c,b,d){var e=Ht(null,null,null);e.b=new Et(function(f,g){e.h=c?function(k){try{var m=c.call(d,k);f(m)}catch(p){g(p)}}:f;e.f=b?function(k){try{var m=b.call(d,
k);!Ha(m)&&k instanceof Dt?g(k):f(m)}catch(p){g(p)}}:g});e.b.g=a;Rt(a,e);return e.b};Et.prototype.u=function(a){this.b=0;Ct(this,2,a)};Et.prototype.D=function(a){this.b=0;Ct(this,3,a)};
var Ct=function(a,c,b){0==a.b&&(a===b&&(c=3,b=new TypeError("Promise cannot resolve to itself")),a.b=1,Kt(b,a.u,a.D,a)||(a.l=b,a.b=c,a.g=null,Xt(a),3!=c||b instanceof Dt||Fba(a,b)))},Kt=function(a,c,b,d){if(a instanceof Et)return Rt(a,Ht(c||Qa,b||null,d)),!0;if(Bt(a))return a.then(c,b,d),!0;if(Ya(a))try{var e=a.then;if(Xa(e))return Gba(a,e,c,b,d),!0}catch(f){return b.call(d,f),!0}return!1},Gba=function(a,c,b,d,e){var f=!1,g=function(m){f||(f=!0,b.call(e,m))},k=function(m){f||(f=!0,d.call(e,m))};try{c.call(a,
g,k)}catch(m){k(m)}},Xt=function(a){a.w||(a.w=!0,yt(a.o,a))},Vt=function(a){var c=null;a.f&&(c=a.f,a.f=c.next,c.next=null);a.f||(a.h=null);return c};Et.prototype.o=function(){for(var a;a=Vt(this);)Wt(this,a,this.b,this.l);this.w=!1};
var Wt=function(a,c,b,d){if(3==b&&c.f&&!c.g)for(;a&&a.j;a=a.g)a.j=!1;if(c.b)c.b.g=null,Yt(c,b,d);else try{c.g?c.h.call(c.context):Yt(c,b,d)}catch(e){Zt.call(null,e)}pt(Gt,c)},Yt=function(a,c,b){2==c?a.h.call(a.context,b):a.f&&a.f.call(a.context,b)},Fba=function(a,c){a.j=!0;yt(function(){a.j&&Zt.call(null,c)})},Zt=qt,Dt=function(a){Fb.call(this,a)};x(Dt,Fb);Dt.prototype.name="cancel";var Eba=function(a,c,b){this.Y=a;this.resolve=c;this.reject=b};var $t=function(a,c){nt.call(this);this.h=a||1;this.g=c||Ga;this.j=t(this.o,this);this.l=v()};x($t,nt);$t.prototype.enabled=!1;$t.prototype.f=null;var au=function(a,c){a.h=c;a.f&&a.enabled?(a.stop(),a.start()):a.f&&a.stop()};$t.prototype.o=function(){if(this.enabled){var a=v()-this.l;0<a&&a<.8*this.h?this.f=this.g.setTimeout(this.j,this.h-a):(this.f&&(this.g.clearTimeout(this.f),this.f=null),this.M("tick"),this.enabled&&(this.stop(),this.start()))}};
$t.prototype.start=function(){this.enabled=!0;this.f||(this.f=this.g.setTimeout(this.j,this.h),this.l=v())};$t.prototype.stop=function(){this.enabled=!1;this.f&&(this.g.clearTimeout(this.f),this.f=null)};$t.prototype.ha=function(){$t.Xa.ha.call(this);this.stop();delete this.g};
var bu=function(a,c,b){if(Xa(a))b&&(a=t(a,b));else if(a&&"function"==typeof a.handleEvent)a=t(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:Ga.setTimeout(a,c||0)},cu=function(a){Ga.clearTimeout(a)},du=function(a){var c=null;return Tt(new Et(function(b,d){c=bu(function(){b(void 0)},a);-1==c&&d(Error("Failed to schedule timer."))}),function(b){cu(c);throw b;})};var eu=function(){var a=void 0===a?!0:a;this.m=Of("mr.cloud.slarti.Fetcher");this.b=0;this.f=a};eu.prototype.execute=function(a){var c=this,b="Fetch call "+ ++this.b,d=new gf(function(){return Hba(c,b,a,function(e){return d.abort(e)})},1E3,this.f?5:1);return d.start()};
var Hba=function(a,c,b,d){var e=b.uri.toString().replace(/\?.*/,"?<redacted>"),f=b.method+" "+e;B(a.m,c+": "+f);e=[pba(b).then(function(g){return Promise.resolve(fetch(g))})];b.ih&&e.push(du(b.ih).then(function(){throw Ks("API call timed out",504);}));return Promise.race(e).then(function(g){if(!g.ok)return g.json().then(function(m){return m},function(){return null}).then(function(m){var p;m&&m instanceof Object&&m.error&&(p=m.error);throw new Js(g,p);});var k=(v()-b.start)/1E3;B(a.m,c+" succeeded: "+
f+" duration = "+k+"s");return(k=g.headers.get("content-type"))&&k.includes("application/json")?g.json():k&&(k.includes("image")||k.includes("application/octet-stream"))?g.blob():g.text()},function(g){var k="";if(g instanceof Js)k=", ("+g.status+"): "+g.message,uba(g)&&d(g);else{try{k=", "+JSON.stringify(g,null,2)}catch(m){}g instanceof Error&&"Failed to fetch"==g.message&&(g=Ks(g.message))}Qf(a.m,c+" failed: "+k);throw g;})};var fu=function(a,c){this.b=Raa.b;this.ob=a;this.f=c};var gu=function(a,c){fu.call(this,a,c)};q(gu,fu);gu.prototype.register=function(a){a=new Is({method:"POST",baseUrl:this.b,Lc:["user:register"],ob:this.ob,body:{gcmId:a}});return this.f.execute(a)};gu.prototype.unregister=function(a){a=new Is({method:"POST",baseUrl:this.b,Lc:["user:unregister"],ob:this.ob,body:{gcmId:a}});return this.f.execute(a)};var Iba=function(a,c,b){this.m=hb("mr.cloud.slarti.GcmRegistration");this.g=a;this.f=c;this.h=b;this.b=null},Jba=function(a){if(!a.b){var c=a.f["mr.cloud.slarti.GcmRegistration.ID"];a.b=a.h.register(["307539924703"]).then(function(b){if(b==c)ob(a.m,"Slarti GCM ID unchanged: "+b);else return ob(a.m,"Got new Slarti GCM ID: "+b),(c?hu(a,c):Promise.resolve()).then(function(){return a.g.register(b).then(function(){a.f["mr.cloud.slarti.GcmRegistration.ID"]=b})})},function(b){a.m.H("Error registering for GCM notifications",
b);c&&hu(a,c).catch(function(d){a.m.H("Failed to unregister GCM ID with Slarti",d)});throw b;});a.b.then(function(){a.b=null},function(){a.b=null})}return a.b},hu=function(a,c){return a.g.unregister(c).then(function(){delete a.f["mr.cloud.slarti.GcmRegistration.ID"]},function(b){a.m.H("Failed to unregister GCM ID with Slarti",b)})};var iu=null,ju=function(){Hp.call(this,5,"mr.cloud.slarti.GcmEventListener","mr.cloud.slarti.SinkDiscoveryService",chrome.gcm.onMessage);this.m=hb("mr.cloud.slarti.GcmEventListener")};q(ju,Hp);ju.prototype.kh=function(a){if(a&&"307539924703"==a.from&&"object"==typeof a.data&&"string"==typeof a.data.data){var c=JSON.parse(a.data.data);a=c.type;c=c.id;if(a)return this.m.info("Received Slarti GCM notification: "+a+" ("+c+")"),!0}return!1};var ku=function(){null==iu&&(iu=new ju);return iu};var lu=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];d=a;b=l(b);for(var e=b.next();!e.done;e=b.next()){if(void 0==d||"object"!=typeof d)return;d=d[e.value]}return d};var mu=function(){Hp.call(this,5,"cloud.GcmEventListener","mr.cloud.discovery.WeaveSinkDiscoveryService",chrome.gcm.onMessage);this.m=hb("mr.WeaveGcmEventListener")};q(mu,Hp);mu.prototype.kh=function(a){if(!a||"919648714761"!=a.from)return!1;a=lu(a,"data","notification");if(!a)return this.m.error("Notification json not found"),!1;try{var c=JSON.parse(a);return!!c&&Array.isArray(c.events)&&0<c.events.length}catch(b){return this.m.error("Invalid json: "+a),!1}};
var ou=function(){nu||(nu=new mu);return nu},nu=null;var pu=function(a){this.b=a;this.m=hb("mr.cloud.messaging.WeaveGcmMessageHandler")};pu.prototype.onMessage=function(a){var c=this;a=JSON.parse(a.data.notification);var b=Bm();a.events.forEach(function(d){if(d.deviceId){var e=Cm(b,d.deviceId);switch(d.type){case "deviceCreated":Kba(c,d);break;case "deviceUpdated":Lba(c,d,e);break;case "deviceDeleted":Mba(c.b,{sinkId:e});break;default:ob(c.m,function(){return"[unhandled event] "+JSON.stringify(d)})}}else c.m.error("Device ID not provided")})};
var Kba=function(a,c){var b=lu(c,"statePatch","_cloudCast","settings","receiverName");"string"!=typeof b?a.m.error("Receiver name not a string: "+b):(c=new ss(c.deviceId,b,"owner","default",!0),a=a.b,a.b.b.set(c.id,c),a.b.f=Date.now(),ws(a.f,[c.ub]))},Lba=function(a,c,b){c=lu(c,"statePatch","_cloudCast","appStatus");if("string"!=typeof c)a.m.error("App status not a string: "+c);else if(a=a.b,c="available"==c,b=a.b.qa(b))b.isAvailable=c||!1,a.b.f=Date.now(),xs(a.f,[b.ub])};var qu=function(a,c){this.g=a;this.f=c;this.b=new vs(this.Br.bind(this),c,2E4);this.h=new pu(this);ou().addListener();hm(this);cj("mr.cloud.discovery.WeaveSinkDiscoveryService",this)};q(qu,Si);h=qu.prototype;h.ie=function(){var a=this;eba(this.g).then(function(c){a.g.subscribe(c)}).catch(function(){});return this.b.ie().filter(function(c){return c.isAvailable})};h.qa=function(a){return this.b.qa(a)};
h.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(a==chrome.gcm.onMessage)this.h.onMessage.apply(this.h,n(b));else throw Error("Unhandled event: expected chrome.gcm.onMessage");};h.Br=function(){return cba(this.g).then(function(a){return a.map(function(c){Cb("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var b=c.isAvailable()&&!(c.b.invitations&&0!=c.b.invitations.length);return new ss(c.getId(),c.f(),c.b.personalizedInfo.maxRole,"default",b)})},function(){})};
h.Fa=function(){return"WeaveSinkDiscoveryService"};h.rb=function(){return[{cache:zs(this.b)}]};h.pb=function(){var a=em(this);a&&As(this.b,a.cache)};var Mba=function(a,c){if(c=a.b.qa(c.sinkId))a.b.b.delete(c.id),a.b.f=Date.now(),ys(a.f,[c.ub])};var ru=Ga.JSON.parse,su=Ga.JSON.stringify;var tu=function(a,c,b,d,e,f,g,k,m){W.call(this);this.f=null;this.C=!1;this.D=Pt();this.g=[];this.u=a?encodeURIComponent(String(a)):null;this.F=null;!d&&c&&(this.F=c);this.J=b||null;this.h=!d;this.j=null!=e?e:null;this.o=f||null;this.N=!!g;this.K=k||null;this.l=null!=m?m:null};q(tu,W);tu.prototype.init=function(){var a=t(function(b){this.f=b;var d=Pa("auth",b);Pa("client.request",b)&&d?this.G():b.load("client",t(this.G,this))},this),c=uu("gapi");c?a(c.gapi):Nba(this,a);return this.D.Y};
var uu=function(a){for(var c=window,b=Pa(a,c);!b&&c!=window.top&&Oba(c.parent,a);)c=c.parent,b=Pa(a,c);return b?c:null},Oba=function(a,c){try{return!!a&&null!=a.location.href&&ye(a,c)}catch(b){return!1}},Nba=function(a,c){var b=uu("gapi_onload");if(b){var d=b.gapi_onload;b.gapi_onload=function(){d();c(b.gapi)}}else{window.gapi_onload=function(){c(window.gapi)};var e=document.createElement("SCRIPT");pe(e,Pba);a.K&&dg(e,su(a.K));document.getElementsByTagName("head")[0].appendChild(e)}};
tu.prototype.G=function(){for(var a=0;a<this.g.length;a++)this.g[a].Cb.resolve(vu(this,this.g[a].requestData));this.C=!0;this.D.resolve(this.f)};tu.prototype.sendRequest=function(a){if(this.C)return vu(this,a);var c=Pt();this.g.push({requestData:a,Cb:c});return c.Y};
var vu=function(a,c){var b=Pa("config.get",a.f);if(!a.h){var d=b("googleapis.config/auth/useFirstPartyAuth");var e=b("googleapis.config/auth/useOriginToken")}var f;null!=a.j&&(f=b("client/cors"));var g;null!=a.l&&(g=b("client/xd4"));try{var k=Pa("config.update",a.f);a.h||(k("googleapis.config/auth/useFirstPartyAuth",!1),k("googleapis.config/auth/useOriginToken",!1));null!=a.j&&k("client/cors",a.j);null!=a.l&&k("client/xd4",a.l);var m=Qba(a);c.headers&&Sc(m,c.headers);var p={headers:m,root:a.J,path:c.path,
method:c.method,body:c.body},u=c.params||{};a.u&&!a.o?Sc(u,{key:a.u}):a.o&&Sc(u,{key:null});Mc(u)||(p.params=u);var A=It(Pa("client.request",a.f)(p));c.callback&&A.then(function(E){c.callback.apply(null,[E.result,E])},function(E){c.callback.apply(null,[E.result,E])});return A}finally{b=Pa("config.update",a.f),a.h||(b("googleapis.config/auth/useFirstPartyAuth",d),b("googleapis.config/auth/useOriginToken",e)),null!=a.j&&b("client/cors",f),null!=a.l&&b("client/xd4",g)}},Qba=function(a){if(a.h){if(a.o)return{Authorization:"Bearer "+
a.o};var c=Pa("auth.getAuthHeaderValueForFirstParty",a.f);return{Authorization:a.N?c([]):c(),"X-Goog-AuthUser":a.F}}return{}},Pba=kd(Xc(new Wc(Uc,"https://apis.google.com/js/client.js")));var Rba=function(a){this.b=a},hs=function(a,c,b){var d="";c.forEach(function(e){d+="/"+encodeURIComponent(e)});a=new Cr(a+d);b&&(b=Mr(b),Fr(a,b));return a},is=function(a,c,b,d){return a.b.getAuthToken().then(function(e){var f=Sba(e);return Tba(f,c,b,d).catch(function(g){if("INVALID_ACCESS_ERROR"==g)return Uba(a,e,c,b,d);throw g;})})},Uba=function(a,c,b,d,e){return nba(c).then(function(){return is(a,b,d,e)})},Tba=function(a,c,b,d){return new Promise(function(e,f){a.sendRequest(Vba(c,b,function(g){g&&
!g.error?e(g):g&&401==g.error.code?f("INVALID_ACCESS_ERROR"):f(g&&g.error?g.error.errors?g.error.errors[0]:g:Error(g))},d))})},Sba=function(a){a=new tu(void 0,void 0,void 0,!1,!1,a);a.init();return a},Vba=function(a,c,b,d){a={callback:b,method:c,path:a.toString()};d&&(a.body=d);return a};var wu={Yu:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},Xu:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},xu=wu;xu=wu;var yu={AED:[2,"dh","\u062f.\u0625."],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,
"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd",
"RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"\u20ba","TRY"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var zu={Fk:".",hi:",",Uk:"%",ni:"0",Mo:"+",Pk:"-",Jk:"E",Vk:"\u2030",ii:"\u221e",Ho:"NaN",mo:"#,##0.###",Bz:"#E0",zy:"#,##0%",lv:"\u00a4#,##0.00",Gk:"USD"},Au=zu;Au=zu;var Cu=function(){this.D=40;this.f=1;this.g=3;this.F=this.w=0;this.J=!1;this.C=this.o="";this.h=Au.Pk;this.u="";this.b=1;this.l=!1;this.j=[];this.K=this.G=!1;var a=Au.mo;a.replace(/ /g,"\u00a0");var c=[0];this.o=Bu(this,a,c);for(var b=c[0],d=-1,e=0,f=0,g=0,k=-1,m=a.length,p=!0;c[0]<m&&p;c[0]++)switch(a.charAt(c[0])){case "#":0<f?g++:e++;0<=k&&0>d&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>d&&k++;break;case ",":0<k&&this.j.push(k);k=0;break;case ".":if(0<=
d)throw Error('Multiple decimal separators in pattern "'+a+'"');d=e+f+g;break;case "E":if(this.K)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.K=!0;this.F=0;c[0]+1<m&&"+"==a.charAt(c[0]+1)&&(c[0]++,this.J=!0);for(;c[0]+1<m&&"0"==a.charAt(c[0]+1);)c[0]++,this.F++;if(1>e+f||1>this.F)throw Error('Malformed exponential pattern "'+a+'"');p=!1;break;default:c[0]--,p=!1}0==f&&0<e&&0<=d&&(f=d,0==f&&f++,g=e-f,e=f-1,f=1);if(0>d&&0<g||0<=d&&(d<e||d>e+f)||0==k)throw Error('Malformed pattern "'+
a+'"');g=e+f+g;this.g=0<=d?g-d:0;0<=d&&(this.w=e+f-d,0>this.w&&(this.w=0));this.f=(0<=d?d:g)-e;this.K&&(this.D=e+this.f,0==this.g&&0==this.f&&(this.f=1));this.j.push(Math.max(0,k));this.G=0==d||d==g;b=c[0]-b;this.C=Bu(this,a,c);c[0]<a.length&&";"==a.charAt(c[0])?(c[0]++,1!=this.b&&(this.l=!0),this.h=Bu(this,a,c),c[0]+=b,this.u=Bu(this,a,c)):(this.h+=this.o,this.u+=this.C)};
Cu.prototype.parse=function(a,c){c=c||[0];a=a.replace(/ |\u202f/g,"\u00a0");var b=a.indexOf(this.o,c[0])==c[0],d=a.indexOf(this.h,c[0])==c[0];b&&d&&(this.o.length>this.h.length?d=!1:this.o.length<this.h.length&&(b=!1));b?c[0]+=this.o.length:d&&(c[0]+=this.h.length);if(a.indexOf(Au.ii,c[0])==c[0]){c[0]+=Au.ii.length;var e=Infinity}else{e=a;var f=!1,g=!1,k=!1,m=-1,p=1,u=Au.Fk,A=Au.hi,E=Au.Jk;A=A.replace(/\u202f/g,"\u00a0");for(var F="";c[0]<e.length;c[0]++){var J=e.charAt(c[0]),V=Du(J);if(0<=V&&9>=
V)F+=V,k=!0;else if(J==u.charAt(0)){if(f||g)break;F+=".";f=!0}else if(J==A.charAt(0)&&("\u00a0"!=A.charAt(0)||c[0]+1<e.length&&0<=Du(e.charAt(c[0]+1)))){if(f||g)break}else if(J==E.charAt(0)){if(g)break;F+="E";g=!0;m=c[0]}else if("+"==J||"-"==J){if(k&&m!=c[0]-1)break;F+=J}else if(1==this.b&&J==Au.Uk.charAt(0)){if(1!=p)break;p=100;if(k){c[0]++;break}}else if(1==this.b&&J==Au.Vk.charAt(0)){if(1!=p)break;p=1E3;if(k){c[0]++;break}}else break}1!=this.b&&(p=this.b);e=parseFloat(F)/p}if(b){if(a.indexOf(this.C,
c[0])!=c[0])return NaN;c[0]+=this.C.length}else if(d){if(a.indexOf(this.u,c[0])!=c[0])return NaN;c[0]+=this.u.length}return d?-e:e};
Cu.prototype.format=function(a){if(isNaN(a))return Au.Ho;var c=[];var b=Wba;a=Eu(a,-b.wq);c.push(b.prefix);var d=0>a||0==a&&0>1/a;c.push(d?this.h:this.o);if(isFinite(a))if(a=a*(d?-1:1)*this.b,this.K)if(0==a)Fu(this,a,this.f,c),Gu(this,0,c);else{var e=Math.floor(Math.log(a)/Math.log(10)+2E-15);a=Eu(a,-e);var f=this.f;1<this.D&&this.D>this.f?(f=e%this.D,0>f&&(f=this.D+f),a=Eu(a,f),e-=f,f=1):1>this.f?(e++,a=Eu(a,-1)):(e-=this.f-1,a=Eu(a,this.f-1));Fu(this,a,f,c);Gu(this,e,c)}else Fu(this,a,this.f,c);
else c.push(Au.ii);c.push(d?this.u:this.C);c.push(b.Ht);return c.join("")};
var Fu=function(a,c,b,d){if(a.w>a.g)throw Error("Min value must be less than max value");d||(d=[]);var e=Eu(c,a.g);e=Math.round(e);if(isFinite(e)){c=Math.floor(Eu(e,-a.g));var f=Math.floor(e-Eu(c,a.g))}else f=0;e=c;c=f;var g=e;f=c;var k=0<a.w||0<f||!1;e=a.w;k&&(e=a.w);var m="";for(c=g;1E20<c;)m="0"+m,c=Math.round(Eu(c,-1));m=c+m;var p=Au.Fk;c=Au.ni.charCodeAt(0);var u=m.length,A=0;if(0<g||0<b){for(g=u;g<b;g++)d.push(String.fromCharCode(c));if(2<=a.j.length)for(b=1;b<a.j.length;b++)A+=a.j[b];b=u-A;
if(0<b){g=a.j;A=u=0;for(var E,F=Au.hi,J=m.length,V=0;V<J;V++)if(d.push(String.fromCharCode(c+1*Number(m.charAt(V)))),1<J-V)if(E=g[A],V<b){var Ka=b-V;(1===E||0<E&&1===Ka%E)&&d.push(F)}else A<g.length&&(V===b?A+=1:E===V-b-u+1&&(d.push(F),u+=E,A+=1))}else{b=m;m=a.j;g=Au.hi;E=b.length;F=[];for(u=m.length-1;0<=u&&0<E;u--){A=m[u];for(J=0;J<A&&0<=E-J-1;J++)F.push(String.fromCharCode(c+1*Number(b.charAt(E-J-1))));E-=A;0<E&&F.push(g)}d.push.apply(d,F.reverse())}}else k||d.push(String.fromCharCode(c));(a.G||
k)&&d.push(p);k=String(f);f=k.split("e+");if(2==f.length){if(k=parseFloat(f[0])){p=k;if(isFinite(p)){for(b=0;1<=(p/=10);)b++;p=b}else p=0<p?p:0;p=0-p-1;k=-1>p?k&&isFinite(k)?Eu(Math.round(Eu(k,-1)),1):k:k&&isFinite(k)?Eu(Math.round(Eu(k,p)),-p):k}k=String(k);k=k.replace(".","");k+=qe("0",parseInt(f[1],10)-k.length+1)}a.g+1>k.length&&(k="1"+qe("0",a.g-k.length)+k);for(a=k.length;"0"==k.charAt(a-1)&&a>e+1;)a--;for(g=1;g<a;g++)d.push(String.fromCharCode(c+1*Number(k.charAt(g))))},Gu=function(a,c,b){b.push(Au.Jk);
0>c?(c=-c,b.push(Au.Pk)):a.J&&b.push(Au.Mo);c=""+c;for(var d=Au.ni,e=c.length;e<a.F;e++)b.push(d);b.push(c)},Du=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var c=Au.ni.charCodeAt(0);return c<=a&&a<c+10?a-c:-1},Bu=function(a,c,b){for(var d="",e=!1,f=c.length;b[0]<f;b[0]++){var g=c.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==c.charAt(b[0]+1)?(b[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return d;case "\u00a4":b[0]+1<f&&"\u00a4"==c.charAt(b[0]+
1)?(b[0]++,d+=Au.Gk):(g=Au.Gk,d+=g in yu?yu[g][1]:g);break;case "%":if(!a.l&&1!=a.b)throw Error("Too many percent/permill");if(a.l&&100!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=100;a.l=!1;d+=Au.Uk;break;case "\u2030":if(!a.l&&1!=a.b)throw Error("Too many percent/permill");if(a.l&&1E3!=a.b)throw Error("Inconsistent use of percent/permill characters");a.b=1E3;a.l=!1;d+=Au.Vk;break;default:d+=g}}return d},Wba={prefix:"",Ht:"",wq:0},Eu=function(a,c){if(!a||!isFinite(a)||
0==c)return a;a=String(a).split("e");return parseFloat(a[0]+"e"+(parseInt(a[1]||0,10)+c))};var Hu=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},Iu=Hu;Iu=Hu;var Ju=function(a,c){if(void 0===c){c=a+"";var b=c.indexOf(".");c=Math.min(-1==b?0:c.length-b-1,3)}return 1==(a|0)&&0==c?"one":"other"},Ku=Ju;Ku=Ju;var Ou=function(){this.h=Xba;this.f=this.b=this.j=null;var a=Au,c=xu;if(Lu!==a||Mu!==c)Lu=a,Mu=c,Nu=new Cu;this.w=Nu},Lu=null,Mu=null,Nu=null,Yba=/'([{}#].*?)'/g,Zba=/''/g;Ou.prototype.format=function(a){if(this.h){this.j=[];var c=$ba(this,this.h);this.f=Pu(this,c);this.h=null}if(this.f&&0!=this.f.length)for(this.b=y(this.j),c=[],Qu(this,this.f,a,!1,c),a=c.join("");0<this.b.length;)a=a.replace(this.g(this.b),this.b.pop());else a="";return a};
var Qu=function(a,c,b,d,e){for(var f=0;f<c.length;f++)switch(c[f].type){case 4:e.push(c[f].value);break;case 3:var g=c[f].value,k=a,m=e,p=b[g];Ha(p)?(k.b.push(p),m.push(k.g(k.b))):m.push("Undefined parameter - "+g);break;case 2:g=c[f].value;k=e;m=g.vh;Ha(b[m])?(m=g[b[m]],Ha(m)||(m=g.other),Qu(a,m,b,d,k)):k.push("Undefined parameter - "+m);break;case 0:g=c[f].value;Ru(a,g,b,Ku,d,e);break;case 1:g=c[f].value;Ru(a,g,b,Iu,d,e);break;default:Ib("Unrecognized block type: "+c[f].type)}},Ru=function(a,c,
b,d,e,f){var g=c.vh,k=c.ul,m=+b[g];isNaN(m)?f.push("Undefined or invalid parameter - "+g):(k=m-k,g=c[b[g]],Ha(g)||(d=d(k),g=c[d],Ha(g)||(g=c.other)),c=[],Qu(a,g,b,e,c),b=c.join(""),e?f.push(b):(a=a.w.format(k),f.push(b.replace(/#/g,a))))},$ba=function(a,c){var b=a.j,d=t(a.g,a);c=c.replace(Zba,function(){b.push("'");return d(b)});return c=c.replace(Yba,function(e,f){b.push(f);return d(b)})},Su=function(a){var c=0,b=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(b.pop(),
0==b.length&&(f={type:1},f.value=a.substring(c,g),d.push(f),c=g+1)):(0==b.length&&(c=a.substring(c,g),""!=c&&d.push({type:0,value:c}),c=g+1),b.push("{"))}c=a.substring(c);""!=c&&d.push({type:0,value:c});return d},Tu=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Uu=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Vu=/^\s*(\w+)\s*,\s*select\s*,/,Pu=function(a,c){var b=[];c=Su(c);for(var d=0;d<c.length;d++){var e={};if(0==c[d].type)e.type=4,e.value=c[d].value;else if(1==c[d].type){var f=c[d].value;switch(Tu.test(f)?
0:Uu.test(f)?1:Vu.test(f)?2:/^\s*\w+\s*/.test(f)?3:5){case 2:e.type=2;e.value=aca(a,c[d].value);break;case 0:e.type=0;e.value=bca(a,c[d].value);break;case 1:e.type=1;e.value=cca(a,c[d].value);break;case 3:e.type=3;e.value=c[d].value;break;default:Ib("Unknown block type for pattern: "+c[d].value)}}else Ib("Unknown part of the pattern.");b.push(e)}return b},aca=function(a,c){var b="";c=c.replace(Vu,function(k,m){b=m;return""});var d={};d.vh=b;c=Su(c);for(var e=0;e<c.length;){var f=c[e].value;e++;var g;
1==c[e].type?g=Pu(a,c[e].value):Ib("Expected block type.");d[f.replace(/\s/g,"")]=g;e++}return d},bca=function(a,c){var b="",d=0;c=c.replace(Tu,function(m,p,u){b=p;u&&(d=parseInt(u,10));return""});var e={};e.vh=b;e.ul=d;c=Su(c);for(var f=0;f<c.length;){var g=c[f].value;f++;var k;1==c[f].type?k=Pu(a,c[f].value):Ib("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e},cca=function(a,c){var b="";c=c.replace(Uu,function(k,m){b=m;return""});var d={};d.vh=b;d.ul=0;c=Su(c);for(var e=
0;e<c.length;){var f=c[e].value;e++;if(1==c[e].type)var g=Pu(a,c[e].value);else Ib("Expected block type.");d[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return d};Ou.prototype.g=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var Wu=chrome.i18n.getMessage("1522140683318860351"),Xu=chrome.i18n.getMessage("4246483347873264186"),Yu=chrome.i18n.getMessage("5991427458288444010"),pi=chrome.i18n.getMessage("6063910461797960050"),dca=chrome.i18n.getMessage("7735695102441495789"),eca=chrome.i18n.getMessage("4575332923598659024"),Xba=chrome.i18n.getMessage("2297080986956220930"),Zu=new Ou;var fca=function(a){this.b=a;this.m=hb("mr.cloud.mesi.MesiService")},kba=function(a){var c=hs(Taa.b,["hangouts","search"]);a.m.info("Retrieving Hangouts from MESI: "+c);return is(a.b,c,"POST",gca).then(function(b){var d=[];b.result&&(d=b.result.map(function(e){var f=e.hangout,g=f.meeting_room_name,k;f.meeting_domain?k=f.meeting_domain:"BUSINESS"==f.type&&f.company_title&&(k=f.company_title.toLowerCase());var m=Zu.format({ORGANIZER:"",PARTICIPANTS:0});if((e=e.participant)&&0<e.length){var p=e[0].display_name;
m=e.reduce(function(u,A){u.add(A.user_id);"ORGANIZER"==A.role&&(p=A.display_name);return u},new Set);m=Zu.format({ORGANIZER:p,PARTICIPANTS:m.size})}return g&&k?new es(!1,g+"@"+k,k,g,m,f.hangout_id):new es(!1,f.hangout_id,k,g,m,f.hangout_id)}));return d})},gca={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var hca=function(a,c){this.f=a;this.b=c},ica=function(a,c,b,d){switch(c.type){case "REFRESH_AUTH":var e=d.Kd,f=d.deviceId,g=d.hh;return oba(a.f).then(function(){$u(a.b,new Dj("AUTH_READY",{Kd:e,ib:f,hh:g}),b.id)});case "STATUS_REQUEST":return $u(a.b,c,b.id),Promise.resolve();case "STATUS_RESPONSE":return $u(a.b,c,b.id,!0),c.data.routeDescription||$u(a.b,c,b.id),Promise.resolve();case "HANGOUT_INACTIVE":return av(a.b,b,4,ti(new oi(dca,"warning"),b.sinkId));case "HANGOUT_INVALID":return av(a.b,b,3,
ti(new oi(eca,"warning"),b.sinkId));default:return Promise.reject(Error("Unknown type: "+c.type))}};var bv=new Map([["status","status"],["results","result"],["expirationTime","expiration_time"]]),cv=function(a,c){fu.call(this,a,c);this.m=Of("mr.cloud.slarti.CommandsService")};q(cv,fu);cv.prototype.get=function(a){a=new Is({method:"GET",baseUrl:this.b,Lc:["commands",a],ob:this.ob});return this.f.execute(a).then(function(c){return c})};
cv.prototype.list=function(a){a=new Is({method:"GET",baseUrl:this.b,Lc:["commands"],nn:{deviceId:a},ob:this.ob});return this.f.execute(a).then(function(c){return c.command||[]})};cv.prototype.send=function(a,c){var b=this;a=new Is({method:"POST",baseUrl:this.b,Lc:["commands:send"],ob:this.ob,body:{command:c,deviceId:a}});return this.f.execute(a).then(function(d){b.m.info("Sent Slarti command with ID "+d.id);return d})};
cv.prototype.update=function(a,c){for(var b=[],d={},e=l(bv.keys()),f=e.next();!f.done;f=e.next())f=f.value,c[f]&&(d[f]=c[f],b.push(bv.get(f)));d.id=a;a=new Is({method:"PUT",baseUrl:this.b,Lc:["commands",a],ob:this.ob,body:{command:d,updateMask:b}});return this.f.execute(a).then(function(g){return g})};var jca=Ga.JSON.parse;var dv=function(){};dv.prototype.b=null;dv.prototype.getOptions=function(){var a;(a=this.b)||(a={},ev(this)&&(a[0]=!0,a[1]=!0),a=this.b=a);return a};var fv,gv=function(){};x(gv,dv);var hv=function(a){return(a=ev(a))?new ActiveXObject(a):new XMLHttpRequest},ev=function(a){if(!a.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var c=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],b=0;b<c.length;b++){var d=c[b];try{return new ActiveXObject(d),a.f=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.f};fv=new gv;var iv=function(a){nt.call(this);this.headers=new Qm;this.V=a||null;this.g=!1;this.T=this.f=null;this.ja=this.J="";this.o=0;this.h="";this.j=this.ea=this.G=this.da=!1;this.l=0;this.C=null;this.u="";this.N=this.F=!1};x(iv,nt);iv.prototype.m=Of("goog.net.XhrIo");var kca=/^https?$/i,lca=["POST","PUT"],jv=[],kv=function(a,c,b,d,e,f,g){var k=new iv;jv.push(k);c&&k.listen("complete",c);gt(k,"ready",k.ua);f&&(k.l=Math.max(0,f));g&&(k.F=g);k.send(a,b,d,e);return k};
iv.prototype.ua=function(){this.fb();cc(jv,this)};
iv.prototype.send=function(a,c,b,d){if(this.f)throw Error("[goog.net.XhrIo] Object is active with another request="+this.J+"; newUri="+a);c=c?c.toUpperCase():"GET";this.J=a;this.h="";this.o=0;this.ja=c;this.da=!1;this.g=!0;this.f=this.V?hv(this.V):hv(fv);this.T=this.V?this.V.getOptions():fv.getOptions();this.f.onreadystatechange=t(this.na,this);try{Rf(this.m,lv(this,"Opening Xhr")),this.ea=!0,this.f.open(c,String(a),!0),this.ea=!1}catch(f){Rf(this.m,lv(this,"Error opening Xhr: "+f.message));mv(this,
f);return}a=b||"";var e=this.headers.clone();d&&In(d,function(f,g){e.set(g,f)});d=Ub(e.Lb(),mca);b=Ga.FormData&&a instanceof Ga.FormData;!Wb(lca,c)||d||b||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");e.forEach(function(f,g){this.f.setRequestHeader(g,f)},this);this.u&&(this.f.responseType=this.u);"withCredentials"in this.f&&this.f.withCredentials!==this.F&&(this.f.withCredentials=this.F);try{nv(this),0<this.l&&(this.N=nca(this.f),Rf(this.m,lv(this,"Will abort after "+this.l+
"ms if incomplete, xhr2 "+this.N)),this.N?(this.f.timeout=this.l,this.f.ontimeout=t(this.ra,this)):this.C=bu(this.ra,this.l,this)),Rf(this.m,lv(this,"Sending request")),this.G=!0,this.f.send(a),this.G=!1}catch(f){Rf(this.m,lv(this,"Send error: "+f.message)),mv(this,f)}};var nca=function(a){return Ee&&Ye(9)&&r(a.timeout)&&Ha(a.ontimeout)},mca=function(a){return nd("Content-Type",a)};
iv.prototype.ra=function(){"undefined"!=typeof Ea&&this.f&&(this.h="Timed out after "+this.l+"ms, aborting",this.o=8,Rf(this.m,lv(this,this.h)),this.M("timeout"),this.abort(8))};var mv=function(a,c){a.g=!1;a.f&&(a.j=!0,a.f.abort(),a.j=!1);a.h=c;a.o=5;ov(a);pv(a)},ov=function(a){a.da||(a.da=!0,a.M("complete"),a.M("error"))};iv.prototype.abort=function(a){this.f&&this.g&&(Rf(this.m,lv(this,"Aborting")),this.g=!1,this.j=!0,this.f.abort(),this.j=!1,this.o=a||7,this.M("complete"),this.M("abort"),pv(this))};
iv.prototype.ha=function(){this.f&&(this.g&&(this.g=!1,this.j=!0,this.f.abort(),this.j=!1),pv(this,!0));iv.Xa.ha.call(this)};iv.prototype.na=function(){this.w()||(this.ea||this.G||this.j?qv(this):this.va())};iv.prototype.va=function(){qv(this)};
var qv=function(a){if(a.g&&"undefined"!=typeof Ea)if(a.T[1]&&4==rv(a)&&2==a.Ya())Rf(a.m,lv(a,"Local request error detected and ignored"));else if(a.G&&4==rv(a))bu(a.na,0,a);else if(a.M("readystatechange"),4==rv(a)){Rf(a.m,lv(a,"Request complete"));a.g=!1;try{if(sv(a))a.M("complete"),a.M("success");else{a.o=6;try{var c=2<rv(a)?a.f.statusText:""}catch(b){Rf(a.m,"Can not get status: "+b.message),c=""}a.h=c+" ["+a.Ya()+"]";ov(a)}}finally{pv(a)}}},pv=function(a,c){if(a.f){nv(a);var b=a.f,d=a.T[0]?Qa:null;
a.f=null;a.T=null;c||a.M("ready");try{b.onreadystatechange=d}catch(e){Qf(a.m,"Problem encountered resetting onreadystatechange: "+e.message)}}},nv=function(a){a.f&&a.N&&(a.f.ontimeout=null);a.C&&(cu(a.C),a.C=null)},sv=function(a){var c=a.Ya();a:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break a;default:b=!1}if(!b){if(c=0===c)a=String(a.J).match(yr)[1]||null,!a&&Ga.self&&Ga.self.location&&(a=Ga.self.location.protocol,a=a.substr(0,a.length-1)),c=!kca.test(a?a.toLowerCase():
"");b=c}return b},rv=function(a){return a.f?a.f.readyState:0};iv.prototype.Ya=function(){try{return 2<rv(this)?this.f.status:-1}catch(a){return-1}};
var tv=function(a){try{return a.f?a.f.responseText:""}catch(c){return Rf(a.m,"Can not get responseText: "+c.message),""}},oca=function(a){if(a.f)return jca(a.f.responseText)},pca=function(a){try{if(!a.f)return null;if("response"in a.f)return a.f.response;switch(a.u){case "":case "text":return a.f.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.f)return a.f.mozResponseArrayBuffer}Qf(a.m,"Response type "+a.u+" is not supported on this browser");return null}catch(c){return Rf(a.m,"Can not get response: "+
c.message),null}};iv.prototype.getResponseHeader=function(a){if(this.f&&4==rv(this))return a=this.f.getResponseHeader(a),null===a?void 0:a};var qca=function(a){var c={};a=(a.f&&4==rv(a)?a.f.getAllResponseHeaders()||"":"").split("\r\n");for(var b=0;b<a.length;b++)if(!od(a[b])){var d=ve(a[b],":",1),e=d[0];d=d[1];if(Ia(d)){d=d.trim();var f=c[e]||[];c[e]=f;f.push(d)}}return Dc(c,function(g){return g.join(", ")})},lv=function(a,c){return c+" ["+a.ja+" "+a.J+" "+a.Ya()+"]"};var rca=function(){this.m=hb("mr.cloud.CredentialService")},uv=function(a){var c=new Eb,b=ds.b+"/iceconfig?key="+ds.f;a.m.info("Requesting TURN credentials from "+b);var d=kv(b,function(){sv(d)?(a.m.info("Got TURN credentials: "+tv(d)),c.resolve(sca(a,oca(d)))):c.resolve(tca(a))},"POST",void 0,{"Content-Type":"application/json"});return c.b},sca=function(a,c){try{var b=[];c.iceServers.forEach(function(d){d.urls.forEach(function(e){0==e.indexOf("turn:")&&b.push({url:e,credential:d.credential,username:d.username})})});
return b}catch(d){return a.m.error("Error parsing TURN credentials.",d),[]}},tca=function(a){a.m.error("XHR failed fetching TURN credentials.",null);return[]};var uca=function(a,c,b){this.m=hb("mr.cloud.slarti.MessageHandler");this.g=a;this.h=c;this.b=b;this.f=new Map},vca=function(a){if(hj(a.mediaSource))return Promise.resolve({title:"screen"});var c=a.wb&&a.wb.tabId;return null==c?Promise.resolve({title:"",url:""}):new Promise(function(b){chrome.tabs.get(c,function(d){b({title:d&&d.title||"",url:d&&d.url||""})})})},wca=function(a,c,b,d){var e=d.deviceId,f=c.data;return vca(b).then(function(g){g={id:null,issuer:null,name:"stream",status:null,results:null,
expirationTime:null,parameters:JSON.stringify({info:g,sessionDescription:f.description,mediaConstraints:f.mediaConstraints,settings:f.settings})};return a.g.send(e,g).then(function(k){return new Promise(function(m,p){a.f.set(k.id,{routeId:b.id,sinkId:d.id,resolve:m,reject:p,er:"PENDING_APPROVAL"==k.status})})},function(){av(a.b,b.id,7,ti(si(ri(new oi(Wu,"warning")),b.id),d.id))})})},xca=function(a,c){return uv(a.h).then(function(b){$u(a.b,new Dj("TURN_CREDENTIALS",{credentials:b}),c.id)})};var yca=function(a,c,b,d){this.f=a;this.g=c;this.h=b;this.b=d},Bca=function(a,c,b,d,e){return new Promise(function(f){switch(c){case "slarti":case "weave":case "mesi":break;default:throw Error("Unrecognized channel type: "+c);}if(!b.type)throw Error("Message has no type");switch(b.type){case "STOP":f(av(a.b,d,1,null));return;case "SESSION_START_SUCCESS":Zr(0);break;case "SESSION_END":break;case "SESSION_FAILURE":Zr(1);f(av(a.b,d,2,ti(new oi(Wu,"warning"),d?d.sinkId:"")));return;case "__webrtc_stats__":break;
case "PRESENTATION_CONNECTION_MESSAGE":$u(a.b,b.data,d.id,!0);break;case "OFFER":switch(c){case "slarti":f(wca(a.f,b,d,e));return;case "weave":f(zca(a.g,b,d,e));return;default:throw Error("Unexpected channel type: "+c);}case "GET_TURN_CREDENTIALS":switch(c){case "slarti":f(xca(a.f,d));return;case "weave":f(Aca(a.g,d));return;default:throw Error("Unexpected channel type: "+c);}case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":f(ica(a.h,
b,d,e));return;case "new_session":$u(a.b,b,d.id,!0);break;case "remove_session":$u(a.b,b,d.id,!0);a.b.terminateRoute(d.id);break;default:throw Error("Unknown type: "+b.type);}f()})};var vv=function(a,c,b){this.state=a;this.type=null!=c?c:null;this.results=null!=b?b:null},wv=function(a){this.b=a},Cca=function(a,c,b,d){return xv(a,$aa,c,b,d,35E3).then(function(e){return yv(a,e)})},Dca=function(a,c,b,d){return xv(a,aba,c,b,d,23E3).then(function(e){var f=e.state;return"done"==f?(e=zv(e),new vv(f,e.type,new ms(e.sessionDescription))):new vv(f)})},xv=function(a,c,b,d,e,f){var g={_webrtcMessage:JSON.stringify(d.presentationUrl?new ms(d.description,null,d.presentationUrl,d.presentationId):
new ms(d.description))};d.settings&&(g._settings=Aj(d.settings));d.mediaConstraints&&(g._optMediaConstraints=JSON.stringify(d.mediaConstraints));e&&(g._user=JSON.stringify(e));return Av(a,b,c,g,f)},yv=function(a,c){var b=c.state;switch(b){case "done":return Promise.resolve(Eca(c));case "queued":case "inProgress":return Fca(a,c).then(function(d){return yv(a,d)});default:return Promise.resolve(new vv(b))}},Fca=function(a,c){return new Promise(function(b){var d=setInterval(function(){Gca(a,c.id).then(function(e){"queued"!=
e.state&&"inProgress"!=e.state&&(clearInterval(d),b(e))})},2E3)})},Eca=function(a){a=zv(a);return"__cloud_webrtc_session_message__"==a.type?new vv("done","knocking_cloud_webrtc_session_message",new ms(a.sessionDescription)):new vv("done",a.type)},Av=function(a,c,b,d,e){c={deviceId:c,name:"_cloudCast."+b.name,parameters:d,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=hs(cs.b,["commands"],b);return is(a.b,e,"POST",c)},zv=function(a){return a.results&&a.results.results?
JSON.parse(a.results.results):null},Gca=function(a,c){c=hs(cs.b,["commands",c]);return is(a.b,c,"GET")};wv.$inject=["gapiService"];var Hca=function(a,c,b,d){this.f=a;this.g=c;this.h=b;this.b=d},zca=function(a,c,b,d){return Ica(a,c,d).then(function(e){a:{var f=b.id;if("done"!=e.state)f=Promise.reject(Error("Offer not executed by receiver. State: "+e.state));else{switch(e.type){case "__cloud_webrtc_session_message__":e=new Dj("ANSWER",e.results.sessionDescription);$u(a.b,e,f);break;case "knocking_cloud_webrtc_session_message":Yr(0);e=new Dj("KNOCK_ANSWER",e.results.sessionDescription);$u(a.b,e,f);break;case "knock_denied":Yr(1);
Bv(a,Xu,f);break;case "knock_timeout":Yr(2);Bv(a,Yu,f);break;default:f=Promise.reject(Error("Invalid message type: "+e.type));break a}f=Promise.resolve()}}return f})},Aca=function(a,c){return uv(a.h).then(function(b){$u(a.b,new Dj("TURN_CREDENTIALS",{credentials:b}),c.id)})},Ica=function(a,c,b){var d=b.deviceId,e=a.g.b;e=e?new Yaa(e):void 0;c=c.data;switch(b.vi){case "owner":as(0);break;case "manager":as(1);break;case "user":as(2);break;case "viewer":as(3)}return"viewer"==b.vi?Cca(a.f,d,c,e):Dca(a.f,
d,c,e)},Bv=function(a,c,b){c=new oi(c,"warning");ri(c);a.b.b.cf(c);$u(a.b,new Dj("STOP"),b)};var Jca=function(){var a=this;this.m=hb("mr.cloud.settings.SettingsService");this.b=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(c){fj(13);if(a.b){c=l(c);for(var b=c.next();!b.done;b=c.next())if(b=b.value,"media_router.cloudservices.enabled"==b.key){a.b.call(null,b.value);break}}})},Kca=function(a,c){a.b=c},Lca=function(a){var c=a.m;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&c.H("Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})},
Mca=function(a){return Cv().catch(function(){return Cv().catch(function(c){a.m.H("Error retrieving cloud on setting.",c);return!1})})},Cv=function(){return Dv("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})},Dv=function(a){return new Promise(function(c,b){chrome.storage.sync.get(a,function(d){chrome.runtime.lastError?b(chrome.runtime.lastError):c(d)})})},Nca=function(a){return Ev().catch(function(){return Ev().catch(function(c){a.m.H("Error retrieving cloud enabled setting.",
c);return!1})})},Ev=function(){return Oca().then(function(a){return!!a.value})},Oca=function(){return new Promise(function(a,c){chrome.settingsPrivate.getPref("media_router.cloudservices.enabled",function(b){chrome.runtime.lastError?c(chrome.runtime.lastError):a(b)})})},Pca=function(a){var c=a.m;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&c.H("Error setting notified Hangout privacy.",chrome.runtime.lastError)})},Qca=function(a){return Fv().catch(function(){return Fv().catch(function(c){a.m.H("Error retrieving hangouts notified setting.",
c);return!1})})},Fv=function(){return Dv("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var Gv=new Map([["displayName","display_name"],["description","description"],["type","type"],["status","status"],["state","state"],["commandDefs","command_defs"]]),Hv=function(a,c){fu.call(this,a,c)};q(Hv,fu);h=Hv.prototype;h.act=function(a,c){a=new Is({method:"POST",baseUrl:this.b,Lc:["devices:act"],ob:this.ob,body:{gcmId:c,id:a}});return this.f.execute(a).then(function(b){return b})};h.create=function(a){a=new Is({method:"POST",baseUrl:this.b,Lc:["devices"],ob:this.ob,body:a});return this.f.execute(a).then(function(c){return c})};
h.delete=function(a){a=new Is({method:"DELETE",baseUrl:this.b,Lc:["devices",a],ob:this.ob});return this.f.execute(a)};h.get=function(a){a=new Is({method:"GET",baseUrl:this.b,Lc:["devices",a],ob:this.ob});return this.f.execute(a).then(function(c){return c})};
h.list=function(a){var c=a.type,b=a.status;a=a.permission;var d={};c&&(d.type=c);b&&(d.status=b);a&&(d.permission=a);c=new Is({method:"GET",baseUrl:this.b,Lc:["devices"],nn:d,ob:this.ob});return this.f.execute(c).then(function(e){return e.device||[]})};h.update=function(a,c){for(var b=[],d={},e=l(Gv.keys()),f=e.next();!f.done;f=e.next())f=f.value,c[f]&&(d[f]=c[f],b.push(Gv.get(f)));d.id=a;a=new Is({method:"PUT",baseUrl:this.b,Lc:["devices",a],ob:this.ob,body:{device:d,updateMask:b}});return this.f.execute(a).then(function(g){return g})};var Iv=function(a,c,b,d,e,f){f=void 0===f?null:f;this.m=hb("mr.cloud.slarti.SinkDiscoveryService");this.w=a;this.g=c;this.f=b;this.j=d;this.h=e;this.b=f||new vs(this.l.bind(this),b,36E5);ku().addListener();hm(this);cj("mr.cloud.slarti.SinkDiscoveryService",this)};q(Iv,Si);Iv.prototype.ie=function(){Jba(this.h).catch(function(){});return this.b.ie().filter(function(a){return a.isAvailable})};Iv.prototype.qa=function(a){return this.b.qa(a)};
Iv.prototype.handleEvent=function(a,c){if(a!=chrome.gcm.onMessage)throw Error("Unhandled event: expected chrome.gcm.onMessage");Rca(this,c)};
var Rca=function(a,c){var b=JSON.parse(c.data.data);a.m.info("Received Slarti GCM notification: "+b.type);ob(a.m,function(){return"Got notification: "+JSON.stringify(b)});switch(b.type){case "DEVICE_ADDED":Jv(a,b).then(function(d){"cast-receiver"==d.type&&(d=new us(d.id,d.displayName,"ONLINE"==d.status),a.b.b.set(d.id,d),ws(a.f,[d.ub]))});break;case "DEVICE_CHANGED":Jv(a,b).then(function(d){if("cast-receiver"==d.type){var e=Cm(Bm(),d.id);if(e=a.b.qa(e))e.displayName=d.displayName,e.isAvailable="ONLINE"==
d.status,xs(a.f,[e.ub])}});break;case "DEVICE_REMOVED":Sca(a,Tca(b));Promise.resolve();break;case "COMMAND_CHANGED":Uca(a,b).then(function(d){var e=a.j,f=d.id,g=e.f.get(f);if(g){var k=g.routeId,m=g.sinkId,p=g.resolve,u=g.reject,A=g.er;g=!0;try{var E=JSON.parse(d.results||"{}"),F=E.sessionDescription,J=E.errorCode,V=E.errorText;switch(d.status){case "SUCCESS":p($u(e.b,new Dj("ANSWER",F),k));A&&Yr(0);break;case "ERROR":case "TIMEOUT":var Ka="TIMEOUT"==d.status;p=Wu;"KNOCK_DENIED"==J&&(Yr(Ka?2:1),p=
Ka?Yu:Xu);av(e.b,k,7,ti(si(ri(new oi(p,"warning")),k),m));throw Error("Slarti command "+f+" failed with status: "+(d.status+", errorCode: "+J+", errorText: ")+V);default:g=!1}}catch(tb){u(tb)}finally{g&&e.f.delete(f)}}else e.m.H("Received update to unknown command with name = "+(d.name+" and id = "+f))});break;default:Promise.resolve()}};Iv.prototype.l=function(){return this.g.list({type:"cast-receiver"}).then(function(a){return a.map(function(c){return new us(c.id,c.displayName,"ONLINE"==c.status)})})};
Iv.prototype.Fa=function(){return"SlartiSinkDiscoveryService"};Iv.prototype.rb=function(){return[{cache:zs(this.b)}]};Iv.prototype.pb=function(){var a=em(this);a&&As(this.b,a.cache)};
var Sca=function(a,c){c=Cm(Bm(),c);var b=a.b.qa(c);b&&(a.b.b.delete(c),ys(a.f,[b.ub]))},Tca=function(a){a=a.deviceInfo;return a.device?a.device.id:a.deviceId},Jv=function(a,c){c=c.deviceInfo;return c.device?Promise.resolve(c.device):a.g.get(c.deviceId)},Uca=function(a,c){c=c.commandInfo;return c.command?Promise.resolve(c.command):a.w.get(c.commandId)};var Kv=function(){this.b=null},Lv=function(a,c){if(!a.b||O(a.b,2)<O(c,2))a.b=Hl(c)},Mv=function(a){return a.b?O(a.b,2)+";"+O(a.b,1):null};var Nv=function(){this.D=this.w=this.J=this.K=this.F=this.C=this.g=this.u=this.h=this.f=this.j=this.ja=this.ea=this.V=this.G=this.cb=this.da=this.T=this.N=this.l=this.o=this.b=null},Ov=function(){var a=Nv.Ja();null==a.w&&(a.w=new Kv);return a.w},Pv=function(a){null==a.b&&(a.b=new Fs);return a.b},Qv=function(a){null==a.o&&(a.o=new Rba(Pv(a)));return a.o},Rv=function(a){null==a.l&&(a.l=new eu);return a.l},Sv=function(a){null==a.N&&(a.N=new cv(Pv(a),Rv(a)));return a.N},Uv=function(a,c){null==a.G&&(a.G=
new uca(Sv(a),Tv(a),c));return a.G},Vv=function(a){null==a.u&&(a.u=new wv(Qv(a)));return a.u},Tv=function(a){null==a.J&&(a.J=new rca(Qv(a)));return a.J},Wv=function(a){null==a.D&&(a.D=new ls);return a.D};Ra(Nv);var Yv=function(a,c){this.g=a;this.w=c;this.j=new Eb;this.ga=this.j.b;this.b=Xv(a.id);this.f=new Eb;this.h=!1;Vca(this);Wca(this);this.b.sendMessage(new Dj("GET_TURN_CREDENTIALS"))};Yv.prototype.start=function(){var a=this;return this.ga.then(function(c){if(c.b)return Promise.reject(Error("Presentation already started"));c.start();return a.f.b})};Yv.prototype.stop=function(){var a=this;this.h=!1;return this.ga.then(function(c){c.stop();a.ga=Promise.reject(Error("Peer connection has already been stopped"))})};
var Vca=function(a){a.b.onMessage=function(c){if(c.type)switch(c.type){case "TURN_CREDENTIALS":a.j.resolve(new Ij(a.g.id,c.data.credentials));break;case "ANSWER":a.ga.then(function(b){Qj(b,c.data)});break;case "STOP":a.f.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+c.type);}else a.ga.then(function(b){var d={type:"PRESENTATION_CONNECTION_MESSAGE",data:c};"string"==typeof d?b.h.send(d):b.h.send(JSON.stringify(d))})}},Wca=function(a){a.ga.then(function(c){Mj(c,
function(b){a.b.sendMessage(new Dj("OFFER",new Fj(b,null,null,a.w,a.g.id)))});Nj(c,function(b){b=Ej(b);"STOP"==b.type&&a.stop();a.b.sendMessage(b)});Jj(c,function(){a.h=!0;a.b.sendMessage(new Dj("SESSION_START_SUCCESS"));a.f.resolve(a.g)});Lj(c,function(){a.b.sendMessage(new Dj("SESSION_END"))});Kj(c,function(b){a.h||a.f.reject(b);a.b.sendMessage(new Dj("SESSION_FAILURE"))})})};var Zv=function(a){this.b=a;this.f=new Map;this.F=new Map;this.K=new Map;this.o=[];this.j=this.J=this.D=this.G=this.w=null;this.l=this.h=this.g=!1;this.C=new Map;this.u=new Map;hm(this)};Zv.prototype.getName=function(){return"cloud"};
Zv.prototype.initialize=function(){var a=this;this.m.info("Initializing Cloud MRP");var c=Nv.Ja();null==c.ja&&(null==c.ea&&(c.ea=new ps(Qv(c),Wv(c))),c.ja=new qu(c.ea,this));this.o.push(c.ja);if(null==c.cb){var b=Sv(c);null==c.T&&(c.T=new Hv(Pv(c),Rv(c)));var d=c.T,e=Uv(c,this);null==c.V&&(null==c.da&&(c.da=new gu(Pv(c),Rv(c))),c.V=new Iba(c.da,window.localStorage,Wv(c)));c.cb=new Iv(b,d,this,e,c.V)}this.o.push(c.cb);null==c.h&&(null==c.f&&(c.f=new fs(Qv(c),Pv(c))),b=c.f,null==c.j&&(c.j=new fca(Qv(c))),
c.h=new Cs(b,c.j,this));this.w=c.h;this.o.push(this.w);this.G=Vv(c);Uv(c,this);this.D=Pv(c);null==c.F&&(b=Uv(c,this),null==c.g&&(c.g=new Hca(Vv(c),Pv(c),Tv(c),this)),d=c.g,null==c.C&&(c.C=new hca(Pv(c),this)),c.F=new yca(b,d,c.C,this));this.J=c.F;null==c.K&&(c.K=new Jca);this.j=c.K;Nca(this.j).then(function(f){a.g=f;a.m.info("Cloud enabled setting: "+a.g)});Mca(this.j).then(function(f){a.h=f;a.m.info("Cloud on setting: "+a.h)});Kca(this.j,function(f){a.g=f;a.m.info("Cloud enabled setting: "+a.g);
a.g&&$v(a)});Qca(this.j).then(function(f){a.l=f;a.m.info("Privacy notified setting: "+a.l)})};Zv.prototype.Ed=function(){return Array.from(this.f.values())};
Zv.prototype.Fg=function(a){if(!aw(this,a))return yq;ob(this.m,"GetAvailableSinks for "+a);var c=[];if(this.h||Xca())c=$v(this);this.u.clear();for(var b={},d=l(this.C.values()),e=d.next();!e.done;b={tf:b.tf,mh:b.mh},e=d.next())b.tf=e.value,b.mh=!1,c.forEach(function(f){return function(g){g.id==f.tf.id&&(f.mh=!0,g.ub.friendlyName=f.tf.ub.friendlyName)}}(b)),b.mh||this.u.set(b.tf.id,b.tf);c=c.concat.apply(c,n(this.u.values()));ob(this.m,function(){return"Available sinks are..."+JSON.stringify(c)});
b=c.map(function(f){return f.ub});this.w&&(b=b.concat(Yca));return new xq(b,-1!=a.indexOf("0F5096E8")?kj:null)};var $v=function(a){var c=[];a.m.info("Checking cloud discovery services");Bm().g=v();a.o.forEach(function(b){b=b.ie();c=c.concat(b)});return c};h=Zv.prototype;h.startObservingMediaSinks=function(){};h.stopObservingMediaSinks=function(){};h.startObservingMediaRoutes=function(){};h.stopObservingMediaRoutes=function(){};h.qa=function(a){return(a=bw(this,a))?a.ub:null};
h.createRoute=function(a,c,b,d,e,f,g){var k=this;this.m.info("createRoute called");ob(this.m,"urn: "+a+" sinkId:"+c);if(e=this.F.get(c))return vi(this.b.Am(this,e,a,b,g,function(m){m.mediaSource=a;m.wb.tabId=g;return wi(m)}),function(m){k.b.hf(m);return m});e=bw(this,c);return Zca(this,a,e,c,b,d,g)};
var cw=function(a,c,b,d,e){c instanceof wq&&2==c.errorCode?av(a,b,6,null):(a.m.error("Error on start session",c instanceof Error?c:Error("Expected an Error value, got "+c)),a.f.has(b.id)&&av(a,b,e,ti(new oi(Wu,"warning"),b.sinkId)));if(c=a.w)c=a.w,c.f.delete(d.deviceId)?(c.b.b.delete(d.id),c=!0):c=!1;c&&ys(a,[d.ub])},Zca=function(a,c,b,d,e,f,g){if(f)return xi(Error("not supported"));f=!1;switch(b.b){case "slarti":case "weave":$r(1);break;case "mesi":f=!0;if(!a.l){a.l=!0;Pca(a.j);var k=ti(qi(),d);
a.b.cf(k)}$r(0)}Bm().f=new ym(b.model,null);var m=Op(e,a.getName(),d,c,!0,"");a.f.set(m.id,m);a.F.set(d,m);a.C.set(m.id,b);a.K.set(m.id,b.b);a.b.dg(a,m);a.b.gg(a.Fa(),!0);if(jj(c)&&!f)return a.m.info("starting presentation on route: "+m.id),$ca(m,c).catch(function(p){cw(a,p,m,b,7);throw p;});a.m.info("starting mirroring on route: "+m.id);m.wb={tabId:g,sessionId:"",jg:"",ne:b.model};jj(c)&&(m.isOffscreenPresentation=!0);return a.b.vj(a,m,e).catch(function(p){cw(a,p,m,b,5);throw p;})};
Zv.prototype.terminateRoute=function(a){return av(this,a,0,null)};
var av=function(a,c,b,d){var e="string"==typeof c?a.f.get(c):c;if(!e)return Promise.reject(new wq(3,"Route in cloud provider not found for routeId "+c));a.m.info("terminating route: "+e.id);a.f.delete(e.id);a.F.delete(e.sinkId);c=a.C.get(e.id);a.C.delete(e.id);d&&a.b.cf(d);Db("MediaRouter.Cloud.Session.End",b,Oaa);switch(b){case 1:break;default:switch(c.b){case "weave":Av(a.G,c.deviceId,bba,{})}}a.b.Ng(e);0==a.f.size&&a.b.gg(a.Fa(),!1);a.b.onPresentationConnectionStateChanged(e.id,"terminated");a.u.has(e.sinkId)&&
(b=a.u.get(e.sinkId),ys(a,[b.ub]),a.u.delete(e.sinkId));return Promise.resolve()};h=Zv.prototype;h.sendRouteMessage=function(a,c){var b=this.K.get(a);if(b){var d=(a=this.f.get(a)||void 0)?bw(this,a.sinkId):void 0;return Bca(this.J,b,c,a,d)}return Ia(c)?($u(this,c,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};h.sendRouteBinaryMessage=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data."))};
h.Pf=function(a){var c=new Bj;5>c.minFrameRate&&(c.minFrameRate=5);var b=this.Of(a);"hangouts"==b||"meetings"==b?(c.maxWidth=Math.min(window.screen&&window.screen.width||Infinity,2880),c.maxHeight=Math.min(window.screen&&window.screen.height||Infinity,1800)):c.senderSideLetterboxing=!0;Cj(c);Object.freeze(c);this.m.info("Settings for "+a+": "+Aj(c));if(!c.shouldCaptureAudio&&!c.shouldCaptureVideo)throw Error("Cannot start mirroring without video or audio capture.");return c};
h.Of=function(a){var c=null;a=bw(this,a);switch(a.b){case "slarti":case "weave":c="webrtc";break;case "mesi":c=a.Kd?"meetings":"hangouts"}return c};h.Xh=function(){};h.xg=function(a,c){ob(this.m,"Checking canRoute: "+a+" for sinkId: "+c);return aw(this,a)&&!!this.qa(c)};h.Hf=function(a,c){return jj(a)&&this.f.has(c)};h.joinRoute=function(a,c){return(a=this.f.get(c))?(this.m.info("joining route: "+a.id),wi(a)):xi(Error("not supported"))};h.connectRouteByRouteId=function(){return xi(Error("not supported"))};
h.detachRoute=function(){};
var ws=function(a,c){a.m.info(c.length+" sinks added");0<c.length&&!a.h&&(Lca(a.j),a.h=!0);c=bw(a,c[0].id);Bm().b=new ym(c.model,null);a.b.gd();a.b.onSinkAvailabilityUpdated(a,2);a.m.info("sinkAvailability changed to AVAILABLE")},ys=function(a,c){a.m.info(c.length+" sinks removed");a.o.some(function(b){return 0<b.ie().length})||(a.b.onSinkAvailabilityUpdated(a,0),a.m.info("sinkAvailability changed to UNAVAILABLE"));a.b.gd()},xs=function(a,c){a.m.info(c.length+" sinks updated");a.b.gd()},$u=function(a,
c,b,d){(void 0===d?0:d)?a.b.he(b,c):a.b.Wh(b,c)},bw=function(a,c){var b=ada(a,c);b||(b=null,(c=a.F.get(c))&&(b=a.C.get(c.id)));return b},ada=function(a,c){var b=null;a.o.some(function(d){b=d.qa(c);return!!b});return b},Xca=function(){var a=Bm().g;return 3E5<=Date.now()-a},aw=function(a,c){var b=ij(c);c=jj(c);if(a.D.g&&!a.D.f&&b)return a.b.onSinkAvailabilityUpdated(a,2),!0;var d=!1;a.g&&a.D.f&&(d=!0);var e;if(e=!chrome.declarativeWebRequest)a=a.D,e=!(a.g||a.f&&a.b&&(-1!=Hs.indexOf(a.b)||-1!=Hs.indexOf(Gs(a))))&&
c;return e?!1:d&&(b||c)};h=Zv.prototype;h.searchSinks=function(a,c){var b=this;if(!aw(this,a))return Promise.reject(Error("err"));a=lba(this.w,c);a.then(function(d){ws(b,[d])});return a};h.createMediaRouteController=function(){return eb()};h.provideSinks=function(){};h.Fa=function(){return"CloudProvider"};h.rb=function(){return[void 0,{cloudEnabled:this.g,cloudOn:this.h,notifiedHangoutsPrivacy:this.l}]};
h.pb=function(){var a=fm(this);a&&(a.cloudEnabled&&(this.g=a.cloudEnabled),a.cloudOn&&(this.h=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.l=a.notifiedHangoutsPrivacy))};var $ca=function(a,c){a=new Yv(a,c);return yi(a.start())};Zv.prototype.m=hb("mr.CloudProvider");var Yca=new am("pseudo:cloud","","meeting","","default");var dw=function(){Hp.call(this,12,"ExternalMessageListener","mr.ProviderManager",chrome.runtime.onMessageExternal)};q(dw,Hp);dw.prototype.kh=function(a,c){return c.id&&-1!=bda.indexOf(c.id)?"start"==a.type||"stop"==a.type||"subscribe_log_data"==a.type:!1};dw.prototype.Ei=function(){return!0};var fw=function(){ew||(ew=new dw);return ew},ew=null,bda=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"];var gw=function(){Hp.call(this,11,"InternalMessageListener","mr.ProviderManager",chrome.runtime.onMessage)};q(gw,Hp);gw.prototype.kh=function(a,c){return"retrieve_log_data"==a.type&&c.id==chrome.runtime.id&&c.url=="chrome-extension://"+c.id+"/feedback.html"};gw.prototype.Ei=function(){return!0};var iw=function(){hw||(hw=new gw);return hw},hw=null;function cda(){var a=jw;var c=new zq(a);var b=new ur(a);c=[c,b];c.push(new Zv(a));return c};var kw=function(a,c){this.routeId=a;this.message=c},lw=function(a){return"string"!=typeof a.message};var mw=function(a){this.D=a;this.h=this.j=null},nw=function(a){if(null==a.h)if(null==a.j||Date.now()-a.j>=a.D)a.w();else{var c=Math.max(a.j+a.D-Date.now(),5);a.h=setTimeout(a.w.bind(a),c)}};mw.prototype.w=function(){null!=this.h&&(clearTimeout(this.h),this.h=null);this.u();this.j=Date.now()};mw.prototype.u=function(){};var ow=function(a,c){mw.call(this,20);this.b=new Map;this.f=new Set;this.o=null;this.l=this.g=0;this.C=!1;this.K=a;this.F=c;this.m=hb("mr.RouteMessageSender")};q(ow,mw);ow.prototype.init=function(a){this.o=a;hm(this)};ow.prototype.stopListeningForRouteMessages=function(a){this.f.delete(a)};
ow.prototype.send=function(a,c){var b=this.b.get(a);b||(b=[],this.b.set(a,b));c=new kw(a,c);b.push(c);50<b.length&&1==b.length%50&&this.m.H(function(){return"Message queue length is excessively large ("+(b.length+") for route "+a)});this.g+=lw(c)?0:c.message.length;lw(c)&&this.l++;pw(this);this.f.has(a)&&nw(this)};
var qw=function(a,c){if(0!=c.length){c=l(c);for(var b=c.next();!b.done;b=c.next())b=b.value,a.g-=lw(b)?0:b.message.length,lw(b)&&a.l--}},pw=function(a){var c=0<a.l||a.g>a.F;c!=a.C&&(a.C=c,a.K.gg(a.Fa(),c))};ow.prototype.u=function(){if(this.o){for(var a=l(this.f),c=a.next();!c.done;c=a.next()){c=c.value;var b=this.b.get(c);b&&0!=b.length&&(this.o(c,b),qw(this,b),this.b.set(c,[]))}pw(this)}else this.m.error("sendMessagesCallback not set. Messages not delivered.")};ow.prototype.Fa=function(){return"mr.RouteMessageSender"};
ow.prototype.rb=function(){var a=[].concat(n(this.b.entries())).map(function(c){return[c[0],c[1].map(function(b){return b.message})]});return[new dda(a,Array.from(this.f),this.g)]};ow.prototype.pb=function(){var a=em(this);if(a){this.b=new Map;for(var c={},b=l(a.f),d=b.next();!d.done;c={ph:c.ph},d=b.next())d=d.value,c.ph=d[0],d=d[1].map(function(e){return function(f){return new kw(e.ph,f)}}(c)),this.b.set(c.ph,d);this.f=new Set(a.b);this.g=a.g}};var dda=function(a,c,b){this.f=a;this.b=c;this.g=b};var eda=function(a,c){this.type="internal_message";this.routeId=a;this.message=c};var rw=function(a,c,b){this.b=a;this.h=c;this.g=b;this.onMessage=function(){};b.listen("internal_message",this.f,this)};rw.prototype.sendMessage=function(a,c){return this.h(this.b,a,c)};rw.prototype.f=function(a){if(a.routeId==this.b)this.onMessage(a.message)};rw.prototype.fb=function(){this.onMessage=function(){};Oq(this.g,this.f,this)};
var fda=new rw("",function(){return Promise.resolve()},new Nq),gda=function(a){this.b=a},Xv=function(a){var c=mi,b=c.b.Pi(a);return b?new rw(a,b.sendRouteMessage.bind(b),c.b.Ri()):fda};var sw=function(a,c){this.w=null!=c?a.bind(c):a;this.j=this.l.bind(this);this.h=[];this.b=!1;this.f=null};sw.prototype.g=function(a){for(var c=[],b=0;b<arguments.length;++b)c[b-0]=arguments[b];this.h=[].concat(n(c));null==this.f?tw(this):this.b=!0};var tw=function(a){a.f=setTimeout(a.j,500);a.w.apply(a,n(a.h))};sw.prototype.l=function(){this.f=null;this.b&&(this.b=!1,tw(this))};var uw=function(){this.config=null;this.m=hb("mr.ProviderManager");this.g=[];this.f=new Map;this.l=new Map;this.j=new Set;this.h=new Set;this.D=new Map;this.b=this.u=null;this.G=new Nq;this.J=new sw(this.An,this);this.V=new sw(this.K,this);this.w=new ow(this,524288);this.F=0;this.o=new Map;this.C=[];var a=new Vr(this);this.T=a.onMessage.bind(a);a=new Pr(this);this.N=a.onMessage.bind(a);this.onBeforeInvokeHandler=this.onBeforeInvokeHandler;this.createRoute=this.createRoute;this.joinRoute=this.joinRoute;
this.connectRouteByRouteId=this.connectRouteByRouteId;this.terminateRoute=this.terminateRoute;this.startObservingMediaSinks=this.startObservingMediaSinks;this.stopObservingMediaSinks=this.stopObservingMediaSinks;this.sendRouteMessage=this.sendRouteMessage;this.sendRouteBinaryMessage=this.sendRouteBinaryMessage;this.startListeningForRouteMessages=this.startListeningForRouteMessages;this.stopListeningForRouteMessages=this.stopListeningForRouteMessages;this.startObservingMediaRoutes=this.startObservingMediaRoutes;
this.stopObservingMediaRoutes=this.stopObservingMediaRoutes;this.detachRoute=this.detachRoute;this.searchSinks=this.searchSinks;this.provideSinks=this.provideSinks;this.updateMediaSinks=this.updateMediaSinks;this.createMediaRouteController=this.createMediaRouteController};q(uw,Si);
uw.prototype.handleEvent=function(a,c){for(var b=[],d=1;d<arguments.length;++d)b[d-1]=arguments[d];if(a==chrome.runtime.onMessage)this.T.apply(this,n(b));else if(a==chrome.runtime.onMessageExternal)this.N.apply(this,n(b));else throw Error("Unhandled event");};
var Xr=function(a,c){c=a.D.get(c);return Xi(c).then(function(b){b.initialize(a,!!a.config&&a.config.use_mirroring_service);return b})},hda=function(a,c,b){c.forEach(function(d){if(Wr(a,d.getName()))a.m.H("Provider "+d.getName()+" already registered.");else try{d.initialize(b),a.g.push(d),a.o.set(d.getName(),0)}catch(e){a.m.H("Provider "+d.getName()+" failed to initialize.",e)}})};
uw.prototype.initialize=function(a,c,b){this.D.set("webrtc","mr.mirror.webrtc.WebRtcService");this.D.set("cast_streaming","mr.mirror.cast.Service");this.D.set("hangouts","mr.mirror.hangouts.HangoutsService");this.D.set("meetings","mr.mirror.hangouts.MeetingsService");var d=new gda(this);mi||(mi=d);this.b=a;this.w.init(this.b.onRouteMessagesReceived.bind(this.b));hda(this,c,b);this.config=b;hm(this);cj("mr.ProviderManager",this)};
var ww=function(a,c,b){return new Promise(function(d,e){var f=null;a.F++;vw(a);f=window.setTimeout(function(){f=null;c.cancel(new wq(2,"timeout after "+b+" ms."))},b);c.b.then(function(g){a.F--;vw(a);null!=f&&window.clearTimeout(f);d(g)},function(g){a.F--;vw(a);null!=f&&window.clearTimeout(f);e(g instanceof wq?g:g instanceof Error?new wq(0,g.message,g.stack):new wq(0))})})};uw.prototype.onBeforeInvokeHandler=function(){fj(0)};
var xw=function(a){return"string"==typeof a?a:a.unique?"":a.scheme+"://"+a.host+"\n       "+(a.port?":"+a.port:"")+"/"};h=uw.prototype;
h.createRoute=function(a,c,b,d,e,f,g){var k=this;g=void 0===g?!1:g;var m=ida(this,a,c);if(!m)return Promise.reject(new wq(7,"No provider supports createRoute with source: "+a+" and sink: "+c));var p=void 0;void 0!==d&&(p=xw(d));f=f&&0<f?f:6E4;a=m.createRoute(a,c,b,g,f,p,e);return ww(this,a,f).then(function(u){return u},function(u){k.m.error("Error creating route.",u);throw u;})};
h.connectRouteByRouteId=function(a,c,b,d,e,f){var g=this.f.get(c);if(!g)return Promise.reject(new wq(7,"No provider supports join "+c));a=g.connectRouteByRouteId(a,c,b,xw(d),e);return ww(this,a,f&&0<f?f:3E4)};h.joinRoute=function(a,c,b,d,e,f){f=void 0===f?!1:f;var g=jda(this,a,c);if(!g)return Promise.reject(new wq(7,"No provider supports join "+c));e=e&&0<e?e:3E4;a=g.joinRoute(a,c,f,e,xw(b),d);return ww(this,a,e)};
h.terminateRoute=function(a){var c=this.f.get(a);return c?yw(this,a).then(function(){return c.terminateRoute(a)}):Promise.reject(new wq(3,"Route not found for routeId "+a))};h.startObservingMediaSinks=function(a){this.j.has(a)||(this.j.add(a),this.g.forEach(function(c){c.startObservingMediaSinks(a)}));zw(this,a)};h.stopObservingMediaSinks=function(a){this.j.delete(a)?Aw(this,a):this.m.info("No existing query "+a)};
var Aw=function(a,c){a.g.forEach(function(b){b.stopObservingMediaSinks(c)})},zw=function(a,c){if("urn:x-org.chromium.media:source:tab:-1"==c)a.m.H("No sinks for sourceUrn: "+c);else{var b=new Map,d=[];a.g.forEach(function(e){var f=e.Fg(c);0<f.sinks.length&&(d=f.origins);f.sinks.forEach(function(g){b.has(g.id)?a.m.H("Detected duplicate sink "+g.id+" from provider: "+e.getName()):b.set(g.id,g)})});kda(a,c,Array.from(b.values()),d||[])}},kda=function(a,c,b,d){a.m.info("Sending "+b.length+" sinks to MR for "+
c);a.b.onSinksReceived(c,b,d.map(Io))};h=uw.prototype;h.sendRouteMessage=function(a,c,b){var d=this.f.get(a);d?(a=d.sendRouteMessage(a,c,b),a=ww(this,yi(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};h.sendRouteBinaryMessage=function(a,c){var b=this.f.get(a);b?(a=b.sendRouteBinaryMessage(a,c),a=ww(this,yi(a),3E4)):a=Promise.reject(Error("Invalid route ID "+a));return a};
h.startListeningForRouteMessages=function(a){var c=this.w;c.f.has(a)||(c.f.add(a),(a=c.b.get(a))&&0<a.length&&nw(c))};h.stopListeningForRouteMessages=function(a){this.w.stopListeningForRouteMessages(a)};h.detachRoute=function(a){var c=this.f.get(a);c?c.detachRoute(a):this.m.info("Route "+a+" does not exist.")};h.enableMdnsDiscovery=function(){};var ida=function(a,c,b){return a.g.find(function(d){return d.xg(c,b)})||null},jda=function(a,c,b){return a.g.find(function(d){return d.Hf(c,b)})||null};
uw.prototype.K=function(){var a=this;this.j.forEach(function(c){zw(a,c)})};var vw=function(a){a.b.setKeepAlive(0<a.F||0<a.C.length)};h=uw.prototype;h.startObservingMediaRoutes=function(a){this.h.has(a)||(this.h.add(a),this.g.forEach(function(c){c.startObservingMediaRoutes(a)}));this.J.g()};h.stopObservingMediaRoutes=function(a){this.h.delete(a)?this.g.forEach(function(c){c.stopObservingMediaRoutes(a)}):this.m.info("No existing route query "+a)};
h.An=function(){var a=this;if(0!=this.h.size){var c=[];this.g.forEach(function(b){c=c.concat(b.Ed())});this.h.forEach(function(b){var d=[];a.g.forEach(function(e){e.Ed().forEach(function(f){!f.Kf&&e.Hf(b,void 0,f)&&d.push(f.id)})});a.b.onRoutesUpdated(c,b,d)})}};h.Fa=function(){return"ProviderManager"};
h.rb=function(){return[new lda(this.g.map(function(a){return a.getName()}),Array.from(this.j),Array.from(this.h),Array.from(this.f,function(a){var c=l(a);a=c.next().value;c=c.next().value;return[a,c.getName()]}),Array.from(this.o),this.u)]};h.pb=function(){var a=em(this);if(a){this.j=new Set(a.j);this.h=new Set(a.g);for(var c=l(a.f),b=c.next();!b.done;b=c.next()){var d=l(b.value);b=d.next().value;d=d.next().value;d=Wr(this,d);this.f.set(b,d)}this.o=new Map(a.h);this.u=a.b||null}};h.Pi=function(a){return this.f.get(a)};
h.dg=function(a,c){this.f.set(c.id,a);this.hf(c)};h.Ng=function(a){yw(this,a.id);this.f.delete(a.id);var c=this.w,b=a.id;c.f.delete(b);var d=c.b.get(b);d&&(c.b.delete(b),qw(c,d),pw(c));this.hf(a)};h.hf=function(){0<this.h.size&&this.J.g()};h.Xi=function(a){var c=this.f.get(a.id);c&&(c.Xh(a.id),0<this.h.size&&this.An())};h.he=function(a,c){this.f.has(a)?("string"===typeof c||c instanceof Uint8Array||(c=JSON.stringify(c)),this.w.send(a,c)):this.m.H("Got route message for closed route "+a)};
h.onPresentationConnectionStateChanged=function(a,c){"terminated"==c&&this.w.w();this.b.onPresentationConnectionStateChanged(a,c)};h.onPresentationConnectionClosed=function(a,c,b){this.w.w();this.b.onPresentationConnectionClosed(a,c,b)};h.Yh=function(a){this.l.delete(a);var c=this.f.get(a);c&&c.terminateRoute(a)};h.Wh=function(a,c){Pq(this.G,new eda(a,c))};h.gd=function(){this.V.g()};
h.onSinkAvailabilityUpdated=function(a,c){var b=this;if(this.o.get(a.getName())!=c){var d=Bw(this);this.o.set(a.getName(),c);a=Bw(this);d!=a&&(0==a&&this.K(),this.b.onSinkAvailabilityUpdated(a),0==a&&(this.j.forEach(function(e){Aw(b,e)}),this.j.clear()))}};var Bw=function(a){return Array.from(a.o.values()).reduce(function(c,b){return Math.max(c,b)},0)};uw.prototype.Ri=function(){return this.G};uw.prototype.cf=function(a){this.b.onIssue(a)};
var yw=function(a,c){return a.l.has(c)?Xr(a,a.l.get(c)).then(function(b){a.l.delete(c);return b.l()}):Promise.resolve(!1)};uw.prototype.vj=function(a,c,b,d){var e=this,f=a.Of(c.sinkId);this.m.info("Starting mirroring using service: "+f);this.l.set(c.id,f);return zi(Xr(this,f),function(g){e.u=f;return g.Jj(c,c.mediaSource,a.Pf(c.sinkId),b,d).catch(function(k){if(k instanceof Bi&&3==k.reason)throw new wq(8);throw k;})})};
uw.prototype.Am=function(a,c,b,d,e,f){var g=this,k=this.l.get(c.id);return k?zi(Xr(this,k),function(m){g.u=k;return m.Kj(c,b,a.Pf(c.sinkId),d,e,f)}):xi(Error("Route "+c.id+" is not mirroring"))};uw.prototype.gg=function(a,c){var b=this.C.indexOf(a),d=0<=b;c&&!d?this.C.push(a):!c&&d&&this.C.splice(b,1);vw(this)};var Wr=function(a,c){return a.g.find(function(b){return b.getName()==c})||null};h=uw.prototype;
h.searchSinks=function(a,c,b){var d=a.startsWith("pseudo:")?a.substring(7):null;return(d=d?Wr(this,d):null)?d.searchSinks(c,b).then(function(e){return e.id}):Promise.reject(Error("No provider supports "+a))};h.provideSinks=function(a,c){var b=Wr(this,a);b?b.provideSinks(c):this.m.error("provideSinks: Provider not found for providerName "+a)};h.updateMediaSinks=function(a){this.j.has(a)||zw(this,a)};
h.createMediaRouteController=function(a,c,b){var d=this,e=this.f.get(a);return e?e.createMediaRouteController(a,c,b).catch(function(f){d.m.error("createMediaRouteController failed: "+f.message);c.close();b.ptr.reset();throw f;}):(a="createMediaRouteController: Provider not found for "+a,this.m.error(a),c.close(),b.ptr.reset(),Promise.reject(Error(a)))};h.onMediaRemoterCreated=function(a,c,b){this.b.onMediaRemoterCreated(a,c,b)};
h.getMediaSinkServiceStatus=function(){return"function"!=typeof this.b.getMediaSinkServiceStatus?Promise.resolve({status:""}):this.b.getMediaSinkServiceStatus()};h.getMirroringServiceHostForTab=function(a,c){this.b.getMirroringServiceHostForTab(a,c)};h.getMirroringServiceHostForDesktop=function(a,c,b){this.b.getMirroringServiceHostForDesktop(a,c,b)};h.getMirroringServiceHostForOffscreenTab=function(a,c,b){this.b.getMirroringServiceHostForOffscreenTab(a,c,b)};
var lda=function(a,c,b,d,e,f){this.j=c;this.g=b;this.f=d;this.h=e;this.b=f};
