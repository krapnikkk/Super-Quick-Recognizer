{
  "code": "import PointsManager from \"../manager/PointsManager\";\r\nimport { itemType } from \"../components/Item\";\r\nimport Events from \"../events/events\";\r\nimport utils from \"../utils/utils\";\r\nexport default class WindowGroup extends fgui.Window {\r\n    constructor() {\r\n        super();\r\n    }\r\n    onInit() {\r\n        this.contentPane = fgui.UIPackage.createObject(\"canvas\", \"window_2\").asCom;\r\n        this.center();\r\n        this.setPivot(0.5, 0.5);\r\n        this.contentPane.getChild(\"btn_close\").onClick(this, this.onHide);\r\n        this._comboBox = this.contentPane.getChild(\"n17\").asComboBox;\r\n        this._comboBox.on(fairygui.Events.STATE_CHANGED, this, this.onComboBoxChanged);\r\n        this._list = this.contentPane.getChild(\"n3\").asList;\r\n        this._list.scrollItemToViewOnClick = false;\r\n        this.contentPane.getChild(\"n20\").asButton.onClick(this, this.deleteGroup);\r\n        this.contentPane.getChild(\"n19\").asButton.onClick(this, this.exportData);\r\n        this.contentPane.getChild(\"n4\").asButton.onClick(this, this.importData);\r\n    }\r\n    onShown() {\r\n        this.initComboBox();\r\n        Laya.stage.on(Events.DELETE_ITEM, this, this.deleteItem);\r\n    }\r\n    initComboBox() {\r\n        Laya.stage.event(Events.DATA_INIT);\r\n        this._comboBox.items = [];\r\n        this._comboBox.values = [];\r\n        let items = [], values = [], length = PointsManager.groupData.length;\r\n        if (!length) {\r\n            alert(\"数据组好像木有数据了哦！\");\r\n            return;\r\n        }\r\n        else {\r\n            for (let i = 0; i < length; i++) {\r\n                items.push(PointsManager.groupData[i][\"name\"]);\r\n                values.push(i);\r\n            }\r\n            this._comboBox.items = items;\r\n            this._comboBox.values = values;\r\n        }\r\n        this.initList();\r\n    }\r\n    onComboBoxChanged() {\r\n        PointsManager.currentGroupIndex = +this._comboBox.value;\r\n        this.initList();\r\n    }\r\n    initList() {\r\n        this._list.removeChildrenToPool();\r\n        if (!PointsManager.groupData.length) {\r\n            return;\r\n        }\r\n        const groupData = PointsManager.groupData[PointsManager.currentGroupIndex][\"data\"];\r\n        for (var i = 0; i < groupData.length; i++) {\r\n            const element = groupData[i];\r\n            const uuid = new Date().getTime();\r\n            var item = this._list.addItemFromPool();\r\n            item.title = element.label.length > 6 ? element.label.substr(0, 6) + \"...\" : element.label;\r\n            item.time = element.timestamp || \"组内数据不记录时间\";\r\n            item._uuid = element[\"uuid\"] = uuid;\r\n            item.type = itemType.GROUP;\r\n        }\r\n    }\r\n    deleteGroup() {\r\n        PointsManager.groupData.splice(PointsManager.currentGroupIndex, 1);\r\n        PointsManager.saveGroup();\r\n        if (PointsManager.groupData.length > 0) {\r\n            alert(`数据组：【${this._comboBox.text}】已成功删除！`);\r\n            this.initComboBox();\r\n        }\r\n        else {\r\n            alert(\"数据组好像木有数据了哦！\");\r\n        }\r\n    }\r\n    deleteItem(evt) {\r\n        this._list.removeChildToPool(evt);\r\n        utils.spliceArrayByKey(PointsManager.groupData, \"data\", PointsManager.currentGroupIndex, \"uuid\", evt._uuid);\r\n        const object = Object.assign([], PointsManager.groupData);\r\n        for (let i = 0; i < object.length; i++) {\r\n            const item = object[i];\r\n            for (let j = 0; j < item[\"data\"].length; j++) {\r\n                const point = item[\"data\"][j];\r\n                if (point[\"uuid\"]) {\r\n                    delete point[\"uuid\"];\r\n                }\r\n            }\r\n        }\r\n        PointsManager.saveGroup(object);\r\n    }\r\n    exportData() {\r\n        utils.copyText(JSON.stringify(PointsManager.groupData[PointsManager.currentGroupIndex]).replace(/\"IntX\":0,\"IntY\":0,/g, \"\"));\r\n    }\r\n    importData() {\r\n        let text = this.contentPane.getChild(\"n30\").text;\r\n        PointsManager.insertData(text);\r\n        this.initComboBox();\r\n    }\r\n    doShowAnimation() {\r\n        this.setScale(0.1, 0.1);\r\n        fgui.GTween.to2(0.1, 0.1, 1, 1, 0.3)\r\n            .setTarget(this, this.setScale)\r\n            .setEase(fgui.EaseType.QuadOut)\r\n            .onComplete(this.onShown, this);\r\n    }\r\n    doHideAnimation() {\r\n        fgui.GTween.to2(1, 1, 0.1, 0.1, 0.3)\r\n            .setTarget(this, this.setScale)\r\n            .setEase(fgui.EaseType.QuadOut)\r\n            .onComplete(this.hideImmediately, this);\r\n    }\r\n    onHide() {\r\n        this.hide();\r\n        Laya.stage.off(Events.DELETE_ITEM, this, this.deleteItem);\r\n    }\r\n}\r\n",
  "references": [
    "E:/coding/layabox/Super-Quick-Recognizer/src/manager/PointsManager.ts",
    "E:/coding/layabox/Super-Quick-Recognizer/src/components/Item.ts",
    "E:/coding/layabox/Super-Quick-Recognizer/src/events/events.ts",
    "E:/coding/layabox/Super-Quick-Recognizer/src/utils/utils.ts"
  ]
}
